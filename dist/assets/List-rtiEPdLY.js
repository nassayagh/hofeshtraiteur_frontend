import{u as de}from"./payments-B6GsiHmD.js";import{u as ue}from"./eventType-B0iUgqay.js";import{_ as ce}from"./BaseBreadcrumb-EI-uaaPh.js";import{f as j,a as me}from"./formatters-ChhyeSK0.js";import{a6 as W,Z,o as m,_ as x,w as t,b as e,a as s,t as n,V as p,a8 as h,c as w,a4 as f,aJ as fe,r as o,av as he,aK as g,h as pe,e as E,g as ve,q as ge,n as ye,d as V,X as _e}from"./index-ByVbuanv.js";import{u as we}from"./Controller-affsgHRo.js";import{V as v,a as L}from"./VRow-DE7XMKPg.js";import{V as P,a as b,b as be,c as Ve}from"./VCard-D8jqdyHr.js";import{a as y}from"./VSpacer-nS6bYtKg.js";import{V as Pe}from"./VDataTableServer-BOWmKdgG.js";import{V as ke}from"./VToolbar-BlabZwCL.js";import{V as z}from"./VTextField-W8WSSoQI.js";import{b as xe}from"./VSelect-D-nEYc66.js";import{V as Q}from"./VDialog-B8J_jI9q.js";import{V as $e}from"./VLocaleProvider-DW3qm9KL.js";import{V as De}from"./VDatePicker-DVnGp5qH.js";import"./VAvatar-DdFp7Ur3.js";import"./filter-D6wZfKUE.js";import"./VMenu-B4xZ6Nzt.js";import"./VSheet-BtCIXRa_.js";const Ce={class:"d-flex align-start"},Se={class:"text-h4"},Te={class:"ml-auto"},Be={class:"mt-2"},Ue={class:"text-h4 font-weight-regular"},Ie={key:0,class:"text-subtitle-1"},Me={class:"d-flex align-start"},Ae={class:"text-h4"},Ee={class:"ml-auto"},je={class:"mt-2"},Le={class:"text-h4 font-weight-regular"},Ne={key:0,class:"text-subtitle-1"},Re={class:"d-flex align-start"},Ke={class:"text-h4"},Oe={class:"ml-auto"},Fe={class:"mt-2"},Ge={class:"text-h4 font-weight-regular"},He={key:0,class:"text-subtitle-1"},qe={class:"d-flex align-start"},Je={class:"text-h4"},Xe={class:"ml-auto"},Ze={class:"mt-2"},ze={class:"text-h4 font-weight-regular"},Qe={key:0,class:"text-subtitle-1"},We={class:"d-flex align-start"},Ye={class:"text-h4"},et={class:"ml-auto"},tt={class:"mt-2"},at={class:"text-h4 font-weight-regular"},st={key:0,class:"text-subtitle-1"},lt={class:"d-flex align-start"},ot={class:"text-h4"},nt={class:"ml-auto"},it={class:"mt-2"},rt={class:"text-h4 font-weight-regular"},dt={key:0,class:"text-subtitle-1"},ut={class:"d-flex align-start"},ct={class:"text-h4"},mt={class:"ml-auto"},ft={class:"mt-2"},ht={class:"text-h4 font-weight-regular"},pt={key:0,class:"text-subtitle-1"},vt={class:"d-flex align-start"},gt={class:"text-h4"},yt={class:"ml-auto"},_t={class:"mt-2"},wt={class:"text-h4 font-weight-regular"},bt={key:0,class:"text-subtitle-1"},Vt=W({__name:"PrespationDashboard",props:{showDescription:{type:Boolean,default:!1},showPayments:{type:Boolean,default:!1},showValidation:{type:Boolean,default:!1},showValidated:{type:Boolean,default:!1},showProcessing:{type:Boolean,default:!1},showClosed:{type:Boolean,default:!1},showCancelled:{type:Boolean,default:!1},showTotalPayments:{type:Boolean,default:!1},md:{type:String,default:"3"}},setup(d){const c=we();return c.fetchStatistics({}),(u,O)=>{const D=Z("CurrencyEuroIcon"),k=Z("HotelServiceIcon");return d.showPayments?(m(),x(L,{key:0},{default:t(()=>[d.showTotalPayments?(m(),x(v,{key:0,class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Ce,[s("h2",Se,n(u.$t("Montant total")),1),e(y),s("div",Te,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-info"})]),_:1})])]),s("div",Be,[s("h2",Ue,n(h(j)(h(c).statistics.totalPayments||0)),1),d.showDescription?(m(),w("span",Ie,n(u.$t("Montant total de service")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),e(v,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Me,[s("h2",Ae,n(u.$t("Montant à régler")),1),e(y),s("div",Ee,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-primary"})]),_:1})])]),s("div",je,[s("h2",Le,n(h(j)(h(c).statistics.paymentsLeft||0)),1),d.showDescription?(m(),w("span",Ne,n(u.$t("Montant restant à régler")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),e(v,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Re,[s("h2",Ke,n(u.$t("Montant réglé")),1),e(y),s("div",Oe,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-success"})]),_:1})])]),s("div",Fe,[s("h2",Ge,n(h(j)(h(c).statistics.paymentsReceived||0)),1),d.showDescription?(m(),w("span",He,n(u.$t("Montant total déjà réglé")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})):(m(),x(L,{key:1},{default:t(()=>[e(v,{class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",qe,[s("h2",Je,n(u.$t("Prestations")),1),e(y),s("div",Xe,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-primary"})]),_:1})])]),s("div",Ze,[s("h2",ze,n(h(c).statistics.total||0),1),d.showDescription?(m(),w("span",Qe,n(u.$t("Prestations total")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),d.showValidation?(m(),x(v,{key:0,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",We,[s("h2",Ye,n(u.$t("Prestations validées")),1),e(y),s("div",et,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-success"})]),_:1})])]),s("div",tt,[s("h2",at,n(h(c).statistics.validated||0),1),d.showDescription?(m(),w("span",st,n(u.$t("Prestations total validées")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),d.showValidated?(m(),x(v,{key:1,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",lt,[s("h2",ot,n(u.$t("Prestations en validation")),1),e(y),s("div",nt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",it,[s("h2",rt,n(h(c).statistics.validation||0),1),d.showDescription?(m(),w("span",dt,n(u.$t("Prestations total en attende de validation")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),d.showClosed?(m(),x(v,{key:2,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",ut,[s("h2",ct,n(u.$t("Prestations Clôturée")),1),e(y),s("div",mt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",ft,[s("h2",ht,n(h(c).statistics.closed||0),1),d.showDescription?(m(),w("span",pt,n(u.$t("Prestations total Clôturée")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),d.showCancelled?(m(),x(v,{key:3,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-error h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",vt,[s("h2",gt,n(u.$t("Prestations annulées")),1),e(y),s("div",yt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-error"})]),_:1})])]),s("div",_t,[s("h2",wt,n(h(c).statistics.cancelled||0),1),d.showDescription?(m(),w("span",bt,n(u.$t("Prestations total annulées")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0)]),_:1}))}}}),Gt=W({__name:"List",setup(d){const c=fe();o();const u=he(),O=ue(),D=o({title:"Gestion des paiements"}),k=o([{text:g("Dashboard"),disabled:!1,href:"/"},{text:g("Gestion des paiements"),disabled:!0,href:"#"}]),T=o([]),F=o([]),N=de();pe(()=>{J(),le()});const B=o(!1);o(!1),o(!1),o(!1),o(!1),o(""),o(),o(!1);const G=o(null);o(null),o(null),o(null);const U=o(!1);o();const R=o(25),C=o(2),I=o(2),M=o(0);o(!1);const Y=o(!1);o(null);const K=o("");o(["primary","secondary","error","success","warning"]);const $=o([{key:"payment_date",order:"DESC"}]);o(0);const r=o({search:null,status:null,date:null,event_type:null}),S=o({itemsPerPage:25,rowsPerPage:25,page:1,sortDesc:[!0],sortBy:[{key:"payment_date",order:"DESC"}]}),ee=o(-1),H=o({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});o({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const A=o(!1),te=o([{title:g("Prénom"),align:"start",key:"prestation.customer.firstname",sortable:!1},{title:g("Nom"),align:"start",key:"prestation.customer.lastname",sortable:!1},{title:g("Email"),align:"start",key:"prestation.customer.email",sortable:!1},{title:g("Téléphone"),align:"start",key:"prestation.customer.phone",sortable:!1},{title:g("Prestation"),align:"start",key:"prestation.event_type"},{title:g("Mode de paiement"),align:"start",key:"payment_method"},{title:g("Montant payé"),align:"start",key:"amount"},{title:g("Date du paiement"),align:"start",key:"payment_date"},{title:"Actions",key:"actions",sortable:!1}]),q=E(()=>r.value.date&&r.value.date.length>0?c.format(r.value.date[0],"shortDate")+" - "+c.format(r.value.date[r.value.date.length-1],"shortDate"):null);E(()=>N.payments.data.filter(i=>i.email.toLowerCase().includes(K.value.toLowerCase())));function ae(){N.deleteItem(H.value.id);const i=T.value.findIndex(a=>a.id==H.value.id);T.value.splice(i,1),A.value=!1,u.showSuccess(g("Utilisateur supprimé avec succès"))}E(()=>ee.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const se=E(()=>r.value.date&&r.value.date.length?r.value.date.length>1?[c.format(r.value.date[0],"shortDate"),c.format(r.value.date[r.value.date.length-1],"shortDate")]:[c.format(r.value.date[0],"shortDate"),c.format(r.value.date[0],"shortDate")]:null);function J(){try{clearTimeout(G.value)}catch{}G.value=setTimeout(()=>{B.value=!0;let i="id",a="desc";console.log($.value),$.value.length>0&&(i=$.value[0].key,a=$.value[0].order),N.fetchItems({term:K.value,paginate:R.value,current_page:C.value,direction:a,order_by:i,page:S.value.page,per_page:S.value.itemsPerPage,...r.value,date:se.value}).then(l=>{if(l.data){const{data:_,current_page:oe,next_page_url:ne,total:X,per_page:ie,to:Pt,last_page:re}=l.data;T.value=_,I.value=re,M.value=X}}).catch(l=>{console.error(l)}).then(()=>{B.value=!1})},1e3)}function le(){O.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(i=>{if(i.data){const{data:a,current_page:l,next_page_url:_,total:oe,per_page:ne,to:X,last_page:ie}=i.data;F.value=a}}).catch(i=>{console.error(i)}).then(()=>{B.value=!1})}return ve([K,S,r],()=>{J()},{deep:!0}),ge(()=>{C.value>I.value&&(C.value=I.value)}),(i,a)=>(m(),w(_e,null,[e(ce,{title:`${D.value.title}(${M.value})`,breadcrumbs:k.value},null,8,["title","breadcrumbs"]),e(Vt,{"show-payments":"","show-description":"","show-total-payments":""}),e(L,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(Pe,{class:"border rounded-md",headers:te.value,loading:B.value,items:T.value,"multi-sort":!1,"items-per-page":R.value,"onUpdate:itemsPerPage":a[11]||(a[11]=l=>R.value=l),"items-per-page-text":i.$t("Articles par page"),options:S.value,"onUpdate:options":a[12]||(a[12]=l=>S.value=l),"sort-by":$.value,"onUpdate:sortBy":a[13]||(a[13]=l=>$.value=l),page:C.value,"onUpdate:page":a[14]||(a[14]=l=>C.value=l),"items-length":M.value,"onUpdate:itemsLength":a[15]||(a[15]=l=>M.value=l),"show-select":!1,"loading-text":i.$t("Chargement des éléments"),"no-data-text":i.$t("Pas de données"),"no-results-text":i.$t("Aucun résultat"),onPageCount:a[16]||(a[16]=l=>I.value=l)},{top:t(()=>[e(ke,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:t(()=>[e(L,null,{default:t(()=>[e(v,null,{default:t(()=>[e(z,{density:"compact",modelValue:r.value.search,"onUpdate:modelValue":a[0]||(a[0]=l=>r.value.search=l),placeholder:i.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),e(v,null,{default:t(()=>[e(xe,{density:"compact",modelValue:r.value.event_type,"onUpdate:modelValue":a[1]||(a[1]=l=>r.value.event_type=l),placeholder:i.$t("Prestation"),items:F.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo"},null,8,["modelValue","placeholder","items"])]),_:1}),e(v,null,{default:t(()=>[e(Q,{ref_key:"dialog",ref:Y,modelValue:U.value,"onUpdate:modelValue":a[7]||(a[7]=l=>U.value=l),"return-value":r.value.date,"onUpdate:returnValue":a[8]||(a[8]=l=>r.value.date=l),persistent:"",width:"290px"},{activator:t(({props:l})=>[e(z,ye({modelValue:q.value,"onUpdate:modelValue":a[2]||(a[2]=_=>q.value=_),"prepend-inner-icon":"bx-calendar",readonly:""},l,{density:"compact",placeholder:i.$t("Date"),"hide-details":"",variant:"solo",clearable:"","onClick:clear":a[3]||(a[3]=_=>r.value.date=null)}),null,16,["modelValue","placeholder"])]),default:t(({isActive:l})=>[e($e,{locale:"fr"},{default:t(()=>[e(De,{modelValue:r.value.date,"onUpdate:modelValue":a[6]||(a[6]=_=>r.value.date=_),"hide-header":"",multiple:"range"},{actions:t(()=>[e(p,{color:"primary",onClick:a[4]||(a[4]=_=>U.value=!1)},{default:t(()=>[V(n(i.$t("Annuler")),1)]),_:1}),e(y),e(p,{variant:"elevated",color:"primary",onClick:a[5]||(a[5]=_=>U.value=!1)},{default:t(()=>[V(n(i.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),e(Q,{modelValue:A.value,"onUpdate:modelValue":a[10]||(a[10]=l=>A.value=l),"max-width":"500px"},{default:t(()=>[e(b,null,{default:t(()=>[e(be,{class:"text-h5 text-center py-6"},{default:t(()=>[V(n(i.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),e(Ve,null,{default:t(()=>[e(y),e(p,{color:"error",variant:"flat",dark:"",onClick:a[9]||(a[9]=l=>A.value=!1)},{default:t(()=>[V(n(i.$t("Annuler")),1)]),_:1}),e(p,{color:"success",variant:"flat",dark:"",onClick:ae},{default:t(()=>[V(n(i.$t("OK")),1)]),_:1}),e(y)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.amount":t(({item:l})=>[V(n(h(j)(l.amount)),1)]),"item.payment_date":t(({item:l})=>[V(n(h(me)(l.payment_date)),1)]),"item.actions":t(({item:l})=>[e(p,{density:"compact",color:"primary",variant:"outlined",to:"/prestations/"+l.prestation_id},{default:t(()=>[V(n(i.$t("Voir la prestation liée")),1)]),_:2},1032,["to"])]),"no-data":t(()=>[s("span",null,n(i.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{Gt as default};
