import{u as U}from"./customers-Dz8ZtajH.js";import{a6 as X,r,av as G,aD as _,aE as H,h as J,e as y,g as K,q as O,o as n,c as p,_ as v,a4 as Q,w as a,b as s,aF as W,a as t,t as e,a8 as u,d as c,X as k,a5 as j,V as B}from"./index-CnqdZ6bH.js";import{_ as Y,V as A}from"./BaseBreadcrumb-CaIIjwv5.js";import{a as C,f as Z}from"./formatters-DCCWVJxZ.js";import{u as L}from"./demands-CLrZgVO3.js";import{u as z}from"./Controller-p4fNbWHW.js";import{_ as tt}from"./DemandForm.vue_vue_type_script_setup_true_lang-DoCBu6Iy.js";import{V as d,a as x}from"./VRow-DNBD6FjZ.js";import{a as m,d as P,V as h}from"./VCard-BZmd4FKQ.js";import{a as w,i as g}from"./VSpacer-CpZAU8TI.js";import"./VTextField-BCk_q3zb.js";import"./VAvatar-DMdepK6E.js";import"./EditorMenubar-CCyD4SmZ.js";import"./eventType-CZMhoidC.js";import"./hall-6z3V0lXB.js";import"./validators-BPi-vT8z.js";import"./vee-validate.esm-nTMicVF0.js";import"./VDialog-lQkbc7Zg.js";import"./VContainer-nfGnC2is.js";import"./VAutocomplete-BGq7kTXb.js";import"./VLocaleProvider-Dfy5JTur.js";import"./VDatePicker-fIXaz-qc.js";import"./VSheet-Beb1Gt-6.js";const et={class:"text-h6"},st={class:"text-subtitle-1 textSecondary mt-3"},at={class:"text-subtitle-1 textSecondary mt-3"},lt={class:"text-subtitle-1 textSecondary mt-3"},ot={class:"text-subtitle-1 textSecondary mt-3"},rt={class:"text-subtitle-1 textSecondary mt-3"},it={class:"text-subtitle-1 textSecondary mt-3"},nt={class:"d-flex align-start"},dt={class:"text-h4 mt-1"},ut={class:"mt-9"},ct={class:"text-h4 font-weight-semibold mb-1"},mt={class:"d-flex align-start"},ht={class:"text-h4 mt-1"},ft={class:"mt-9"},_t={class:"text-h4 font-weight-semibold mb-1"},pt={class:"d-flex align-start"},vt={class:"text-h4 mt-1"},gt={class:"mt-9"},bt={class:"text-h4 font-weight-semibold mb-1"},yt={class:"d-flex align-start"},xt={class:"text-h4 mt-1"},wt={class:"mt-9"},$t={class:"text-h4 font-weight-semibold mb-1"},Vt={class:"text-h6 d-flex align-center"},kt={class:"text-h6"},Ct={class:"text-h6"},Pt={class:"text-h6"},Dt={class:"text-h6"},St={class:"text-h6"},Tt={style:{"max-height":"500px"},class:"overflow-y-auto"},Et={class:"text-h6 font-weight-medium text-medium-emphasis"},It={class:"text-h6"},Nt={class:"text-h6"},jt={class:"text-h6"},Bt={class:"text-h6"},At={class:"text-h6"},Lt={class:"text-h6"},zt={class:"text-h6 font-weight-medium text-medium-emphasis"},de=X({__name:"View",setup(Mt){r(),G();const o=r({id:null,status:0,service:"",created_at:null,customer_id:null,prestation_id:null,customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),D=r({title:_("Détails")}),S=r([{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Client"),disabled:!1,href:"/customers"},{text:o.value.event_type||"",disabled:!0,href:"#"}]);function M(){D.value={title:_("Détails du client")},S.value=[{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Clients"),disabled:!1,href:"/customers"},{text:o.value.event_type||"",disabled:!0,href:"#"}]}const T=U(),E=H();J(()=>{V()});const f=r(!1);r(!1),r(100);const I=r(2),N=r(2);r(!1),r(!1),r(null);const F=r("");r(["primary","secondary","error","success","warning"]),r([{key:"created_at",order:"DESC"}]),r(0),r({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"created_at",order:"DESC"}]});const R=r(-1);r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const $=r({id:null,customer:{}});r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),r(!1),r([{title:"Prénom",align:"start",key:"customer.firstname",sortable:!1},{title:"Nom",align:"start",key:"customer.lastname",sortable:!1},{title:"Email",align:"start",key:"customer.email",sortable:!1},{title:"Téléphone",align:"start",key:"customer.phone",sortable:!1},{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la customere",align:"start",key:"created_at"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),y(()=>T.customers.data.filter(l=>l.email.toLowerCase().includes(F.value.toLowerCase())));const q=y(()=>E.params.id);y(()=>o.value.customer.customers?o.value.customer.customers.filter(l=>l.id!=o.value.id):[]),y(()=>R.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function V(){f.value=!0,T.fetchItem(E.params.id).then(l=>{l.data.error||(f.value=!1,o.value=l.data,M(),$.value={id:null,customer_id:o.value.id,customer:o.value})}).catch(l=>{f.value=!1}).then(()=>{f.value=!1})}return K(q,(l,b)=>{l!=b&&V()},{deep:!0}),O(()=>{I.value>N.value&&(I.value=N.value)}),(l,b)=>(n(),p(k,null,[f.value?Q("",!0):(n(),v(Y,{key:0,title:D.value.title,breadcrumbs:S.value},null,8,["title","breadcrumbs"])),f.value?(n(),v(x,{key:1,justify:"center",align:"center","align-content":"center"},{default:a(()=>[s(d,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:a(()=>[s(W,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(n(),v(x,{key:2},{default:a(()=>[s(d,{cols:"12"},{default:a(()=>[s(x,{align:"center"},{default:a(()=>[s(d,{cols:"12",md:"4"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-hidden h-100"},{default:a(()=>[s(P,{class:"py-4 px-6 text-white bg-primary"},{default:a(()=>[t("h4",et,e(l.$t("Identification du customereur")),1)]),_:1}),s(h,{class:"pa-6"},{default:a(()=>[t("p",st,e(l.$t("Prénom :"))+" "+e(o.value.firstname||""),1),t("p",at,e(l.$t("Nom :"))+" "+e(o.value.lastname||""),1),t("p",lt,e(l.$t("Email :"))+" "+e(o.value.email||""),1),t("p",ot,e(l.$t("Téléphone :"))+" "+e(o.value.phone||""),1),t("p",rt,e(l.$t("Date d'enregistrement :"))+" "+e(u(C)(o.value.created_at)||""),1),t("p",it,[c(e(l.$t("Type :"))+" ",1),o.value&&o.value.is_customer?(n(),v(w,{key:0,color:"success"},{default:a(()=>[c(e(l.$t("Client")),1)]),_:1})):(n(),v(w,{key:1,color:"error"},{default:a(()=>[c(e(l.$t("Prospect")),1)]),_:1}))])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"8"},{default:a(()=>[s(x,null,{default:a(()=>[s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-primary h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",nt,[t("h2",dt,e(l.$t("Devis")),1),s(g)]),t("div",ut,[t("h2",ct,e(o.value.demands?o.value.demands.length:0),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-info h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",mt,[t("h2",ht,e(l.$t("Prestations")),1),s(g)]),t("div",ft,[t("h2",_t,e(o.value.prestations?o.value.prestations.length:0),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-primary h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",pt,[t("h2",vt,e(l.$t("Paiements")),1),s(g)]),t("div",gt,[t("h2",bt,e(u(Z)(o.value.payments_sum_amount||0)),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-success h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",yt,[t("h2",xt,e(l.$t("Prestations Clôturées")),1),s(g)]),t("div",wt,[t("h2",$t,e(o.value.prestations_count||0),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",lg:"6"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-hidden h-100"},{default:a(()=>[s(P,{class:"py-4 px-6 text-white bg-info"},{default:a(()=>[t("h4",Vt,[c(e(l.$t("Les devis de"))+" "+e(o.value.firstname||"")+" "+e(o.value.lastname||"")+" ",1),s(g),s(tt,{modelValue:$.value,"onUpdate:modelValue":b[0]||(b[0]=i=>$.value=i),onSaved:V,"show-customer":!1},null,8,["modelValue"])])]),_:1}),s(h,{class:"pa-6"},{default:a(()=>[s(A,{class:"month-table"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",kt,e(l.$t("ID")),1),t("th",Ct,e(l.$t("Prestation")),1),t("th",Pt,e(l.$t("Date")),1),t("th",Dt,e(l.$t("Status")),1),t("th",St,e(l.$t("Action")),1)])]),t("tbody",Tt,[(n(!0),p(k,null,j(o.value.demands||[],i=>(n(),p("tr",{key:i.id,class:"month-item"},[t("td",null,e(i.id),1),t("td",null,[t("h6",Et,e(i.event_type),1)]),t("td",null,e(u(C)(i.demand_date)),1),t("td",null,[s(w,{rounded:"md",class:"font-weight-bold",color:u(L)().statusColor(i.status),size:"small",label:""},{default:a(()=>[c(e(u(L)().statusText(i.status)),1)]),_:2},1032,["color"])]),t("td",null,[s(B,{variant:"outlined",density:"compact",color:"info",to:"/demands/"+i.id},{default:a(()=>[c(e(l.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",lg:"6"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-hidden h-100"},{default:a(()=>[s(P,{class:"py-4 px-6 text-white bg-info"},{default:a(()=>[t("h4",It,e(l.$t("Prestations de devis de"))+" "+e(o.value.firstname||"")+" "+e(o.value.lastname||""),1)]),_:1}),s(h,{class:"pa-6"},{default:a(()=>[s(A,{class:"month-table"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",Nt,e(l.$t("ID")),1),t("th",jt,e(l.$t("Prestation")),1),t("th",Bt,e(l.$t("Date")),1),t("th",At,e(l.$t("Status")),1),t("th",Lt,e(l.$t("Action")),1)])]),t("tbody",null,[(n(!0),p(k,null,j(o.value.prestations||[],i=>(n(),p("tr",{key:i.id,class:"month-item"},[t("td",null,e(i.id),1),t("td",null,[t("h6",zt,e(i.event_type),1)]),t("td",null,e(u(C)(i.demand_date)),1),t("td",null,[s(w,{rounded:"md",class:"font-weight-bold",color:u(z)().statusColor(i.status),size:"small",label:""},{default:a(()=>[c(e(u(z)().statusText(i.status)),1)]),_:2},1032,["color"])]),t("td",null,[s(B,{variant:"outlined",density:"compact",color:"info",to:"/prestations/"+i.id},{default:a(()=>[c(e(l.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))],64))}});export{de as default};
