import{u as F}from"./Controller-CGuKbF3w.js";import{a6 as q,e as U,o as c,_ as g,w as t,b as e,a as s,d as $,t as a,c as D,a4 as P,av as z,r as m,aM as A,n as G,V as w,a8 as h,h as me,Z as K,aN as ce,g as ve,aO as pe,X as ee,a5 as se}from"./index-DxRp-6ls.js";import{_ as fe,V as oe}from"./BaseBreadcrumb-DdIb8IZf.js";import{a as N,f as R}from"./formatters-ChhyeSK0.js";import{d as J,V as O,a as M,b as Q,c as W}from"./VCard-CpcqkSNI.js";import{f as B}from"./VMenu-BLuWJsyc.js";import{a as E,V as k}from"./VRow-AnA309xR.js";import{V as ae}from"./VTextarea-BjAxUCOY.js";import{a as I,V as te}from"./VSpacer-CxsORflG.js";import{V as X}from"./VDialog-DvWydnMA.js";import{u as _e}from"./service-ylzki2aX.js";import{V as he}from"./VAutocomplete-ChZbWR_f.js";import{V as ne}from"./VTextField-CrbR8xC7.js";import{a as ue,b as $e,_ as re}from"./PaymentForm.vue_vue_type_script_setup_true_lang-DJJWsfXg.js";import{V as Ve}from"./VAlert-xty-pCYF.js";import{V as de}from"./VTooltip-BmfajbKD.js";import"./VAvatar-z7B7HW94.js";import"./VSelect-BF9qQHUY.js";import"./filter-B55luNZI.js";import"./hall-CPoosH9C.js";import"./paymentMethod-BX7eyNVa.js";import"./VLocaleProvider-CYnnLH16.js";import"./VDatePicker-CRX3vo6l.js";import"./VSheet-7Uc3AtEo.js";const ye={class:"text-h6 d-flex align-content-center align-center"},ge=s("br",null,null,-1),be={class:"text-subtitle-1 textSecondary mt-3"},ke={class:"text-subtitle-1 textSecondary mt-3"},Ce={class:"text-subtitle-1 textSecondary mt-3"},Se={class:"text-subtitle-1 textSecondary mt-3"},xe={class:"text-subtitle-1 textSecondary mt-3"},we={key:0,class:"text-subtitle-1 textSecondary mt-3"},je={key:1,class:"text-subtitle-1 textSecondary mt-3"},Pe={key:2,class:"text-subtitle-1 textSecondary mt-3"},Ue={key:3,class:"text-subtitle-1 textSecondary mt-3"},Ae={key:4,class:"text-subtitle-1 textSecondary mt-3"},Ie={key:5,class:"text-subtitle-1 textSecondary mt-3"},De={class:"text-subtitle-1 textSecondary mt-3"},Oe=["innerHTML"],Te=q({__name:"HallWidget",props:{modelValue:Object,showDemandInfo:Boolean},emits:["update:modelValue"],setup(j,{emit:l}){F();const p=j,x=l,v=U({get:()=>p.modelValue,set:d=>x("update:modelValue",d)});return(d,i)=>(c(),g(M,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(J,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[s("h4",ye,[$(a(d.$t("Information de la salle"))+" ",1),e(I),e(ue,{modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=n=>v.value=n)},null,8,["modelValue"])])]),_:1}),v.value.hall?(c(),g(O,{key:1,class:"pl-6 pr-6"},{default:t(()=>[s("p",be,a(d.$t("Nom :"))+" "+a(v.value.hall.name||""),1),s("p",ke,a(d.$t("Adresse :"))+" "+a(v.value.hall.address||""),1),s("p",Ce,a(d.$t("Nom du régisseur :"))+" "+a(v.value.hall.manager_name||""),1),s("p",Se,a(d.$t("Téléphone du régisseur :"))+" "+a(v.value.hall.manager_phone||""),1),s("p",xe,a(d.$t("Mail du régisseur :"))+" "+a(v.value.hall.manager_email||""),1),v.value.hall.packing?(c(),D("p",we,a(d.$t("Parking :"))+" "+a("Oui"),1)):P("",!0),v.value.hall.kitchen?(c(),D("p",je,a(d.$t("Cuisine :"))+" "+a("Oui"),1)):P("",!0),v.value.hall.cold_rooom?(c(),D("p",Pe,a(d.$t("Chambre froidre :"))+" "+a("Oui"),1)):P("",!0),v.value.hall.ladder?(c(),D("p",Ue,a(d.$t("Escalier pour déchargement :"))+" "+a("Oui"),1)):P("",!0),v.value.hall.transportation_fee?(c(),D("p",Ae,a(d.$t("Frais de déplacement à prévoir :"))+" "+a("Oui"),1)):P("",!0),v.value.hall.table?(c(),D("p",Ie,a(d.$t("Table de buffet :"))+" "+a("Oui"),1)):P("",!0),s("p",De,a(d.$t("Bac de poubelle :"))+" "+a(v.value.hall.bin=="salle"?d.$t("Géré par la salle"):d.$t("Géré par le client")),1),s("p",{class:"text-subtitle-1 textSecondary mt-3",innerHTML:v.value.hall.comment?v.value.hall.comment:""},null,8,Oe)]),_:1})):(c(),g(O,{key:0,class:"pl-6 pr-6 pt-6"},{default:t(()=>[e(Ve,{type:"info"},{default:t(()=>[$(a(d.$t("Aucune salle n'a été attribuée. Veuillez attribuer une salle."))+" ",1),ge,e(ue,{modelValue:v.value,"onUpdate:modelValue":i[1]||(i[1]=n=>v.value=n)},null,8,["modelValue"])]),_:1})]),_:1}))]),_:1}))}}),Me=q({__name:"CancelPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=F(),x=z(),v=j,d=l,i=U({get:()=>v.modelValue,set:o=>d("update:modelValue",o)}),n=m(!1),f=m(!1),C=m("");U(()=>`${A("Annuler la prestation")}`);function V(){f.value=!0,p.cancelItem(i.value.id,C.value).then(o=>{i.value=o.data,n.value=!1,x.showSuccess(A("Prestation annulée avec succès"))}).catch(o=>{f.value=!1,x.showError(o.message)}).then(()=>{f.value=!1})}return(o,_)=>(c(),g(X,{modelValue:n.value,"onUpdate:modelValue":_[3]||(_[3]=u=>n.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(w,G({class:"ml-2",dark:""},u,{variant:"outlined",color:"primary",onClick:_[0]||(_[0]=b=>f.value=!1)}),{default:t(()=>[$(a(o.$t("Annuler la prestation")),1)]),_:2},1040)]),default:t(()=>[e(M,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[$(a(o.$t("Annuler la prestation")),1)]),_:1}),e(B),e(O,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12",class:"text-center"},{default:t(()=>[$(a(o.$t("Êtes-vous sûr de vouloir Annuler la prestation?")),1)]),_:1}),e(k,{cols:"12"},{default:t(()=>[e(ae,{modelValue:C.value,"onUpdate:modelValue":_[1]||(_[1]=u=>C.value=u),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(B),e(W,null,{default:t(()=>[e(I),e(w,{color:"error",variant:"flat",dark:"",onClick:_[2]||(_[2]=u=>n.value=!1)},{default:t(()=>[$(a(o.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:V},{default:t(()=>[$(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(I)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ee=q({__name:"ValidatePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=F(),x=z(),v=j,d=l,i=U({get:()=>v.modelValue,set:o=>d("update:modelValue",o)}),n=m(!1),f=m(!1),C=m("");U(()=>`${A("Valider la prestation")}`);function V(){f.value=!0,p.validateItem(i.value.id,C.value).then(o=>{i.value=o.data,n.value=!1,x.showSuccess(A("Prestation validée avec succès"))}).catch(o=>{f.value=!1,x.showError(o.message)}).then(()=>{f.value=!1})}return(o,_)=>(c(),g(X,{modelValue:n.value,"onUpdate:modelValue":_[3]||(_[3]=u=>n.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(w,G({dark:""},u,{variant:"elevated",color:"primary",onClick:_[0]||(_[0]=b=>f.value=!1)}),{default:t(()=>[$(a(i.value.status==h(p).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:2},1040)]),default:t(()=>[e(M,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[$(a(i.value.status==h(p).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:1}),e(B),e(O,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12",class:"text-center"},{default:t(()=>[$(a(i.value.status==h(p).statuses.cancelled?o.$t("Êtes-vous sûr de vouloir Rouvrir la prestation"):o.$t("Êtes-vous sûr de vouloir Valider la prestation?")),1)]),_:1}),i.value.status==h(p).statuses.cancelled?(c(),g(k,{key:0,cols:"12"},{default:t(()=>[e(ae,{modelValue:C.value,"onUpdate:modelValue":_[1]||(_[1]=u=>C.value=u),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})):P("",!0)]),_:1})]),_:1}),e(B),e(W,null,{default:t(()=>[e(I),e(w,{color:"error",variant:"flat",dark:"",onClick:_[2]||(_[2]=u=>n.value=!1)},{default:t(()=>[$(a(o.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:V},{default:t(()=>[$(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(I)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ne={class:"text-h6"},Be={class:"text-subtitle-1 textSecondary mt-3"},Fe={class:"text-subtitle-1 textSecondary mt-3"},qe={class:"text-subtitle-1 textSecondary mt-3"},Le={class:"text-subtitle-1 textSecondary mt-3"},Re={class:"text-subtitle-1 textSecondary mt-3"},ze={class:"text-subtitle-1 textSecondary mt-3"},He={class:"text-subtitle-1 textSecondary mt-3"},Ge={class:"text-subtitle-1 textSecondary mt-3"},Qe={class:"text-subtitle-1 textSecondary mt-3"},We={key:0,class:"text-subtitle-1 textSecondary mt-3"},Xe={key:1,class:"text-subtitle-1 textSecondary mt-3"},Ze=q({__name:"CustomerWidget",props:{modelValue:Object,showDemandInfo:Boolean},emits:["update:modelValue"],setup(j,{emit:l}){const p=F(),x=j,v=l,d=U({get:()=>x.modelValue,set:i=>v("update:modelValue",i)});return(i,n)=>(c(),g(M,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(J,{class:"py-4 px-6 text-white bg-primary"},{default:t(()=>[s("h4",Ne,a(i.$t("Identification du demandeur")),1)]),_:1}),e(O,{class:"pl-6 pr-6"},{default:t(()=>[s("p",Be,a(i.$t("Prénom :"))+" "+a(d.value.customer.firstname||""),1),s("p",Fe,a(i.$t("Nom :"))+" "+a(d.value.customer.lastname||""),1),s("p",qe,a(i.$t("Email :"))+" "+a(d.value.customer.email||""),1),s("p",Le,a(i.$t("Téléphone :"))+" "+a(d.value.customer.phone||""),1),s("p",Re,a(i.$t("Date d'enregistrement :"))+" "+a(h(N)(d.value.customer.created_at)||""),1),s("p",ze,[$(a(i.$t("Type :"))+" ",1),d.value.customer&&d.value.customer.is_customer?(c(),g(te,{key:0,color:"success"},{default:t(()=>[$(a(i.$t("Client")),1)]),_:1})):(c(),g(te,{key:1,color:"error"},{default:t(()=>[$(a(i.$t("Prospect")),1)]),_:1}))])]),_:1}),j.showDemandInfo?(c(),g(O,{key:0,class:"pt-0 pb-0"},{default:t(()=>[e(B)]),_:1})):P("",!0),j.showDemandInfo?(c(),g(O,{key:1,class:"pl-6 pr-6"},{default:t(()=>[s("p",He,a(i.$t("Type événement :"))+" "+a(d.value.event_type||""),1),s("p",Ge,a(i.$t("Date de la demande :"))+" "+a(h(N)(d.value.demand_date)||""),1),s("p",Qe,a(i.$t("Date création de la prestation :"))+" "+a(h(N)(d.value.created_at)||""),1),d.value.status>=h(p).statuses.processing?(c(),D("p",We,a(i.$t("Date lancement de la prestation :"))+" "+a(h(N)(d.value.start_date)||""),1)):P("",!0),d.value.status>=h(p).statuses.closed?(c(),D("p",Xe,a(i.$t("Date clôture de la prestation :"))+" "+a(h(N)(d.value.closed_date)||""),1)):P("",!0)]),_:1})):P("",!0)]),_:1}))}}),Je={key:1},ie=q({__name:"ServiceForm",props:{modelValue:Object,prestation:Object,title:A("Service"),buttonText:A("Ajouter un service")},emits:["update:modelValue","update:item"],setup(j,{emit:l}){const p=F(),x=z(),v=_e(),d=j,i=l,n=U({get:()=>d.modelValue,set:u=>i("update:modelValue",u)}),f=m(!1),C=m(!1),V=m([]);me(()=>{v.fetchItems({per_page:500}).then(u=>{V.value=u.data.data,console.log(V.value)})});function o(){C.value=!0,p.saveService(d.prestation.id,n.value).then(u=>{f.value=!1,i("update:item",u.data),x.showSuccess(A("Service enregistré avec succès"))}).catch(u=>{C.value=!1,x.showError(u.message)}).then(()=>{C.value=!1})}function _(u){if(u){const b=V.value.find(H=>H.name==u);b&&(n.value.quantity=n.value.quantity||1,n.value.service_id=b.id||null,n.value.price=b.price||0,n.value.total=(n.value.quantity||1)*(b.price||0))}}return(u,b)=>{const H=K("EditIcon");return c(),g(X,{modelValue:f.value,"onUpdate:modelValue":b[5]||(b[5]=T=>f.value=T),"max-width":"500px"},{activator:t(({props:T})=>[e(w,G({dark:""},T,{icon:n.value.id!=null,flat:n.value.id!=null,variant:"elevated",color:n.value.id!=null?null:"primary",onClick:b[0]||(b[0]=r=>C.value=!1)}),{default:t(()=>[n.value.id?(c(),g(H,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(c(),D("span",Je,a(j.buttonText),1))]),_:2},1040,["icon","flat","color"])]),default:t(()=>[e(M,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[$(a(j.title),1)]),_:1}),e(B),e(O,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[e(he,{modelValue:n.value.name,"onUpdate:modelValue":[b[1]||(b[1]=T=>n.value.name=T),_],label:u.$t("Service"),clearable:"",items:V.value,"item-title":"name","item-value":"name",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(ne,{min:1,modelValue:n.value.quantity,"onUpdate:modelValue":b[2]||(b[2]=T=>n.value.quantity=T),type:"number",label:u.$t("Quantité")},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(ne,{min:0,modelValue:n.value.price,"onUpdate:modelValue":b[3]||(b[3]=T=>n.value.price=T),type:"number",label:u.$t("Prix")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(W,null,{default:t(()=>[e(I),e(w,{color:"error",variant:"flat",dark:"",onClick:b[4]||(b[4]=T=>f.value=!1)},{default:t(()=>[$(a(u.$t("Annuler")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:C.value,dark:"",onClick:o},{default:t(()=>[$(a(u.$t("Ajouter")),1)]),_:1},8,["loading"]),e(I)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Ke=q({__name:"DeleteService",props:{modelValue:Object,service:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=F(),x=z(),v=j,d=l,i=U({get:()=>v.modelValue,set:V=>d("update:modelValue",V)}),n=m(!1),f=m(!1);function C(){f.value=!0,p.deleteService(i.value.id,v.service.id).then(V=>{i.value=V.data,n.value=!1,x.showSuccess(A("Service supprimé avec succès"))}).then(()=>{n.value=!1,f.value=!1})}return(V,o)=>{const _=K("TrashIcon");return c(),g(X,{modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=u=>n.value=u),"max-width":"350px"},{activator:t(({props:u})=>[e(w,G({icon:"",flat:"",class:"ml-3",dark:""},u,{onClick:o[0]||(o[0]=b=>f.value=!1)}),{default:t(()=>[e(_,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040)]),default:t(()=>[e(M,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[$(a(V.$t("Êtes-vous sûr de vouloir supprimer le service?")),1)]),_:1}),e(W,null,{default:t(()=>[e(I),e(w,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=u=>n.value=!1)},{default:t(()=>[$(a(V.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:C},{default:t(()=>[$(a(V.$t("Oui")),1)]),_:1},8,["loading"]),e(I)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Ye=q({__name:"DeletePayment",props:{modelValue:Object,payment:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=F(),x=z(),v=j,d=l,i=U({get:()=>v.modelValue,set:V=>d("update:modelValue",V)}),n=m(!1),f=m(!1);function C(){f.value=!0,p.deletePayment(v.payment.prestation_id,v.payment.id).then(V=>{i.value=V.data,n.value=!1,x.showSuccess(A("Paiement supprimé avec succès"))}).then(()=>{n.value=!1,f.value=!1})}return(V,o)=>{const _=K("TrashIcon");return c(),g(X,{modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=u=>n.value=u),"max-width":"350px"},{activator:t(({props:u})=>[e(w,G({icon:"",flat:"",class:"ml-3",dark:""},u,{onClick:o[0]||(o[0]=b=>f.value=!1)}),{default:t(()=>[e(_,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040)]),default:t(()=>[e(M,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[$(a(V.$t("Êtes-vous sûr de vouloir supprimer le paiement?")),1)]),_:1}),e(W,null,{default:t(()=>[e(I),e(w,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=u=>n.value=!1)},{default:t(()=>[$(a(V.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:C},{default:t(()=>[$(a(V.$t("Oui")),1)]),_:1},8,["loading"]),e(I)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),et=q({__name:"CommentPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=F(),x=z(),v=j,d=l,i=U({get:()=>v.modelValue,set:o=>d("update:modelValue",o)}),n=m(!1),f=m(!1),C=m(i.value.commentaire||"");U(()=>`${A("Commentaire")}`);function V(){f.value=!0,p.addComment(i.value.id,C.value).then(o=>{i.value=o.data,n.value=!1,x.showSuccess(A("Commentaire ajouté avec succès"))}).catch(o=>{f.value=!1,x.showError(o.message)}).then(()=>{f.value=!1})}return(o,_)=>(c(),g(X,{modelValue:n.value,"onUpdate:modelValue":_[3]||(_[3]=u=>n.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(w,G({density:"compact",dark:""},u,{variant:"outlined",color:"primary",onClick:_[0]||(_[0]=b=>f.value=!1)}),{default:t(()=>[$(a(!i.value.commentaire||i.value.commentaire.length==0?o.$t("Ajouter"):o.$t("Modifier")),1)]),_:2},1040)]),default:t(()=>[e(M,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[$(a(!i.value.commentaire||i.value.commentaire.length==0?o.$t("Ajouter un commentaire"):o.$t("Modifier le commentaire")),1)]),_:1}),e(B),e(O,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[e(ae,{modelValue:C.value,"onUpdate:modelValue":_[1]||(_[1]=u=>C.value=u),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(B),e(W,null,{default:t(()=>[e(I),e(w,{color:"error",variant:"flat",dark:"",onClick:_[2]||(_[2]=u=>n.value=!1)},{default:t(()=>[$(a(o.$t("Annuler")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:V},{default:t(()=>[$(a(o.$t("Enregistrer")),1)]),_:1},8,["loading"]),e(I)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),tt={key:0,class:"ml-2"},at={class:"d-flex align-start"},lt={class:"text-h4 mt-1"},st={class:"ml-auto"},ot={class:"mt-9"},nt={class:"text-h4 font-weight-semibold mb-1"},ut={class:"d-flex align-start"},rt={class:"text-h4 mt-1"},dt={class:"ml-auto"},it={class:"mt-9"},mt={class:"text-h4 font-weight-semibold mb-1"},ct={class:"d-flex align-start"},vt={class:"text-h4 mt-1"},pt={class:"mt-4"},ft={class:"mb-1"},_t={class:"d-flex align-start"},ht={class:"text-h4 mt-1"},$t={class:"mt-4"},Vt={class:"mb-1"},yt={class:"d-flex align-start"},gt={class:"text-h4 mt-1"},bt={class:"mt-4"},kt={class:"mb-1"},Ct={class:"text-h6 d-flex align-center"},St={class:"text-h6"},xt={class:"text-h6"},wt={class:"text-h6"},jt={class:"text-h6"},Pt={class:"text-h6"},Ut={key:0,class:"d-flex align-center"},At={class:"text-h6 d-flex align-center"},It={class:"mr-2"},Dt={class:"text-h6"},Ot={class:"text-h6"},Tt={class:"text-h6"},Mt={class:"text-h6"},ua=q({__name:"View",setup(j){m(),z();const l=m({id:null,status:0,service:"",demand_date:null,customer_id:null,demand_id:null,payments:[],services:[],customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),p=F(),x=ce(),v=m({title:A("Détails du prestation")+" "+(l.value.event_type||"")+" "+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(N(l.value.demand_date)||"")}),d=m([{text:A("Dashboard"),disabled:!1,href:"/"},{text:A("Prestations"),disabled:!1,href:"/prestations"},{text:l.value.event_type||"",disabled:!0,href:"#"}]);function i(){v.value={title:A("Prestation")+" "+(l.value.demand.event_type||"")+" ("+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(N(l.value.event_date)||"")+")"},d.value=[{text:A("Dashboard"),disabled:!1,href:"/"},{text:A("Prestations"),disabled:!1,href:"/prestations"},{text:v.value.title,disabled:!0,href:"#"}]}me(()=>{H()});const n=m(!1);m(!1),m(!1),m(!1),m(!1),m(!1),m(!1),m({}),m({}),m(!1),m(10),m(2),m(2),m(!1),m(!1),m(null);const f=m("");m(["primary","secondary","error","success","warning"]),m([{key:"demand_date",order:"DESC"}]),m(0),m({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"demand_date",order:"DESC"}]});const C=m(-1);m({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const V=m({id:null,service_id:null,name:"",price:0,total:0,quantity:0}),o=m({id:null,prestation_id:null,amount:0});m({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),m(!1),m([{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la prestation",align:"start",key:"demand_date"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),U(()=>p.prestations.data.filter(r=>r.email.toLowerCase().includes(f.value.toLowerCase())));const _=U(()=>x.params.id);U(()=>l.value.customer.prestations?l.value.customer.prestations.filter(r=>r.id!=l.value.id):[]);const u=U(()=>l.value.services&&l.value.services.length?l.value.services.reduce((r,y)=>(console.log(y.total,r),parseFloat(y.total)+parseFloat(r)),0):0),b=U(()=>l.value.payments&&l.value.payments.length?u.value-l.value.payments.reduce((r,y)=>parseFloat(y.amount)+parseFloat(r),0):u.value);U(()=>C.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function H(){n.value=!0,p.fetchItem(x.params.id).then(r=>{r.data.error||(n.value=!1,l.value=r.data,i())}).catch(r=>{n.value=!1}).then(()=>{n.value=!1})}function T(r){l.value=r}return ve(_,(r,y)=>{r!=y&&H()},{deep:!0}),(r,y)=>{const le=K("CurrencyEuroIcon");return c(),D(ee,null,[n.value?P("",!0):(c(),g(fe,{key:0,title:v.value.title,breadcrumbs:d.value},null,8,["title","breadcrumbs"])),n.value?(c(),g(E,{key:1,justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(k,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(pe,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(c(),g(E,{key:2},{default:t(()=>[e(k,{cols:"12",md:"4"},{default:t(()=>[$(a(r.$t("Status :"))+" ",1),e(te,{rounded:"md",class:"font-weight-bold",color:h(p).statusColor(l.value.status),size:"small",label:""},{default:t(()=>[$(a(h(p).statusText(l.value.status)),1)]),_:1},8,["color"]),l.value.status==h(p).statuses.cancelled?(c(),D("span",tt,a(r.$t("Le"))+" "+a(h(N)(l.value.cancelled_date)||""),1)):P("",!0)]),_:1}),e(k,{cols:"12",md:"8",justify:"end","align-content":"end",align:"end"},{default:t(()=>[l.value.status==h(p).statuses.started||l.value.status==h(p).statuses.cancelled?(c(),g(Ee,{key:0,modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=S=>l.value=S)},null,8,["modelValue"])):P("",!0),l.value.status==h(p).statuses.validated?(c(),g($e,{key:1,modelValue:l.value,"onUpdate:modelValue":y[1]||(y[1]=S=>l.value=S)},null,8,["modelValue"])):P("",!0),l.value.status!=h(p).statuses.cancelled?(c(),g(Me,{key:2,modelValue:l.value,"onUpdate:modelValue":y[2]||(y[2]=S=>l.value=S)},null,8,["modelValue"])):P("",!0),e(B,{vertical:""}),e(w,{variant:"elevated",color:"success",class:"ml-2",to:"/customers/"+l.value.customer_id},{default:t(()=>[$(a(r.$t("Voir le Client")),1)]),_:1},8,["to"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(Ze,{modelValue:l.value,"onUpdate:modelValue":y[3]||(y[3]=S=>l.value=S),"show-demand-info":""},null,8,["modelValue"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(Te,{modelValue:l.value,"onUpdate:modelValue":y[4]||(y[4]=S=>l.value=S),"show-demand-info":""},null,8,["modelValue"])]),_:1}),e(k,{cols:"12",md:"6",class:"justify-end align-end"},{default:t(()=>[e(E,{class:"align-end justify-end align-content-end"},{default:t(()=>[e(k,{cols:"12",class:"align-end justify-end align-content-end"},{default:t(()=>[e(E,{class:"align-end justify-end align-content-end"},{default:t(()=>[l.value.status>=h(p).statuses.validated?(c(),g(k,{key:0,cols:"12",md:"6",class:""},{default:t(()=>[e(M,{elevation:"10"},{default:t(()=>[e(O,null,{default:t(()=>[s("div",at,[s("h2",lt,a(r.$t("Reste à payer")),1),e(I),s("div",st,[e(w,{color:"primary",icon:"",flat:""},{default:t(()=>[e(le)]),_:1})])]),s("div",ot,[s("h2",nt,a(h(R)(b.value)),1)])]),_:1})]),_:1})]),_:1})):P("",!0),e(k,{cols:"12",md:"6"},{default:t(()=>[e(M,{elevation:"10"},{default:t(()=>[e(O,null,{default:t(()=>[s("div",ut,[s("h2",rt,a(r.$t("Montant total")),1),e(I),s("div",dt,[e(w,{color:"primary",icon:"",flat:""},{default:t(()=>[e(le)]),_:1})])]),s("div",it,[s("h2",mt,a(h(R)(l.value.payment_total||0))+"/"+a(h(R)(u.value||0)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",class:"align-end justify-end align-content-end"},{default:t(()=>[e(E,{class:"align-end justify-end align-content-end"},{default:t(()=>[e(k,{class:"h-100",cols:"12"},{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12",md:"6"},{default:t(()=>[e(M,{elevation:"10",class:"h-100"},{default:t(()=>[e(O,null,{default:t(()=>[s("div",ct,[s("h2",vt,a(r.$t("Note liée à la prestation")),1)]),s("div",pt,[s("p",ft,a(l.value.comment||r.$t("Aucun note")),1)])]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(M,{elevation:"10",class:"h-100"},{default:t(()=>[e(O,null,{default:t(()=>[s("div",_t,[s("h2",ht,a(r.$t("Commentaire")),1),e(et,{modelValue:l.value,"onUpdate:modelValue":y[5]||(y[5]=S=>l.value=S)},null,8,["modelValue"])]),s("div",$t,[s("p",Vt,a(l.value.commentaire||r.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l.value.status==h(p).statuses.cancelled?(c(),g(k,{key:0,cols:"12"},{default:t(()=>[e(M,{elevation:"10",class:"h-100"},{default:t(()=>[e(O,null,{default:t(()=>[s("div",yt,[s("h2",gt,a(r.$t("Raison de l'annulation")),1)]),s("div",bt,[s("p",kt,a(l.value.cancel_comment||r.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1})):P("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",lg:l.value.status>h(p).statuses.started?"6":"12"},{default:t(()=>[e(M,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(J,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[s("h4",Ct,[s("span",null,a(r.$t("Désignation des services attendus")),1),e(I),e(ie,{modelValue:V.value,"onUpdate:modelValue":y[6]||(y[6]=S=>V.value=S),prestation:l.value,"onUpdate:item":T,"button-text":r.$t("Ajouter un service"),title:r.$t("Ajouter un service")},null,8,["modelValue","prestation","button-text","title"])])]),_:1}),e(O,{class:"pa-6"},{default:t(()=>[e(oe,{class:"month-table"},{default:t(()=>[s("thead",null,[s("tr",null,[s("th",St,a(r.$t("Désignation")),1),s("th",xt,a(r.$t("Quantité")),1),s("th",wt,a(r.$t("Prix unitaire")),1),s("th",jt,a(r.$t("Prix total")),1),s("th",Pt,a(r.$t("Actions")),1)])]),s("tbody",null,[(c(!0),D(ee,null,se(l.value.services,(S,L)=>(c(),D("tr",{key:S.id,class:"month-item"},[s("td",null,a(S.name),1),s("td",null,a(S.quantity),1),s("td",null,a(h(R)(S.price)),1),s("td",null,a(h(R)(S.total)),1),s("td",null,[l.value.status<h(p).statuses.processing?(c(),D("div",Ut,[e(de,{text:r.$t("Modifier")},{activator:t(({props:Z})=>[e(ie,{modelValue:l.value.services[L],"onUpdate:modelValue":Y=>l.value.services[L]=Y,prestation:l.value,"onUpdate:item":T,"button-text":r.$t("Modifier le service"),title:r.$t("Modifier le service")},null,8,["modelValue","onUpdate:modelValue","prestation","button-text","title"])]),_:2},1032,["text"]),e(Ke,{modelValue:l.value,"onUpdate:modelValue":y[7]||(y[7]=Z=>l.value=Z),service:l.value.services[L]},null,8,["modelValue","service"])])):P("",!0)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"]),l.value.status>h(p).statuses.started?(c(),g(k,{key:0,cols:"12",lg:l.value.status>h(p).statuses.started?"6":"12"},{default:t(()=>[e(M,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(J,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[s("h4",At,[s("span",It,a(r.$t("Paiements")),1),$(" : "+a(l.value.payments.length)+" - "+a(h(R)(l.value.payment_total||0))+" ",1),e(I),e(re,{prestation:l.value,"onUpdate:item":T,"button-text":r.$t("Ajouter un paiement"),title:r.$t("Ajouter un paiement")},null,8,["prestation","button-text","title"])])]),_:1}),e(O,{class:"pa-6"},{default:t(()=>[e(oe,{class:"month-table"},{default:t(()=>[s("thead",null,[s("tr",null,[s("th",Dt,a(r.$t("Mode de paiement")),1),s("th",Ot,a(r.$t("Montant payé")),1),s("th",Tt,a(r.$t("Date du paiement")),1),s("th",Mt,a(r.$t("Actions")),1)])]),s("tbody",null,[(c(!0),D(ee,null,se(l.value.payments,(S,L)=>(c(),D("tr",{key:o.value.id},[s("td",null,a(S.payment_method),1),s("td",null,a(h(R)(S.amount)),1),s("td",null,a(h(N)(S.payment_date)),1),s("td",null,[e(de,{text:r.$t("Modifier")},{activator:t(({props:Z})=>[e(re,{modelValue:l.value.payments[L],"onUpdate:modelValue":Y=>l.value.payments[L]=Y,icon:"",prestation:l.value,"onUpdate:item":T,"button-text":r.$t("Modifier le paiement"),title:r.$t("Modifier le paiement")},null,8,["modelValue","onUpdate:modelValue","prestation","button-text","title"])]),_:2},1032,["text"]),e(Ye,{modelValue:l.value,"onUpdate:modelValue":y[8]||(y[8]=Z=>l.value=Z),payment:l.value.payments[L]},null,8,["modelValue","payment"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"])):P("",!0)]),_:1}))],64)}}});export{ua as default};
