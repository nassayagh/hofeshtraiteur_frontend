import{u as X}from"./customers-jwbx1cBA.js";import{u as Y}from"./eventType-BUh3A0pt.js";import{_ as Z}from"./BaseBreadcrumb-CZWnI0nK.js";import{f as ee}from"./formatters-Dv1Ro_l4.js";import{O as te,ad as ae,r as t,aa as le,ae as w,h as re,e as b,g as oe,q as se,o as ne,c as ue,b as r,w as o,n as ie,V as f,d as i,t as n,Q as de,a as me,M as pe}from"./index--eSAaoua.js";import{V as $,a as E}from"./VRow-BqVouQvo.js";import{V as ve}from"./VDataTableServer-BSZaLEkB.js";import{V as fe}from"./VToolbar-v-kq36CI.js";import{V as I}from"./VTextField-BIunycXo.js";import{V as B}from"./VDialog-cLqV7fjH.js";import{V as ce}from"./VLocaleProvider-BbsbWvyY.js";import{V as ge}from"./VDatePicker-_UbfQL0K.js";import{V as _}from"./VSpacer-BLion4vj.js";import{V as Ve,a as ye,b as he}from"./VCard-C_EOskDD.js";import{V as be}from"./VChip-BkiHneXL.js";/* empty css              */import"./VDataTable-BW0Rty__.js";import"./VSelect-C3ZqDHK6.js";import"./VInput-BZmnskkf.js";import"./index-DyKrsRPI.js";import"./VList-BFwTxV7r.js";import"./ssrBoot-7kARyJyG.js";import"./createSimpleFunctional-BNLeBn9G.js";import"./VAvatar-DO5dze8k.js";import"./VDivider-DAcvfAJ7.js";import"./dialog-transition-mxOinYMm.js";import"./VMenu-B-yKHGiX.js";import"./VCheckboxBtn-zj9NycWb.js";import"./VSelectionControl-CgstZIWm.js";import"./VLabel-YNF6VYNN.js";import"./VTable-BUYeiApe.js";import"./filter-BdPhCt1f.js";/* empty css                   */import"./VField-CkYLJqxY.js";import"./VSheet-hEtF3JVK.js";import"./VSlideGroup-xxvn732U.js";const ot=te({__name:"List",setup(Ce){const d=ae();t();const j=le(),L=Y(),N=t({title:"Clients"}),M=t([{text:w("Dashboard"),disabled:!1,href:"/"},{text:w("Clients"),disabled:!0,href:"#"}]),c=t([]),O=t([]),C=X();re(()=>{T(),Q()});const g=t(!1);t(!1),t(!1),t(!1),t(!1),t(""),t(),t(!1);const S=t(null);t(null),t(null),t(null);const V=t(!1);t();const k=t(10),p=t(2),y=t(2),P=t(0);t(!1);const R=t(!1);t(null);const D=t("");t(["primary","secondary","error","success","warning"]);const m=t([{key:"created_at",order:"DESC"}]);t(0);const s=t({search:null,status:null,date:null,event_type:null}),v=t({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"created_at",order:"DESC"}]}),F=t(-1),U=t({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});t({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const h=t(!1),K=t([{title:"Prénom",align:"start",key:"firstname"},{title:"Nom",align:"start",key:"lastname"},{title:"Email",align:"start",key:"email"},{title:"Téléphone",align:"start",key:"phone"},{title:"Date de creation",align:"start",key:"created_at"},{title:"Status",align:"start",key:"is_customer"},{title:"Actions",key:"actions",sortable:!1}]),x=b(()=>s.value.date&&s.value.date.length>0?d.format(s.value.date[0],"shortDate")+" - "+d.format(s.value.date[s.value.date.length-1],"shortDate"):null);b(()=>C.customers.data.filter(l=>l.email.toLowerCase().includes(D.value.toLowerCase())));function q(){C.deleteItem(U.value.id);const l=c.value.findIndex(e=>e.id==U.value.id);c.value.splice(l,1),h.value=!1,j.showSuccess(w("Utilisateur supprimé avec succès"))}b(()=>F.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const z=b(()=>s.value.date&&s.value.date.length?s.value.date.length>1?[d.format(s.value.date[0],"shortDate"),d.format(s.value.date[s.value.date.length-1],"shortDate")]:[d.format(s.value.date[0],"shortDate"),d.format(s.value.date[0],"shortDate")]:null);function T(){try{clearTimeout(S.value)}catch{}S.value=setTimeout(()=>{g.value=!0;let l="id",e="desc";console.log(m.value),m.value.length>0&&(l=m.value[0].key,e=m.value[0].order),C.fetchItems({term:D.value,paginate:k.value,current_page:p.value,direction:e,order_by:l,page:v.value.page,per_page:v.value.itemsPerPage,...s.value,date:z.value}).then(a=>{if(a.data){const{data:u,current_page:G,next_page_url:H,total:A,per_page:J,to:ke,last_page:W}=a.data;c.value=u,y.value=W,P.value=A}}).catch(a=>{console.error(a)}).then(()=>{g.value=!1})},1e3)}function Q(){L.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(l=>{if(l.data){const{data:e,current_page:a,next_page_url:u,total:G,per_page:H,to:A,last_page:J}=l.data;O.value=e}}).catch(l=>{console.error(l)}).then(()=>{g.value=!1})}return oe([D,v,s],()=>{T()},{deep:!0}),se(()=>{p.value>y.value&&(p.value=y.value)}),(l,e)=>(ne(),ue(pe,null,[r(Z,{title:N.value.title,breadcrumbs:M.value},null,8,["title","breadcrumbs"]),r(E,null,{default:o(()=>[r($,{cols:"12"},{default:o(()=>[r(ve,{class:"border rounded-md",headers:K.value,loading:g.value,items:c.value,"multi-sort":!1,"items-per-page":k.value,"onUpdate:itemsPerPage":e[9]||(e[9]=a=>k.value=a),"items-per-page-text":l.$t("Articles par page"),options:v.value,"onUpdate:options":e[10]||(e[10]=a=>v.value=a),"sort-by":m.value,"onUpdate:sortBy":e[11]||(e[11]=a=>m.value=a),page:p.value,"onUpdate:page":e[12]||(e[12]=a=>p.value=a),"items-length":P.value,"onUpdate:itemsLength":e[13]||(e[13]=a=>P.value=a),"show-select":!1,"loading-text":l.$t("Chargement des éléments"),"no-data-text":l.$t("Pas de données"),"no-results-text":l.$t("Aucun résultat"),onPageCount:e[14]||(e[14]=a=>y.value=a)},{top:o(()=>[r(fe,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:o(()=>[r(E,null,{default:o(()=>[r($,null,{default:o(()=>[r(I,{density:"compact",modelValue:s.value.search,"onUpdate:modelValue":e[0]||(e[0]=a=>s.value.search=a),placeholder:l.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),r($,null,{default:o(()=>[r(B,{ref_key:"dialog",ref:R,modelValue:V.value,"onUpdate:modelValue":e[5]||(e[5]=a=>V.value=a),"return-value":s.value.date,"onUpdate:returnValue":e[6]||(e[6]=a=>s.value.date=a),persistent:"",width:"290px"},{activator:o(({props:a})=>[r(I,ie({modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=u=>x.value=u),"prepend-inner-icon":"bx-calendar",readonly:""},a,{density:"compact",placeholder:l.$t("Date"),"hide-details":"",variant:"solo"}),null,16,["modelValue","placeholder"])]),default:o(({isActive:a})=>[r(ce,{locale:"fr"},{default:o(()=>[r(ge,{modelValue:s.value.date,"onUpdate:modelValue":e[4]||(e[4]=u=>s.value.date=u),"hide-header":"",multiple:"range"},{actions:o(()=>[r(f,{color:"primary",onClick:e[2]||(e[2]=u=>V.value=!1)},{default:o(()=>[i(n(l.$t("Annuler")),1)]),_:1}),r(_),r(f,{variant:"elevated",color:"primary",onClick:e[3]||(e[3]=u=>V.value=!1)},{default:o(()=>[i(n(l.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),r(B,{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=a=>h.value=a),"max-width":"500px"},{default:o(()=>[r(Ve,null,{default:o(()=>[r(ye,{class:"text-h5 text-center py-6"},{default:o(()=>[i(n(l.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),r(he,null,{default:o(()=>[r(_),r(f,{color:"error",variant:"flat",dark:"",onClick:e[7]||(e[7]=a=>h.value=!1)},{default:o(()=>[i(n(l.$t("Annuler")),1)]),_:1}),r(f,{color:"success",variant:"flat",dark:"",onClick:q},{default:o(()=>[i(n(l.$t("OK")),1)]),_:1}),r(_)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.created_at":o(({item:a})=>[i(n(de(ee)(a.created_at)),1)]),"item.is_customer":o(({item:a})=>[r(be,{color:a.is_customer==1?"success":"warning",size:"small",label:""},{default:o(()=>[i(n(a.is_customer==1?l.$t("Client"):l.$t("Prospet")),1)]),_:2},1032,["color"])]),"item.actions":o(({item:a})=>[r(f,{density:"compact",color:"primary",variant:"outlined",to:"/customers/"+a.id},{default:o(()=>[i(n(l.$t("Voir")),1)]),_:2},1032,["to"])]),"no-data":o(()=>[me("span",null,n(l.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{ot as default};
