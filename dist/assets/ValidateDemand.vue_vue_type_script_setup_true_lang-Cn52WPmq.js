import{a6 as U,av as A,e as g,r as u,aM as y,h as M,Z as j,o as v,_ as V,w as t,V as p,n as z,d,t as i,a4 as S,b as e}from"./index-BH7n8TUf.js";import{u as E}from"./demands-C74motO9.js";import{u as H}from"./hall-1nXs4yLQ.js";import{a as O}from"./formatters-DCCWVJxZ.js";import{b as P,V as R,c as Z,a as _}from"./VCard-BZMOWXJs.js";import{f as q}from"./VMenu-BXYTJNIL.js";import{a as F,V as C}from"./VRow-CUafjboC.js";import{V as G}from"./VTextarea-CZbzAb3P.js";import{b as J}from"./VSelect-C9xrJhn_.js";import{a as b}from"./VSpacer-Czc4p638.js";import{V as K}from"./VDialog-BsZcMQ0d.js";const re=U({__name:"ValidateDemand",props:{modelValue:Object,density:{type:String,default:"default"},icon:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:h}){const w=E(),k=A(),D=H(),I=n,x=h,o=g({get:()=>I.modelValue,set:a=>x("update:modelValue",a)}),m=u(!1),r=u(!1),f=u(o.value.comment),c=u(o.value.hall_id),$=u([]),B=g(()=>`${y("Validation de la demande de ")} ${(o.value.customer||{firstname:""}).firstname} ${(o.value.customer||{lastname:""}).lastname} ${O(o.value.demand_date)||""}`);function N(){r.value=!0,w.validateItem(o.value.id,{comment:f.value,hall:c.value}).then(a=>{o.value=a.data,m.value=!1,k.showSuccess(y("Devis validé avec succès"))}).catch(a=>{r.value=!1,k.showError(a.message)}).then(()=>{r.value=!1})}return M(()=>{D.fetchItems({per_page:1e3}).then(a=>{$.value=a.data.data})}),(a,l)=>{const T=j("CheckIcon");return v(),V(K,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=s=>m.value=s),"max-width":"500px"},{activator:t(({props:s})=>[o.value.prestation?S("",!0):(v(),V(p,z({key:0,dark:""},s,{flat:"",variant:"elevated",density:n.density,color:"primary",icon:n.icon,onClick:l[0]||(l[0]=L=>r.value=!1)}),{default:t(()=>[d(i(n.icon?"":a.$t("Valider en prestation"))+" ",1),n.icon?(v(),V(T,{key:0,"stroke-width":"1.5",size:"20"})):S("",!0)]),_:2},1040,["density","icon"]))]),default:t(()=>[e(_,null,{default:t(()=>[e(P,{class:"text-h5 text-center py-6"},{default:t(()=>[d(i(a.$t("Êtes-vous sûr de vouloir Valider en prestation?")),1)]),_:1}),e(q),e(R,null,{default:t(()=>[e(F,null,{default:t(()=>[e(C,{cols:"12"},{default:t(()=>[d(i(B.value),1)]),_:1}),e(C,{cols:"12"},{default:t(()=>[e(G,{modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=s=>f.value=s),label:a.$t("Note de liée")},null,8,["modelValue","label"])]),_:1}),e(C,{cols:"12"},{default:t(()=>[e(J,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=s=>c.value=s),items:$.value,"item-value":"id","item-title":"name",label:a.$t("Salle liée")},null,8,["modelValue","items","label"])]),_:1})]),_:1})]),_:1}),e(Z,null,{default:t(()=>[e(b),e(p,{color:"error",variant:"flat",dark:"",onClick:l[3]||(l[3]=s=>m.value=!1)},{default:t(()=>[d(i(a.$t("Annuler")),1)]),_:1}),e(p,{color:"success",variant:"flat",loading:r.value,dark:"",onClick:N},{default:t(()=>[d(i(a.$t("Créer la prestation")),1)]),_:1},8,["loading"]),e(b)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{re as _};
