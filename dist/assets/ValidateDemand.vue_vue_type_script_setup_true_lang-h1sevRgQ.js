import{a6 as B,av as I,e as $,r as n,aK as g,h as U,o as k,_ as S,w as l,V as v,n as _,d as u,t as d,a4 as A,b as a}from"./index-BVT76tkN.js";import{u as j}from"./demands-BCpI2BCm.js";import{u as E}from"./hall-DtM8w-ui.js";import{f as H}from"./formatters-Dv1Ro_l4.js";import{a as K,b as M,c as O,V as P}from"./VCard-BKFM0s_d.js";import{f as R}from"./VMenu-DdtHvTp4.js";import{a as q,V as p}from"./VRow-DqmqQvj3.js";import{V as z}from"./VTextarea-DBu6cste.js";import{b as F,c as G}from"./VDialog-Ffo6rHHt.js";import{V as b}from"./VSpacer-CxuDBXtu.js";const oe=B({__name:"ValidateDemand",props:{modelValue:Object,density:{type:String,default:"default"}},emits:["update:modelValue"],setup(V,{emit:y}){const D=j(),c=I(),h=E(),w=V,N=y,s=$({get:()=>w.modelValue,set:e=>N("update:modelValue",e)}),m=n(!1),r=n(!1),i=n(""),f=n(null),C=n([]),T=$(()=>`${g("Validation de la demande de ")} ${(s.value.customer||{firstname:""}).firstname} ${(s.value.customer||{lastname:""}).lastname} ${H(s.value.demand_date)||""}`);function x(){r.value=!0,D.validateItem(s.value.id,{comment:i.value,hall:f.value}).then(e=>{s.value=e.data,m.value=!1,c.showSuccess(g("Devis validé avec succès"))}).catch(e=>{r.value=!1,c.showError(e.message)}).then(()=>{r.value=!1})}return U(()=>{h.fetchItems({per_page:1e3}).then(e=>{C.value=e.data.data})}),(e,t)=>(k(),S(G,{modelValue:m.value,"onUpdate:modelValue":t[4]||(t[4]=o=>m.value=o),"max-width":"500px"},{activator:l(({props:o})=>[s.value.prestation?A("",!0):(k(),S(v,_({key:0,dark:""},o,{variant:"elevated",density:V.density,class:e.classes,color:"primary",onClick:t[0]||(t[0]=J=>r.value=!1)}),{default:l(()=>[u(d(e.$t("Valider en prestation")),1)]),_:2},1040,["density","class"]))]),default:l(()=>[a(P,null,{default:l(()=>[a(K,{class:"text-h5 text-center py-6"},{default:l(()=>[u(d(e.$t("Êtes-vous sûr de vouloir Valider en prestation?")),1)]),_:1}),a(R),a(M,null,{default:l(()=>[a(q,null,{default:l(()=>[a(p,{cols:"12"},{default:l(()=>[u(d(T.value),1)]),_:1}),a(p,{cols:"12"},{default:l(()=>[a(z,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=o=>i.value=o),label:e.$t("Note de liée")},null,8,["modelValue","label"])]),_:1}),a(p,{cols:"12"},{default:l(()=>[a(F,{modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=o=>f.value=o),items:C.value,"item-value":"id","item-title":"name",label:e.$t("Salle liée")},null,8,["modelValue","items","label"])]),_:1})]),_:1})]),_:1}),a(O,null,{default:l(()=>[a(b),a(v,{color:"error",variant:"flat",dark:"",onClick:t[3]||(t[3]=o=>m.value=!1)},{default:l(()=>[u(d(e.$t("Annuler")),1)]),_:1}),a(v,{color:"success",variant:"flat",loading:r.value,dark:"",onClick:x},{default:l(()=>[u(d(e.$t("Créer la prestation")),1)]),_:1},8,["loading"]),a(b)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});export{oe as _};
