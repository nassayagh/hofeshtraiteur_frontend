import{u as ue}from"./eventType-DihHx9zG.js";import{_ as ie}from"./BaseBreadcrumb-D00x8Nkq.js";import{r as de}from"./validators-BPi-vT8z.js";import{a6 as me,r as s,av as ve,aD as u,h as fe,e as ce,g as pe,q as ge,Z as O,o as j,c as M,b as a,w as o,V as f,n as F,d,t as r,a as A,a8 as q,a4 as Ve,X as be}from"./index-BXvHIqz6.js";import{F as ke,V as Ce}from"./vee-validate.esm-CVIOYDwM.js";import{V as z,a as L}from"./VRow-DLf60uGt.js";import{V as ye}from"./VDataTableServer-B3Ce_yHB.js";import{V as $e,a as he}from"./VToolbar-CovYzROe.js";import{V as R}from"./VTextField-DbFfaD61.js";import{i as _,a as xe}from"./VSpacer-Dc7J-cH2.js";import{V as G}from"./VDialog-CuLVqVmd.js";import{a as K,b as X,V as Te,c as Z}from"./VCard-CFuAZNZy.js";import{V as _e}from"./VContainer-BaULvm2c.js";import{V as H}from"./VTooltip-C50umCi3.js";import"./VAvatar-CtXwuwxb.js";const we={class:"text-h5"},Ie={key:0,class:"mt-2"},Pe=["onClick"],Ze=me({__name:"List",setup(Se){const E=s(),U=ve(),J=s({title:"Gestions des événements"}),Q=s([{text:u("Tableau de bord"),disabled:!1,href:"/"},{text:u("Événements"),disabled:!0,href:"#"}]),m=s([]),w=ue();fe(()=>{N()});const c=s(!1),I=s(!1),B=s(null),P=s(100),g=s(2),$=s(2),h=s(0),D=s(!1),V=s(!1),x=s("");s(["primary","secondary","error","success","warning"]);const p=s([{key:"name",order:"asc"}]);s(0);const b=s({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"name",order:"desc"}]}),T=s(-1),n=s({id:null,name:"",description:"",status:null}),W=s({id:null,name:"",description:"",status:null});function Y(t){return t==0?"#13DEB9":t==1?"#FA896B":t==2?"#5D87FF":"#FFAE1F"}function ee(t){return t==0?u("Started"):t=="cancel"?u("Cancelled"):t=="completed"?u("Completed"):u("Started")}const k=s(!1),ae=s([{title:"Actions",key:"actions",sortable:!1},{title:"Nom",align:"start",key:"name"}]);function S(t){c.value=!1,T.value=m.value.indexOf(t),n.value=Object.assign({},t),V.value=!0}function te(t){n.value=t,k.value=!0}function le(){V.value=!1,setTimeout(()=>{n.value=Object.assign({},W.value),T.value=-1},300)}function oe(t,{setErrors:l}){var i;(i=E.value)==null||i.validate().then(({valid:C})=>{C&&(I.value=!0,w.addItem(n.value).then(e=>{if(e.data.error){l({apiError:e.data.message});return}n.value.id!=null?Object.assign(m.value[T.value],e.data):m.value.unshift(e.data),c.value=!1,V.value=!1,n.value={changePassword:!0},U.showSuccess(u("Événement sauvée avec succès"))}).catch(e=>{I.value=!1,l({apiError:e})}).then(()=>{I.value=!1,l({apiError:null})}))})}function se(){w.deleteItem(n.value.id);const t=m.value.findIndex(l=>l.id==n.value.id);m.value.splice(t,1),k.value=!1,U.showSuccess(u("Événement supprimé avec succès"))}const re=ce(()=>T.value===-1?u("Nouvel événements"):u("Modifier la événements"));function N(){try{clearTimeout(B.value)}catch{}B.value=setTimeout(()=>{c.value=!0;let t="id",l="desc";console.log(p.value),p.value.length>0&&(t=p.value[0].key,l=p.value[0].order),w.fetchItems({term:x.value,paginate:P.value,current_page:g.value,direction:l,order_by:t,page:b.value.page,per_page:b.value.itemsPerPage}).then(i=>{if(i.data){const{data:C,current_page:e,next_page_url:v,total:y,per_page:Fe,to:Ae,last_page:ne}=i.data;m.value=C,$.value=ne,h.value=y}}).catch(i=>{console.error(i)}).then(()=>{c.value=!1})},1e3)}return pe([x,b],()=>{N()},{deep:!0}),ge(()=>{g.value>$.value&&(g.value=$.value)}),(t,l)=>{const i=O("EditIcon"),C=O("TrashIcon");return j(),M(be,null,[a(ie,{title:`${J.value.title}(${h.value})`,breadcrumbs:Q.value},null,8,["title","breadcrumbs"]),a(L,null,{default:o(()=>[a(z,{cols:"12"},{default:o(()=>[a(ye,{class:"border rounded-md",headers:ae.value,loading:c.value,items:m.value,"multi-sort":!1,"items-per-page":P.value,"onUpdate:itemsPerPage":l[7]||(l[7]=e=>P.value=e),"items-per-page-text":t.$t("Articles par page"),options:b.value,"onUpdate:options":l[8]||(l[8]=e=>b.value=e),"sort-by":p.value,"onUpdate:sortBy":l[9]||(l[9]=e=>p.value=e),page:g.value,"onUpdate:page":l[10]||(l[10]=e=>g.value=e),"items-length":h.value,"onUpdate:itemsLength":l[11]||(l[11]=e=>h.value=e),"show-select":!1,"loading-text":t.$t("Chargement des éléments"),"no-data-text":t.$t("Pas de données"),"no-results-text":t.$t("Aucun résultat"),onPageCount:l[12]||(l[12]=e=>$.value=e)},{top:o(()=>[a($e,{class:"rounded-t-md",flat:""},{default:o(()=>[a(he,null,{default:o(()=>[a(R,{density:"compact",modelValue:x.value,"onUpdate:modelValue":l[0]||(l[0]=e=>x.value=e),placeholder:t.$t("Rechercher..."),"hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),a(_),a(G,{modelValue:V.value,"onUpdate:modelValue":l[4]||(l[4]=e=>V.value=e),"max-width":"350px"},{activator:o(({props:e})=>[a(f,F({color:"primary",variant:"flat",onClick:l[1]||(l[1]=v=>S={}),dark:""},e),{default:o(()=>[d(r(t.$t("Ajouter une événements")),1)]),_:2},1040)]),default:o(()=>[a(K,null,{default:o(()=>[a(X,{class:"pa-4 bg-secondary"},{default:o(()=>[A("span",we,r(re.value),1)]),_:1}),a(q(ke),{ref_key:"refForm",ref:E,modelValue:D.value,"onUpdate:modelValue":l[3]||(l[3]=e=>D.value=e),onSubmit:oe},{default:o(({errors:e,isSubmitting:v})=>[a(Te,null,{default:o(()=>[a(_e,{class:"px-0"},{default:o(()=>[a(L,null,{default:o(()=>[a(z,{cols:"12"},{default:o(()=>[a(R,{modelValue:n.value.name,"onUpdate:modelValue":l[2]||(l[2]=y=>n.value.name=y),rules:[q(de)],label:t.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1})]),_:1}),e.apiError?(j(),M("div",Ie,[a(Ce,{color:"error"},{default:o(()=>[d(r(e.apiError),1)]),_:2},1024)])):Ve("",!0)]),_:2},1024)]),_:2},1024),a(Z,null,{default:o(()=>[a(_),a(f,{color:"error",variant:"flat",dark:"",onClick:le},{default:o(()=>[d(r(t.$t("Annuler")),1)]),_:1}),a(f,{color:"success",variant:"flat",loading:c.value,type:"submit"},{default:o(()=>[d(r(t.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),a(G,{modelValue:k.value,"onUpdate:modelValue":l[6]||(l[6]=e=>k.value=e),"max-width":"500px"},{default:o(()=>[a(K,null,{default:o(()=>[a(X,{class:"text-h5 text-center py-6"},{default:o(()=>[d(r(t.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),a(Z,null,{default:o(()=>[a(_),a(f,{color:"error",variant:"flat",dark:"",onClick:l[5]||(l[5]=e=>k.value=!1)},{default:o(()=>[d(r(t.$t("Annuler")),1)]),_:1}),a(f,{color:"success",variant:"flat",dark:"",onClick:se},{default:o(()=>[d(r(t.$t("OK")),1)]),_:1}),a(_)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.status":o(({item:e})=>[a(xe,{color:Y(e.status)},{default:o(()=>[d(r(ee(e.status)),1)]),_:2},1032,["color"])]),"item.name":o(({item:e})=>[A("span",{onClick:v=>S(e),class:"cursor-pointer"},r(e.name),9,Pe)]),"item.actions":o(({item:e})=>[a(H,{text:t.$t("Modifier")},{activator:o(({props:v})=>[a(f,F({icon:"",flat:"",onClick:y=>S(e)},v),{default:o(()=>[a(i,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1032,["text"]),a(H,{text:t.$t("Supprimer")},{activator:o(({props:v})=>[a(f,F({icon:"",flat:"",onClick:y=>te(e)},v),{default:o(()=>[a(C,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),"no-data":o(()=>[A("span",null,r(t.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64)}}});export{Ze as default};
