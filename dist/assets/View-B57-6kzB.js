import{u as F}from"./customers-D-4nTmiL.js";import{a6 as G,r,av as K,aK as _,aL as X,h as H,e as b,g as J,q as O,o as i,c as v,_ as p,a4 as Q,w as a,b as s,aM as U,a as t,t as e,a8 as u,d as c,X as $,a5 as j,V as B}from"./index-P0d7CgF9.js";import{_ as W}from"./BaseBreadcrumb-_6aB5BN4.js";import{f as g,a as Y}from"./formatters-Dv1Ro_l4.js";import{u as E}from"./demands-Cz6DxfrJ.js";import{u as L}from"./Controller-Bpbg1ncx.js";import{V as d,a as y}from"./VRow-UmDyzCOl.js";import{V as m,d as V,b as h}from"./VCard-BoeFB1x3.js";import{V as x}from"./VChip-BfdYo-ie.js";import{V as w}from"./VSpacer-C1UZMLl_.js";import{V as A}from"./VTable-C0rtU6Jz.js";import"./createSimpleFunctional-c52vC5e8.js";import"./VAvatar-C6JzodsS.js";import"./index-BbuSoVwN.js";const Z={class:"text-h6"},tt={class:"text-subtitle-1 textSecondary mt-3"},et={class:"text-subtitle-1 textSecondary mt-3"},st={class:"text-subtitle-1 textSecondary mt-3"},at={class:"text-subtitle-1 textSecondary mt-3"},lt={class:"text-subtitle-1 textSecondary mt-3"},ot={class:"text-subtitle-1 textSecondary mt-3"},rt={class:"d-flex align-start"},nt={class:"text-h4 mt-1"},it={class:"mt-9"},dt={class:"text-h4 font-weight-semibold mb-1"},ut={class:"d-flex align-start"},ct={class:"text-h4 mt-1"},mt={class:"mt-9"},ht={class:"text-h4 font-weight-semibold mb-1"},ft={class:"d-flex align-start"},_t={class:"text-h4 mt-1"},vt={class:"mt-9"},pt={class:"text-h4 font-weight-semibold mb-1"},gt={class:"d-flex align-start"},bt={class:"text-h4 mt-1"},yt={class:"mt-9"},xt={class:"text-h4 font-weight-semibold mb-1"},wt={class:"text-h6"},$t={class:"text-h6"},Vt={class:"text-h6"},kt={class:"text-h6"},Pt={class:"text-h6"},Ct={class:"text-h6"},Dt={style:{"max-height":"500px"},class:"overflow-y-auto"},St={class:"text-h6 font-weight-medium text-medium-emphasis"},Tt={class:"text-h6"},It={class:"text-h6"},Nt={class:"text-h6"},jt={class:"text-h6"},Bt={class:"text-h6"},Et={class:"text-h6"},Lt={class:"text-h6 font-weight-medium text-medium-emphasis"},Yt=G({__name:"View",setup(At){r(),K();const o=r({id:null,status:0,service:"",created_at:null,customer_id:null,prestation_id:null,customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),k=r({title:_("Détails du devis")+" "+(o.value.event_type||"")+" "+(o.value.customer||{firstname:""}).firstname+" "+(o.value.customer||{lastname:""}).lastname+" "+(g(o.value.created_at)||"")}),P=r([{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Client"),disabled:!1,href:"/customers"},{text:o.value.event_type||"",disabled:!0,href:"#"}]);function M(){k.value={title:_("Détails du devis")+" "+(o.value.event_type||"")+" ("+(o.value.customer||{firstname:""}).firstname+" "+(o.value.customer||{lastname:""}).lastname+" "+(g(o.value.created_at)||"")+")"},P.value=[{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Gestion des devis"),disabled:!1,href:"/customers"},{text:o.value.event_type||"",disabled:!0,href:"#"}]}const C=F(),D=X();H(()=>{I()});const f=r(!1);r(!1),r(10);const S=r(2),T=r(2);r(!1),r(!1),r(null);const z=r("");r(["primary","secondary","error","success","warning"]),r([{key:"created_at",order:"DESC"}]),r(0),r({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"created_at",order:"DESC"}]});const R=r(-1);r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),r(!1),r([{title:"Prénom",align:"start",key:"customer.firstname",sortable:!1},{title:"Nom",align:"start",key:"customer.lastname",sortable:!1},{title:"Email",align:"start",key:"customer.email",sortable:!1},{title:"Téléphone",align:"start",key:"customer.phone",sortable:!1},{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la customere",align:"start",key:"created_at"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),b(()=>C.customers.data.filter(l=>l.email.toLowerCase().includes(z.value.toLowerCase())));const q=b(()=>D.params.id);b(()=>o.value.customer.customers?o.value.customer.customers.filter(l=>l.id!=o.value.id):[]),b(()=>R.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function I(){f.value=!0,C.fetchItem(D.params.id).then(l=>{l.data.error||(f.value=!1,o.value=l.data,M())}).catch(l=>{f.value=!1}).then(()=>{f.value=!1})}return J(q,(l,N)=>{l!=N&&I()},{deep:!0}),O(()=>{S.value>T.value&&(S.value=T.value)}),(l,N)=>(i(),v($,null,[f.value?Q("",!0):(i(),p(W,{key:0,title:k.value.title,breadcrumbs:P.value},null,8,["title","breadcrumbs"])),f.value?(i(),p(y,{key:1,justify:"center",align:"center","align-content":"center"},{default:a(()=>[s(d,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:a(()=>[s(U,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(i(),p(y,{key:2},{default:a(()=>[s(d,{cols:"12"},{default:a(()=>[s(y,{align:"center"},{default:a(()=>[s(d,{cols:"12",md:"4"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-hidden h-100"},{default:a(()=>[s(V,{class:"py-4 px-6 text-white bg-primary"},{default:a(()=>[t("h4",Z,e(l.$t("Identification du customereur")),1)]),_:1}),s(h,{class:"pa-6"},{default:a(()=>[t("p",tt,e(l.$t("Prénom :"))+" "+e(o.value.firstname||""),1),t("p",et,e(l.$t("Nom :"))+" "+e(o.value.lastname||""),1),t("p",st,e(l.$t("Email :"))+" "+e(o.value.email||""),1),t("p",at,e(l.$t("Téléphone :"))+" "+e(o.value.phone||""),1),t("p",lt,e(l.$t("Date d'enregistrement :"))+" "+e(u(g)(o.value.created_at)||""),1),t("p",ot,[c(e(l.$t("Type :"))+" ",1),o.value&&o.value.is_customer?(i(),p(x,{key:0,color:"success"},{default:a(()=>[c(e(l.$t("Client")),1)]),_:1})):(i(),p(x,{key:1,color:"error"},{default:a(()=>[c(e(l.$t("Prospect")),1)]),_:1}))])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"8"},{default:a(()=>[s(y,null,{default:a(()=>[s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-primary h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",rt,[t("h2",nt,e(l.$t("Devis")),1),s(w)]),t("div",it,[t("h2",dt,e(o.value.demands?o.value.demands.length:0),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-info h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",ut,[t("h2",ct,e(l.$t("Prestations")),1),s(w)]),t("div",mt,[t("h2",ht,e(o.value.prestations?o.value.prestations.length:0),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-primary h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",ft,[t("h2",_t,e(l.$t("Paiements")),1),s(w)]),t("div",vt,[t("h2",pt,e(u(Y)(o.value.payments_sum_amount||0)),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-success h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",gt,[t("h2",bt,e(l.$t("Prestations Clôturées")),1),s(w)]),t("div",yt,[t("h2",xt,e(o.value.prestations_count||0),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",lg:"6"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-hidden h-100"},{default:a(()=>[s(V,{class:"py-4 px-6 text-white bg-info"},{default:a(()=>[t("h4",wt,e(l.$t("Les devis de"))+" "+e(o.value.firstname||"")+" "+e(o.value.lastname||""),1)]),_:1}),s(h,{class:"pa-6"},{default:a(()=>[s(A,{class:"month-table"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",$t,e(l.$t("ID")),1),t("th",Vt,e(l.$t("Prestation")),1),t("th",kt,e(l.$t("Date")),1),t("th",Pt,e(l.$t("Status")),1),t("th",Ct,e(l.$t("Action")),1)])]),t("tbody",Dt,[(i(!0),v($,null,j(o.value.demands||[],n=>(i(),v("tr",{key:n.id,class:"month-item"},[t("td",null,e(n.id),1),t("td",null,[t("h6",St,e(n.event_type),1)]),t("td",null,e(u(g)(n.demand_date)),1),t("td",null,[s(x,{rounded:"md",class:"font-weight-bold",color:u(E)().statusColor(n.status),size:"small",label:""},{default:a(()=>[c(e(u(E)().statusText(n.status)),1)]),_:2},1032,["color"])]),t("td",null,[s(B,{variant:"outlined",density:"compact",color:"info",to:"/demands/"+n.id},{default:a(()=>[c(e(l.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",lg:"6"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-hidden h-100"},{default:a(()=>[s(V,{class:"py-4 px-6 text-white bg-info"},{default:a(()=>[t("h4",Tt,e(l.$t("Prestations de devis de"))+" "+e(o.value.firstname||"")+" "+e(o.value.lastname||""),1)]),_:1}),s(h,{class:"pa-6"},{default:a(()=>[s(A,{class:"month-table"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",It,e(l.$t("ID")),1),t("th",Nt,e(l.$t("Prestation")),1),t("th",jt,e(l.$t("Date")),1),t("th",Bt,e(l.$t("Status")),1),t("th",Et,e(l.$t("Action")),1)])]),t("tbody",null,[(i(!0),v($,null,j(o.value.prestations||[],n=>(i(),v("tr",{key:n.id,class:"month-item"},[t("td",null,e(n.id),1),t("td",null,[t("h6",Lt,e(n.demand?n.demand.event_type:""),1)]),t("td",null,e(u(g)(n.demand_date)),1),t("td",null,[s(x,{rounded:"md",class:"font-weight-bold",color:u(L)().statusColor(n.status),size:"small",label:""},{default:a(()=>[c(e(u(L)().statusText(n.status)),1)]),_:2},1032,["color"])]),t("td",null,[s(B,{variant:"outlined",density:"compact",color:"info",to:"/prestations/"+n.id},{default:a(()=>[c(e(l.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))],64))}});export{Yt as default};
