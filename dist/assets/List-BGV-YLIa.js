import{u as ge}from"./payments-Dp6y17Un.js";import{u as _e}from"./eventType-BeaE8zRB.js";import{u as ye}from"./paymentMethod-BW975cpP.js";import{_ as we}from"./BaseBreadcrumb-DPJCXDT3.js";import{f as R,a as be}from"./formatters-ChhyeSK0.js";import{a6 as ne,Z as q,o as m,_ as x,w as t,b as e,a as s,t as r,V as h,a8 as v,c as w,a4 as p,aJ as Ve,r as l,av as Pe,aK as _,aL as ke,h as xe,e as N,g as $e,q as Ce,n as H,d as $,X as De}from"./index-CmHXyYx9.js";import{u as Se}from"./Controller-B1FRK4u8.js";import{V as g,a as K}from"./VRow-DguH7A3U.js";import{V as P,a as b,b as Te,c as Ie}from"./VCard-CT1ap8kE.js";import{a as y}from"./VSpacer-BdbqMcpc.js";import{V as Be}from"./VDataTableServer-D9AfTYTv.js";import{V as Me}from"./VToolbar-BV8SpjJx.js";import{V as ae}from"./VTextField-DW2t7TcW.js";import{b as se}from"./VSelect-KNoAAS8L.js";import{V as le}from"./VDialog-U6db8KCa.js";import{V as Ue}from"./VLocaleProvider-CoeuH1Dh.js";import{V as Ee}from"./VDatePicker-DgEs07z_.js";import{V as oe}from"./VTooltip-C7NxLLFY.js";import"./VAvatar-2B62Bmjy.js";import"./filter-CxFxo8pj.js";import"./VMenu-CnH1YEJZ.js";import"./VSheet-jg7HPqls.js";const Ae={class:"d-flex align-start"},Le={class:"text-h4"},je={class:"ml-auto"},Ne={class:"mt-2"},Re={class:"text-h4 font-weight-regular"},qe={key:0,class:"text-subtitle-1"},Ke={class:"d-flex align-start"},Oe={class:"text-h4"},ze={class:"ml-auto"},Fe={class:"mt-2"},Ge={class:"text-h4 font-weight-regular"},He={key:0,class:"text-subtitle-1"},Je={class:"d-flex align-start"},Xe={class:"text-h4"},Ze={class:"ml-auto"},Qe={class:"mt-2"},We={class:"text-h4 font-weight-regular"},Ye={key:0,class:"text-subtitle-1"},et={class:"d-flex align-start"},tt={class:"text-h4"},at={class:"ml-auto"},st={class:"mt-2"},lt={class:"text-h4 font-weight-regular"},ot={key:0,class:"text-subtitle-1"},nt={class:"d-flex align-start"},rt={class:"text-h4"},it={class:"ml-auto"},dt={class:"mt-2"},ut={class:"text-h4 font-weight-regular"},ct={key:0,class:"text-subtitle-1"},mt={class:"d-flex align-start"},ht={class:"text-h4"},ft={class:"ml-auto"},pt={class:"mt-2"},vt={class:"text-h4 font-weight-regular"},gt={key:0,class:"text-subtitle-1"},_t={class:"d-flex align-start"},yt={class:"text-h4"},wt={class:"ml-auto"},bt={class:"mt-2"},Vt={class:"text-h4 font-weight-regular"},Pt={key:0,class:"text-subtitle-1"},kt={class:"d-flex align-start"},xt={class:"text-h4"},$t={class:"ml-auto"},Ct={class:"mt-2"},Dt={class:"text-h4 font-weight-regular"},St={key:0,class:"text-subtitle-1"},Tt=ne({__name:"PrespationDashboard",props:{showDescription:{type:Boolean,default:!1},showPayments:{type:Boolean,default:!1},showValidation:{type:Boolean,default:!1},showValidated:{type:Boolean,default:!1},showProcessing:{type:Boolean,default:!1},showClosed:{type:Boolean,default:!1},showCancelled:{type:Boolean,default:!1},showTotalPayments:{type:Boolean,default:!1},md:{type:String,default:"3"}},setup(d){const c=Se();return c.fetchStatistics({}),(u,J)=>{const D=q("CurrencyEuroIcon"),k=q("HotelServiceIcon");return d.showPayments?(m(),x(K,{key:0},{default:t(()=>[d.showTotalPayments?(m(),x(g,{key:0,class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Ae,[s("h2",Le,r(u.$t("Montant total")),1),e(y),s("div",je,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-info"})]),_:1})])]),s("div",Ne,[s("h2",Re,r(v(R)(v(c).statistics.totalPayments||0)),1),d.showDescription?(m(),w("span",qe,r(u.$t("Montant total de service")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),e(g,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Ke,[s("h2",Oe,r(u.$t("Montant à régler")),1),e(y),s("div",ze,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-primary"})]),_:1})])]),s("div",Fe,[s("h2",Ge,r(v(R)(v(c).statistics.paymentsLeft||0)),1),d.showDescription?(m(),w("span",He,r(u.$t("Montant restant à régler")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),e(g,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Je,[s("h2",Xe,r(u.$t("Montant réglé")),1),e(y),s("div",Ze,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-success"})]),_:1})])]),s("div",Qe,[s("h2",We,r(v(R)(v(c).statistics.paymentsReceived||0)),1),d.showDescription?(m(),w("span",Ye,r(u.$t("Montant total déjà réglé")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})):(m(),x(K,{key:1},{default:t(()=>[e(g,{class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",et,[s("h2",tt,r(u.$t("Prestations")),1),e(y),s("div",at,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-primary"})]),_:1})])]),s("div",st,[s("h2",lt,r(v(c).statistics.total||0),1),d.showDescription?(m(),w("span",ot,r(u.$t("Prestations total")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),d.showValidation?(m(),x(g,{key:0,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",nt,[s("h2",rt,r(u.$t("Prestations validées")),1),e(y),s("div",it,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-success"})]),_:1})])]),s("div",dt,[s("h2",ut,r(v(c).statistics.validated||0),1),d.showDescription?(m(),w("span",ct,r(u.$t("Prestations total validées")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),d.showValidated?(m(),x(g,{key:1,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",mt,[s("h2",ht,r(u.$t("Prestations en validation")),1),e(y),s("div",ft,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",pt,[s("h2",vt,r(v(c).statistics.validation||0),1),d.showDescription?(m(),w("span",gt,r(u.$t("Prestations total en attende de validation")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),d.showClosed?(m(),x(g,{key:2,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",_t,[s("h2",yt,r(u.$t("Prestations Clôturée")),1),e(y),s("div",wt,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",bt,[s("h2",Vt,r(v(c).statistics.closed||0),1),d.showDescription?(m(),w("span",Pt,r(u.$t("Prestations total Clôturée")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),d.showCancelled?(m(),x(g,{key:3,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-error h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",kt,[s("h2",xt,r(u.$t("Prestations annulées")),1),e(y),s("div",$t,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-error"})]),_:1})])]),s("div",Ct,[s("h2",Dt,r(v(c).statistics.cancelled||0),1),d.showDescription?(m(),w("span",St,r(u.$t("Prestations total annulées")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0)]),_:1}))}}}),It={class:"d-flex align-center"},ta=ne({__name:"List",setup(d){const c=Ve();l();const u=Pe(),J=_e(),D=ye(),k=l({title:"Gestion des paiements"}),re=l([{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Gestion des paiements"),disabled:!0,href:"#"}]),U=l([]),X=l([]),Z=l([]),O=ge(),Q=ke();xe(()=>{Q.query.method&&(i.value.payment_method=[Q.query.method]),ee(),fe(),pe()});const S=l(!1);l(!1),l(!1),l(!1),l(!1),l(""),l(),l(!1);const W=l(null);l(null),l(null),l(null);const E=l(!1);l();const z=l(100),T=l(2),A=l(2),L=l(0);l(!1);const ie=l(!1);l(null);const F=l("");l(["primary","secondary","error","success","warning"]);const C=l([{key:"payment_date",order:"DESC"}]);l(0);const i=l({search:null,status:null,date:null,event_type:null}),I=l({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"payment_date",order:"DESC"}]}),de=l(-1),G=l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const B=l(!1),ue=l([{title:_("Prénom"),align:"start",key:"prestation.customer.firstname",sortable:!1},{title:_("Nom"),align:"start",key:"prestation.customer.lastname",sortable:!1},{title:_("Email"),align:"start",key:"prestation.customer.email",sortable:!1},{title:_("Téléphone"),align:"start",key:"prestation.customer.phone",sortable:!1},{title:_("Prestation"),align:"start",key:"prestation.event_type"},{title:_("Mode de paiement"),align:"start",key:"payment_method"},{title:_("Montant payé"),align:"start",key:"amount"},{title:_("Date du paiement"),align:"start",key:"payment_date"},{title:"Actions",key:"actions",sortable:!1}]),Y=N(()=>i.value.date&&i.value.date.length>0?c.format(i.value.date[0],"shortDate")+" - "+c.format(i.value.date[i.value.date.length-1],"shortDate"):null);N(()=>O.payments.data.filter(n=>n.email.toLowerCase().includes(F.value.toLowerCase())));function ce(n){G.value=n,B.value=!0}function me(){O.deleteItem(G.value.id);const n=U.value.findIndex(a=>a.id==G.value.id);U.value.splice(n,1),B.value=!1,u.showSuccess(_("Utilisateur supprimé avec succès"))}N(()=>de.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const he=N(()=>i.value.date&&i.value.date.length?i.value.date.length>1?[c.format(i.value.date[0],"shortDate"),c.format(i.value.date[i.value.date.length-1],"shortDate")]:[c.format(i.value.date[0],"shortDate"),c.format(i.value.date[0],"shortDate")]:null);function ee(){try{clearTimeout(W.value)}catch{}W.value=setTimeout(()=>{S.value=!0;let n="id",a="desc";console.log(C.value),C.value.length>0&&(n=C.value[0].key,a=C.value[0].order),O.fetchItems({term:F.value,paginate:z.value,current_page:T.value,direction:a,order_by:n,page:I.value.page,per_page:I.value.itemsPerPage,...i.value,date:he.value}).then(V=>{if(V.data){const{data:M,current_page:o,next_page_url:f,total:j,per_page:te,to:Bt,last_page:ve}=V.data;U.value=M,A.value=ve,L.value=j}}).catch(V=>{console.error(V)}).then(()=>{S.value=!1})},1e3)}function fe(){J.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:M,total:o,per_page:f,to:j,last_page:te}=n.data;X.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}function pe(){D.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:M,total:o,per_page:f,to:j,last_page:te}=n.data;Z.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}return $e([F,I,i],()=>{ee()},{deep:!0}),Ce(()=>{T.value>A.value&&(T.value=A.value)}),(n,a)=>{const V=q("EyeIcon"),M=q("TrashIcon");return m(),w(De,null,[e(we,{title:`${k.value.title}(${L.value})`,breadcrumbs:re.value},null,8,["title","breadcrumbs"]),e(Tt,{"show-payments":"","show-description":"","show-total-payments":""}),e(K,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(Be,{class:"border rounded-md",headers:ue.value,loading:S.value,items:U.value,"multi-sort":!1,"items-per-page":z.value,"onUpdate:itemsPerPage":a[12]||(a[12]=o=>z.value=o),"items-per-page-text":n.$t("Articles par page"),options:I.value,"onUpdate:options":a[13]||(a[13]=o=>I.value=o),"sort-by":C.value,"onUpdate:sortBy":a[14]||(a[14]=o=>C.value=o),page:T.value,"onUpdate:page":a[15]||(a[15]=o=>T.value=o),"items-length":L.value,"onUpdate:itemsLength":a[16]||(a[16]=o=>L.value=o),"show-select":!1,"loading-text":n.$t("Chargement des éléments"),"no-data-text":n.$t("Pas de données"),"no-results-text":n.$t("Aucun résultat"),onPageCount:a[17]||(a[17]=o=>A.value=o)},{top:t(()=>[e(Me,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:t(()=>[e(K,null,{default:t(()=>[e(g,null,{default:t(()=>[e(ae,{density:"compact",modelValue:i.value.search,"onUpdate:modelValue":a[0]||(a[0]=o=>i.value.search=o),placeholder:n.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),e(g,null,{default:t(()=>[e(se,{density:"compact",modelValue:i.value.event_type,"onUpdate:modelValue":a[1]||(a[1]=o=>i.value.event_type=o),placeholder:n.$t("Prestation"),items:X.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(g,null,{default:t(()=>[e(se,{density:"compact",modelValue:i.value.payment_method,"onUpdate:modelValue":a[2]||(a[2]=o=>i.value.payment_method=o),placeholder:n.$t("Mode de paiement"),items:Z.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(g,null,{default:t(()=>[e(le,{ref_key:"dialog",ref:ie,modelValue:E.value,"onUpdate:modelValue":a[8]||(a[8]=o=>E.value=o),"return-value":i.value.date,"onUpdate:returnValue":a[9]||(a[9]=o=>i.value.date=o),persistent:"",width:"290px"},{activator:t(({props:o})=>[e(ae,H({modelValue:Y.value,"onUpdate:modelValue":a[3]||(a[3]=f=>Y.value=f),"prepend-inner-icon":"bx-calendar",readonly:""},o,{density:"compact",placeholder:n.$t("Date"),"hide-details":"",variant:"solo",clearable:"","onClick:clear":a[4]||(a[4]=f=>i.value.date=null)}),null,16,["modelValue","placeholder"])]),default:t(({isActive:o})=>[e(Ue,{locale:"fr"},{default:t(()=>[e(Ee,{modelValue:i.value.date,"onUpdate:modelValue":a[7]||(a[7]=f=>i.value.date=f),"hide-header":"",multiple:"range"},{actions:t(()=>[e(h,{color:"primary",onClick:a[5]||(a[5]=f=>E.value=!1)},{default:t(()=>[$(r(n.$t("Annuler")),1)]),_:1}),e(y),e(h,{variant:"elevated",color:"primary",onClick:a[6]||(a[6]=f=>E.value=!1)},{default:t(()=>[$(r(n.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),e(le,{modelValue:B.value,"onUpdate:modelValue":a[11]||(a[11]=o=>B.value=o),"max-width":"500px"},{default:t(()=>[e(b,null,{default:t(()=>[e(Te,{class:"text-h5 text-center py-6"},{default:t(()=>[$(r(n.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),e(Ie,null,{default:t(()=>[e(y),e(h,{color:"error",variant:"flat",dark:"",onClick:a[10]||(a[10]=o=>B.value=!1)},{default:t(()=>[$(r(n.$t("Annuler")),1)]),_:1}),e(h,{color:"success",variant:"flat",dark:"",onClick:me},{default:t(()=>[$(r(n.$t("OK")),1)]),_:1}),e(y)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.amount":t(({item:o})=>[$(r(v(R)(o.amount)),1)]),"item.payment_date":t(({item:o})=>[$(r(v(be)(o.payment_date)),1)]),"item.actions":t(({item:o})=>[s("div",It,[e(oe,{text:n.$t("Voir la prestation liée")},{activator:t(({props:f})=>[e(h,H({icon:"",flat:"",to:"/prestations/"+o.prestation_id},f),{default:t(()=>[e(V,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["to"])]),_:2},1032,["text"]),e(oe,{text:n.$t("Supprimer")},{activator:t(({props:f})=>[e(h,H({icon:"",flat:"",onClick:j=>ce(o)},f),{default:t(()=>[e(M,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])])]),"no-data":t(()=>[s("span",null,r(n.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64)}}});export{ta as default};
