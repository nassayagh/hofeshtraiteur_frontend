import{u as T,S as A,_ as H,E as M}from"./EditorMenubar-bP_jAkcZ.js";import{a6 as U,av as j,e as h,r as m,aD as y,h as z,Z as K,o as v,_ as p,w as l,V,n as L,d,t as n,a4 as b,b as e,a as O,a8 as C}from"./index-XeNcZacn.js";import{u as P}from"./demands-Cq5PL85-.js";import{u as R}from"./hall-CQPnp-QC.js";import{a as Z}from"./formatters-DCCWVJxZ.js";import{b as q,V as F,c as G,a as J}from"./VCard-DzjjGY7n.js";import{g as Q,i as D}from"./VSpacer-BagTU5ql.js";import{a as W,V as k}from"./VRow-DM5ckK1m.js";import{a as X}from"./BaseBreadcrumb-hrRvfHTl.js";import{V as Y}from"./VDialog-BItfYq7f.js";const me=U({__name:"ValidateDemand",props:{modelValue:Object,density:{type:String,default:"default"},comment:{type:String,default:""},icon:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(r,{emit:w}){const _=P(),g=j(),B=R(),I=r,S=w,o=h({get:()=>I.modelValue,set:a=>S("update:modelValue",a)}),u=m(!1),i=m(!1),c=T({extensions:[A],content:o.value.commentaire}),f=m(o.value.hall_id),$=m([]),x=h(()=>`${y("Validation de la demande de ")} ${(o.value.customer||{firstname:""}).firstname} ${(o.value.customer||{lastname:""}).lastname} ${Z(o.value.demand_date)||""}`);function E(){var a;i.value=!0,_.validateItem(o.value.id,{comment:(a=c.value)==null?void 0:a.getHTML(),hall:f.value}).then(t=>{o.value=t.data,u.value=!1,g.showSuccess(y("Devis validé avec succès")),S("saved",t.data)}).catch(t=>{i.value=!1,g.showError(t.message)}).then(()=>{i.value=!1})}return z(()=>{B.fetchItems({per_page:1e3}).then(a=>{$.value=a.data.data})}),(a,t)=>{const N=K("CheckIcon");return v(),p(Y,{modelValue:u.value,"onUpdate:modelValue":t[3]||(t[3]=s=>u.value=s),"max-width":"1000px"},{activator:l(({props:s})=>[o.value.prestation?b("",!0):(v(),p(V,L({key:0,dark:""},s,{flat:"",variant:"elevated",density:r.density,color:"primary",icon:r.icon,onClick:t[0]||(t[0]=ee=>i.value=!1)}),{default:l(()=>[d(n(r.icon?"":a.$t("Valider en prestation"))+" ",1),r.icon?(v(),p(N,{key:0,"stroke-width":"1.5",size:"20"})):b("",!0)]),_:2},1040,["density","icon"]))]),default:l(()=>[e(J,null,{default:l(()=>[e(q,{class:"text-h5 text-center py-6"},{default:l(()=>[d(n(a.$t("Êtes-vous sûr de vouloir Valider en prestation?")),1)]),_:1}),e(Q),e(F,null,{default:l(()=>[e(W,null,{default:l(()=>[e(k,{cols:"12"},{default:l(()=>[d(n(x.value),1)]),_:1}),e(k,{cols:"12"},{default:l(()=>[O("label",null,n(a.$t("Commentaire")),1),e(H,{editor:C(c)},null,8,["editor"]),e(C(M),{editor:C(c)},null,8,["editor"])]),_:1}),e(k,{cols:"12"},{default:l(()=>[e(X,{modelValue:f.value,"onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),items:$.value,"item-value":"id","item-title":"name",label:a.$t("Salle liée")},null,8,["modelValue","items","label"])]),_:1})]),_:1})]),_:1}),e(G,null,{default:l(()=>[e(D),e(V,{color:"error",variant:"flat",dark:"",onClick:t[2]||(t[2]=s=>u.value=!1)},{default:l(()=>[d(n(a.$t("Annuler")),1)]),_:1}),e(V,{color:"success",variant:"flat",loading:i.value,dark:"",onClick:E},{default:l(()=>[d(n(a.$t("Créer la prestation")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{me as _};
