import{a6 as E,av as O,e as C,r as f,aK as S,h as R,o as b,_ as P,w as a,b as e,d as m,t as d,n as T,V as y,Z,a4 as G,aJ as Q,bk as W,c as X}from"./index-Cbri8peo.js";import{u as F}from"./Controller-C6pfVhua.js";import{u as Y}from"./hall-nqhCOHmM.js";import{b as B,V as N,c as H,a as z}from"./VCard-CQWGNQxb.js";import{f as I}from"./VMenu-b91v3T8V.js";import{a as K,V as _}from"./VRow-DgMjTeOq.js";import{b as ee}from"./VSelect-CI7ZCyIn.js";import{a as w}from"./VSpacer-BopiE_oa.js";import{V as j}from"./VDialog-Da6d4ZZk.js";import{u as ae}from"./paymentMethod-DsTi9QN4.js";import{V as te}from"./VAutocomplete-CZVtPqNb.js";import{V as J}from"./VTextField-BaVdAKnF.js";import{V as le}from"./VLocaleProvider-PQUvCgp4.js";import{V as oe}from"./VDatePicker-ColsN0d4.js";const $e=E({__name:"ChangeHall",props:{modelValue:Object},emits:["update:modelValue"],setup(c,{emit:D}){const A=F(),k=O(),U=Y(),M=c,v=D,V=C({get:()=>M.modelValue,set:n=>v("update:modelValue",n)}),t=f(!1),p=f(!1);f("");const u=f(V.value.hall_id||null),r=f([]);C(()=>`${S("Modifier la salle")}`);function g(){p.value=!0,A.changeHall(V.value.id,u.value).then(n=>{V.value=n.data,t.value=!1,k.showSuccess(S("Salle changée avec succès")),v("refresh",n.data)}).catch(n=>{p.value=!1,k.showError(n.message)}).then(()=>{p.value=!1})}return R(()=>{U.fetchItems({per_page:1e3}).then(n=>{r.value=n.data.data})}),(n,i)=>(b(),P(j,{modelValue:t.value,"onUpdate:modelValue":i[3]||(i[3]=$=>t.value=$),"max-width":"500px"},{activator:a(({props:$})=>[e(y,T({dark:""},$,{variant:"tonal",density:"compact",onClick:i[0]||(i[0]=L=>p.value=!1)}),{default:a(()=>[m(d(n.$t("Modifier")),1)]),_:2},1040)]),default:a(()=>[e(z,null,{default:a(()=>[e(B,{class:"text-h5 text-center py-6"},{default:a(()=>[m(d(n.$t("Modifier la salle")),1)]),_:1}),e(I),e(N,null,{default:a(()=>[e(K,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(ee,{modelValue:u.value,"onUpdate:modelValue":i[1]||(i[1]=$=>u.value=$),items:r.value,"item-value":"id","item-title":"name",label:n.$t("Salle liée")},null,8,["modelValue","items","label"])]),_:1})]),_:1})]),_:1})]),_:1}),e(I),e(H,null,{default:a(()=>[e(w),e(y,{color:"error",variant:"flat",dark:"",onClick:i[2]||(i[2]=$=>t.value=!1)},{default:a(()=>[m(d(n.$t("Annuller")),1)]),_:1}),e(y,{color:"success",variant:"flat",loading:p.value,dark:"",onClick:g},{default:a(()=>[m(d(n.$t("Enregistrer")),1)]),_:1},8,["loading"]),e(w)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ce=E({__name:"ClosePrestation",props:{modelValue:Object,icon:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:D}){const A=F(),k=O(),U=c,M=D,v=C({get:()=>U.modelValue,set:u=>M("update:modelValue",u)}),V=f(!1),t=f(!1);f(""),C(()=>`${S("Terminer la prestation")}`);function p(){t.value=!0,A.closeItem(v.value.id).then(u=>{v.value=u.data,V.value=!1,k.showSuccess(S("Prestation clôturée avec succès")),M("refresh")}).catch(u=>{t.value=!1,k.showError(u.message)}).then(()=>{t.value=!1})}return(u,r)=>{const g=Z("CheckIcon");return b(),P(j,{modelValue:V.value,"onUpdate:modelValue":r[2]||(r[2]=n=>V.value=n),"max-width":"500px"},{activator:a(({props:n})=>[e(y,T({dark:""},n,{variant:"elevated",color:"primary",onClick:r[0]||(r[0]=i=>t.value=!1),icon:c.icon}),{default:a(()=>[m(d(c.icon?"":u.$t("Terminer la prestation"))+" ",1),c.icon?(b(),P(g,{key:0,"stroke-width":"1.5",size:"20"})):G("",!0)]),_:2},1040,["icon"])]),default:a(()=>[e(z,null,{default:a(()=>[e(B,{class:"text-h5 text-center py-6"},{default:a(()=>[m(d(u.$t("Terminer la prestation")),1)]),_:1}),e(I),e(N,null,{default:a(()=>[e(K,null,{default:a(()=>[e(_,{cols:"12",class:"text-center"},{default:a(()=>[m(d(u.$t("Êtes-vous sûr de vouloir terminer la prestation?")),1)]),_:1})]),_:1})]),_:1}),e(I),e(H,null,{default:a(()=>[e(w),e(y,{color:"error",variant:"flat",dark:"",onClick:r[1]||(r[1]=n=>V.value=!1)},{default:a(()=>[m(d(u.$t("Non")),1)]),_:1}),e(y,{color:"success",variant:"flat",loading:t.value,dark:"",onClick:p},{default:a(()=>[m(d(u.$t("Oui")),1)]),_:1},8,["loading"]),e(w)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),ne={key:1},he=E({__name:"PaymentForm",props:{modelValue:Object,prestation:Object,title:S("PaymentMethod"),variant:{type:String,default:"elevated"},buttonText:S("Ajouter un paymentMethod")},emits:["update:modelValue","update:item"],setup(c,{emit:D}){const A=F(),k=O(),U=ae(),M=Q(),v=c,V=D;C({get:()=>v.modelValue,set:o=>V("update:modelValue",o)});const t=f({id:null,prestation_id:null,amount:0,payment_date:new Date}),p=f(!1),u=f(!1),r=f(!1),g=f([]);R(()=>{U.fetchItems({per_page:500}).then(o=>{g.value=o.data.data,console.log(g.value)}),t.value.amount=i.value});const n=C(()=>v.prestation.services?v.prestation.services.reduce((o,l)=>(console.log(l.total,o),parseFloat(l.total)+parseFloat(o)),0):0),i=C(()=>v.prestation.payments&&v.prestation.payments.length?n.value-v.prestation.payments.reduce((o,l)=>parseFloat(l.amount)+parseFloat(o),0):n.value);function $(){r.value=!0,A.savePayment(v.prestation.id,t.value).then(o=>{p.value=!1,V("update:item",o.data),t.value={},t.value={},k.showSuccess(S("PaymentMethod enregistré avec succès"))}).catch(o=>{r.value=!1,k.showError(o.message)}).then(()=>{r.value=!1})}function L(o){if(console.log(i.value),o){const l=g.value.find(x=>x.id==o);l&&(t.value.payment_method=l.name||null,t.value.amount=i.value)}}const q=C(()=>t.value.payment_date?M.format(t.value.payment_date,"shortDate"):null);return(o,l)=>{const x=Z("EditIcon");return b(),P(j,{modelValue:p.value,"onUpdate:modelValue":l[11]||(l[11]=s=>p.value=s),"max-width":"500px"},{activator:a(({props:s})=>[i.value>0?(b(),P(y,T({key:0,dark:""},s,{icon:t.value.id!=null,flat:t.value.id!=null,variant:c.variant,color:t.value.id!=null?null:"primary",onClick:l[0]||(l[0]=h=>r.value=!1)}),{default:a(()=>[W(o.$slots,"default",{},()=>[t.value.id?(b(),P(x,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(b(),X("span",ne,d(c.buttonText),1))])]),_:2},1040,["icon","flat","variant","color"])):G("",!0)]),default:a(()=>[e(z,null,{default:a(()=>[e(B,{class:"text-h5 text-center py-6"},{default:a(()=>[m(d(c.title),1)]),_:1}),e(I),e(N,null,{default:a(()=>[e(K,null,{default:a(()=>[e(_,{cols:"12"},{default:a(()=>[e(te,{modelValue:t.value.payment_method_id,"onUpdate:modelValue":[l[1]||(l[1]=s=>t.value.payment_method_id=s),L],label:o.$t("PaymentMethod"),clearable:"",items:g.value,"item-title":"name","item-value":"id",filled:!1,variant:"outlined",required:""},null,8,["modelValue","label","items"])]),_:1}),e(_,{cols:"12",md:"6"},{default:a(()=>[e(j,{ref:"dialogDemandDate",modelValue:u.value,"onUpdate:modelValue":l[7]||(l[7]=s=>u.value=s),"return-value":t.value.payment_date,"onUpdate:returnValue":l[8]||(l[8]=s=>t.value.payment_date=s),persistent:"",width:"290px"},{activator:a(({props:s})=>[e(J,T({modelValue:q.value,"onUpdate:modelValue":l[2]||(l[2]=h=>q.value=h)},s,{placeholder:o.$t("Date de la demande"),"hide-details":"",clearable:"",readonly:"","onClick:clear":l[3]||(l[3]=h=>t.value.payment_date=null)}),null,16,["modelValue","placeholder"])]),default:a(({isActive:s})=>[e(le,{locale:"fr"},{default:a(()=>[e(oe,{modelValue:t.value.payment_date,"onUpdate:modelValue":l[6]||(l[6]=h=>t.value.payment_date=h),"hide-header":""},{actions:a(()=>[e(y,{color:"primary",onClick:l[4]||(l[4]=h=>u.value=!1)},{default:a(()=>[m(d(o.$t("Annuler")),1)]),_:1}),e(w),e(y,{variant:"elevated",color:"primary",onClick:l[5]||(l[5]=h=>u.value=!1)},{default:a(()=>[m(d(o.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1}),e(_,{cols:"12",md:"6"},{default:a(()=>[e(J,{min:0,modelValue:t.value.amount,"onUpdate:modelValue":l[9]||(l[9]=s=>t.value.amount=s),type:"number",label:o.$t("Montant")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(H,null,{default:a(()=>[e(w),e(y,{color:"error",variant:"flat",dark:"",onClick:l[10]||(l[10]=s=>p.value=!1)},{default:a(()=>[m(d(o.$t("Annuler")),1)]),_:1}),e(y,{color:"success",variant:"flat",loading:r.value,dark:"",onClick:$},{default:a(()=>[m(d(o.$t("Ajouter")),1)]),_:1},8,["loading"]),e(w)]),_:1})]),_:1})]),_:3},8,["modelValue"])}}});export{he as _,$e as a,Ce as b};
