import{u as q}from"./Controller-ChgwWRdP.js";import{a6 as B,av as R,e as U,r as n,aK as I,o as p,_ as k,w as t,b as e,d as _,t as a,n as z,V as S,a8 as $,a4 as M,a as u,c as N,h as ae,Z as G,aL as ie,g as me,aM as ce,X as J,a5 as oe}from"./index-BVT76tkN.js";import{_ as ve}from"./BaseBreadcrumb-D4W4jOVF.js";import{f as L,a as Z}from"./formatters-Dv1Ro_l4.js";import{a as Q,b as T,c as K,V as E,d as Y}from"./VCard-BKFM0s_d.js";import{f as F}from"./VMenu-DdtHvTp4.js";import{a as O,V as C}from"./VRow-DqmqQvj3.js";import{V as le}from"./VTextarea-DBu6cste.js";import{V as D}from"./VSpacer-CxuDBXtu.js";import{c as W}from"./VDialog-Ffo6rHHt.js";import{V as ee}from"./VChip-Cey96Mfc.js";import{u as fe}from"./service-CZj0sD3Q.js";import{V as re}from"./VAutocomplete-BzbtuMC5.js";import{V as te}from"./VTextField-DNAm_YFN.js";import{u as pe}from"./paymentMethod-8I_Hndvy.js";import{V as ue}from"./VTable-BnDrA0bq.js";import{V as he}from"./VTooltip-DtgaC8kd.js";import"./createSimpleFunctional-C9UvAl1a.js";import"./VAvatar-QwZ81rXr.js";import"./index-DvK9tNy3.js";import"./filter-Dzf0L7R9.js";const _e=B({__name:"CancelPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const m=q(),x=R(),A=P,h=l,i=U({get:()=>A.modelValue,set:o=>h("update:modelValue",o)}),s=n(!1),v=n(!1),y=n("");U(()=>`${I("Annuler la prestation")}`);function f(){v.value=!0,m.cancelItem(i.value.id,y.value).then(o=>{i.value=o.data,s.value=!1,x.showSuccess(I("Prestation annulée avec succès"))}).catch(o=>{v.value=!1,x.showError(o.message)}).then(()=>{v.value=!1})}return(o,c)=>(p(),k(W,{modelValue:s.value,"onUpdate:modelValue":c[3]||(c[3]=d=>s.value=d),"max-width":"500px"},{activator:t(({props:d})=>[e(S,z({class:"ml-2",dark:""},d,{variant:"outlined",color:"primary",onClick:c[0]||(c[0]=w=>v.value=!1)}),{default:t(()=>[_(a(o.$t("Annuler la prestation")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(o.$t("Annuler la prestation")),1)]),_:1}),e(F),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(C,{cols:"12",class:"text-center"},{default:t(()=>[_(a(o.$t("Êtes-vous sûr de vouloir Annuler la prestation?")),1)]),_:1}),e(C,{cols:"12"},{default:t(()=>[e(le,{modelValue:y.value,"onUpdate:modelValue":c[1]||(c[1]=d=>y.value=d),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(F),e(K,null,{default:t(()=>[e(D),e(S,{color:"error",variant:"flat",dark:"",onClick:c[2]||(c[2]=d=>s.value=!1)},{default:t(()=>[_(a(o.$t("Non")),1)]),_:1}),e(S,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:f},{default:t(()=>[_(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ve=B({__name:"ValidatePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const m=q(),x=R(),A=P,h=l,i=U({get:()=>A.modelValue,set:o=>h("update:modelValue",o)}),s=n(!1),v=n(!1),y=n("");U(()=>`${I("Valider la prestation")}`);function f(){v.value=!0,m.validateItem(i.value.id,y.value).then(o=>{i.value=o.data,s.value=!1,x.showSuccess(I("Prestation validée avec succès"))}).catch(o=>{v.value=!1,x.showError(o.message)}).then(()=>{v.value=!1})}return(o,c)=>(p(),k(W,{modelValue:s.value,"onUpdate:modelValue":c[3]||(c[3]=d=>s.value=d),"max-width":"500px"},{activator:t(({props:d})=>[e(S,z({dark:""},d,{variant:"elevated",color:"primary",onClick:c[0]||(c[0]=w=>v.value=!1)}),{default:t(()=>[_(a(i.value.status==$(m).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(i.value.status==$(m).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:1}),e(F),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(C,{cols:"12",class:"text-center"},{default:t(()=>[_(a(i.value.status==$(m).statuses.cancelled?o.$t("Êtes-vous sûr de vouloir Rouvrir la prestation"):o.$t("Êtes-vous sûr de vouloir Valider la prestation?")),1)]),_:1}),i.value.status==$(m).statuses.cancelled?(p(),k(C,{key:0,cols:"12"},{default:t(()=>[e(le,{modelValue:y.value,"onUpdate:modelValue":c[1]||(c[1]=d=>y.value=d),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})):M("",!0)]),_:1})]),_:1}),e(F),e(K,null,{default:t(()=>[e(D),e(S,{color:"error",variant:"flat",dark:"",onClick:c[2]||(c[2]=d=>s.value=!1)},{default:t(()=>[_(a(o.$t("Non")),1)]),_:1}),e(S,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:f},{default:t(()=>[_(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),$e={class:"text-h6"},ge={class:"text-subtitle-1 textSecondary mt-3"},ye={class:"text-subtitle-1 textSecondary mt-3"},be={class:"text-subtitle-1 textSecondary mt-3"},ke={class:"text-subtitle-1 textSecondary mt-3"},Ce={class:"text-subtitle-1 textSecondary mt-3"},we={class:"text-subtitle-1 textSecondary mt-3"},Se={class:"text-subtitle-1 textSecondary mt-3"},xe={class:"text-subtitle-1 textSecondary mt-3"},je={key:0,class:"text-subtitle-1 textSecondary mt-3"},Pe={key:1,class:"text-subtitle-1 textSecondary mt-3"},Ae=B({__name:"CustomerWidget",props:{modelValue:Object,showDemandInfo:Boolean},emits:["update:modelValue"],setup(P,{emit:l}){const m=q(),x=P,A=l,h=U({get:()=>x.modelValue,set:i=>A("update:modelValue",i)});return(i,s)=>(p(),k(E,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(Y,{class:"py-4 px-6 text-white bg-primary"},{default:t(()=>[u("h4",$e,a(i.$t("Identification du demandeur")),1)]),_:1}),e(T,{class:"pl-6 pr-6"},{default:t(()=>[u("p",ge,a(i.$t("Prénom :"))+" "+a(h.value.customer.firstname||""),1),u("p",ye,a(i.$t("Nom :"))+" "+a(h.value.customer.lastname||""),1),u("p",be,a(i.$t("Email :"))+" "+a(h.value.customer.email||""),1),u("p",ke,a(i.$t("Téléphone :"))+" "+a(h.value.customer.phone||""),1),u("p",Ce,a(i.$t("Date d'enregistrement :"))+" "+a($(L)(h.value.customer.created_at)||""),1),u("p",we,[_(a(i.$t("Type :"))+" ",1),h.value.customer&&h.value.customer.is_customer?(p(),k(ee,{key:0,color:"success"},{default:t(()=>[_(a(i.$t("Client")),1)]),_:1})):(p(),k(ee,{key:1,color:"error"},{default:t(()=>[_(a(i.$t("Prospect")),1)]),_:1}))])]),_:1}),P.showDemandInfo?(p(),k(T,{key:0,class:"pt-0 pb-0"},{default:t(()=>[e(F)]),_:1})):M("",!0),P.showDemandInfo?(p(),k(T,{key:1,class:"pl-6 pr-6"},{default:t(()=>[u("p",Se,a(i.$t("Date de la demande :"))+" "+a($(L)(h.value.demand_date)||""),1),u("p",xe,a(i.$t("Date création de la prestation :"))+" "+a($(L)(h.value.created_at)||""),1),h.value.status>=$(m).statuses.processing?(p(),N("p",je,a(i.$t("Date lancement de la prestation :"))+" "+a($(L)(h.value.start_date)||""),1)):M("",!0),h.value.status>=$(m).statuses.closed?(p(),N("p",Pe,a(i.$t("Date clôture de la prestation :"))+" "+a($(L)(h.value.closed_date)||""),1)):M("",!0)]),_:1})):M("",!0)]),_:1}))}}),Ue={key:1},ne=B({__name:"ServiceForm",props:{modelValue:Object,prestation:Object,title:I("Service"),buttonText:I("Ajouter un service")},emits:["update:modelValue","update:item"],setup(P,{emit:l}){const m=q(),x=R(),A=fe(),h=P,i=l,s=U({get:()=>h.modelValue,set:d=>i("update:modelValue",d)}),v=n(!1),y=n(!1),f=n([]);ae(()=>{A.fetchItems({per_page:500}).then(d=>{f.value=d.data.data,console.log(f.value)})});function o(){y.value=!0,m.saveService(h.prestation.id,s.value).then(d=>{v.value=!1,i("update:item",d.data),s.value={},s.value={},x.showSuccess(I("Service enregistré avec succès"))}).catch(d=>{y.value=!1,x.showError(d.message)}).then(()=>{y.value=!1})}function c(d){if(d){const w=f.value.find(b=>b.name==d);w&&(s.value.quantity=s.value.quantity||1,s.value.service_id=w.id||null,s.value.price=w.price||0,s.value.total=(s.value.quantity||1)*(w.price||0))}}return(d,w)=>{const b=G("EditIcon");return p(),k(W,{modelValue:v.value,"onUpdate:modelValue":w[5]||(w[5]=V=>v.value=V),"max-width":"500px"},{activator:t(({props:V})=>[e(S,z({dark:""},V,{icon:s.value.id!=null,flat:s.value.id!=null,variant:"elevated",color:s.value.id!=null?null:"primary",onClick:w[0]||(w[0]=r=>y.value=!1)}),{default:t(()=>[s.value.id?(p(),k(b,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(p(),N("span",Ue,a(P.buttonText),1))]),_:2},1040,["icon","flat","color"])]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(P.title),1)]),_:1}),e(F),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(C,{cols:"12"},{default:t(()=>[e(re,{modelValue:s.value.name,"onUpdate:modelValue":[w[1]||(w[1]=V=>s.value.name=V),c],label:d.$t("Service"),clearable:"",items:f.value,"item-title":"name","item-value":"name",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(C,{cols:"12",md:"6"},{default:t(()=>[e(te,{min:1,modelValue:s.value.quantity,"onUpdate:modelValue":w[2]||(w[2]=V=>s.value.quantity=V),type:"number",label:d.$t("Quantité")},null,8,["modelValue","label"])]),_:1}),e(C,{cols:"12",md:"6"},{default:t(()=>[e(te,{min:0,modelValue:s.value.price,"onUpdate:modelValue":w[3]||(w[3]=V=>s.value.price=V),type:"number",label:d.$t("Prix")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(D),e(S,{color:"error",variant:"flat",dark:"",onClick:w[4]||(w[4]=V=>v.value=!1)},{default:t(()=>[_(a(d.$t("Annuler")),1)]),_:1}),e(S,{color:"success",variant:"flat",loading:y.value,dark:"",onClick:o},{default:t(()=>[_(a(d.$t("Ajouter")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Ie=B({__name:"DeleteService",props:{modelValue:Object,service:Object},emits:["update:modelValue"],setup(P,{emit:l}){const m=q(),x=R(),A=P,h=l,i=U({get:()=>A.modelValue,set:f=>h("update:modelValue",f)}),s=n(!1),v=n(!1);function y(){v.value=!0,m.deleteService(i.value.id,A.service.id).then(f=>{i.value=f.data,s.value=!1,x.showSuccess(I("Service supprimé avec succès"))}).then(()=>{s.value=!1,v.value=!1})}return(f,o)=>{const c=G("TrashIcon");return p(),k(W,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=d=>s.value=d),"max-width":"350px"},{activator:t(({props:d})=>[e(S,z({icon:"",flat:"",class:"ml-3",dark:""},d,{onClick:o[0]||(o[0]=w=>v.value=!1)}),{default:t(()=>[e(c,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(f.$t("Êtes-vous sûr de vouloir supprimer le service?")),1)]),_:1}),e(K,null,{default:t(()=>[e(D),e(S,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=d=>s.value=!1)},{default:t(()=>[_(a(f.$t("Non")),1)]),_:1}),e(S,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:y},{default:t(()=>[_(a(f.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),De={key:1},Me=B({__name:"PaymentForm",props:{modelValue:Object,prestation:Object,title:I("PaymentMethod"),buttonText:I("Ajouter un paymentMethod")},emits:["update:modelValue","update:item"],setup(P,{emit:l}){const m=q(),x=R(),A=pe(),h=P,i=l,s=U({get:()=>h.modelValue,set:b=>i("update:modelValue",b)}),v=n(!1),y=n(!1),f=n([]);ae(()=>{A.fetchItems({per_page:500}).then(b=>{f.value=b.data.data,console.log(f.value)}),s.value.amount=c.value});const o=U(()=>h.prestation.services?h.prestation.services.reduce((b,V)=>(console.log(V.total,b),parseFloat(V.total)+parseFloat(b)),0):0),c=U(()=>h.prestation.payments&&h.prestation.payments.length?o.value-h.prestation.payments.reduce((b,V)=>parseFloat(V.amount)+parseFloat(b),0):o.value);function d(){y.value=!0,m.savePayment(h.prestation.id,s.value).then(b=>{v.value=!1,i("update:item",b.data),s.value={},s.value={},x.showSuccess(I("PaymentMethod enregistré avec succès"))}).catch(b=>{y.value=!1,x.showError(b.message)}).then(()=>{y.value=!1})}function w(b){if(console.log(c.value),b){const V=f.value.find(r=>r.id==b);V&&(s.value.payment_method=V.name||null,s.value.amount=c.value)}}return(b,V)=>{const r=G("EditIcon");return p(),k(W,{modelValue:v.value,"onUpdate:modelValue":V[4]||(V[4]=g=>v.value=g),"max-width":"500px"},{activator:t(({props:g})=>[c.value>0?(p(),k(S,z({key:0,dark:""},g,{icon:s.value.id!=null,flat:s.value.id!=null,variant:"elevated",color:s.value.id!=null?null:"primary",onClick:V[0]||(V[0]=H=>y.value=!1)}),{default:t(()=>[s.value.id?(p(),k(r,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(p(),N("span",De,a(P.buttonText),1))]),_:2},1040,["icon","flat","color"])):M("",!0)]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(P.title),1)]),_:1}),e(F),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(C,{cols:"12"},{default:t(()=>[e(re,{modelValue:s.value.payment_method_id,"onUpdate:modelValue":[V[1]||(V[1]=g=>s.value.payment_method_id=g),w],label:b.$t("PaymentMethod"),clearable:"",items:f.value,"item-title":"name","item-value":"id",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(C,{cols:"12"},{default:t(()=>[e(te,{min:0,modelValue:s.value.amount,"onUpdate:modelValue":V[2]||(V[2]=g=>s.value.amount=g),type:"number",label:b.$t("Montant")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(D),e(S,{color:"error",variant:"flat",dark:"",onClick:V[3]||(V[3]=g=>v.value=!1)},{default:t(()=>[_(a(b.$t("Annuler")),1)]),_:1}),e(S,{color:"success",variant:"flat",loading:y.value,dark:"",onClick:d},{default:t(()=>[_(a(b.$t("Ajouter")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Te=B({__name:"ClosePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const m=q(),x=R(),A=P,h=l,i=U({get:()=>A.modelValue,set:f=>h("update:modelValue",f)}),s=n(!1),v=n(!1);n(""),U(()=>`${I("Terminer la prestation")}`);function y(){v.value=!0,m.closeItem(i.value.id).then(f=>{i.value=f.data,s.value=!1,x.showSuccess(I("Prestation clôturée avec succès"))}).catch(f=>{v.value=!1,x.showError(f.message)}).then(()=>{v.value=!1})}return(f,o)=>(p(),k(W,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=c=>s.value=c),"max-width":"500px"},{activator:t(({props:c})=>[e(S,z({dark:""},c,{variant:"elevated",color:"primary",onClick:o[0]||(o[0]=d=>v.value=!1)}),{default:t(()=>[_(a(f.$t("Terminer la prestation")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(f.$t("Terminer la prestation")),1)]),_:1}),e(F),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(C,{cols:"12",class:"text-center"},{default:t(()=>[_(a(f.$t("Êtes-vous sûr de vouloir terminer la prestation?")),1)]),_:1})]),_:1})]),_:1}),e(F),e(K,null,{default:t(()=>[e(D),e(S,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=c=>s.value=!1)},{default:t(()=>[_(a(f.$t("Non")),1)]),_:1}),e(S,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:y},{default:t(()=>[_(a(f.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ee=B({__name:"CommentPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const m=q(),x=R(),A=P,h=l,i=U({get:()=>A.modelValue,set:o=>h("update:modelValue",o)}),s=n(!1),v=n(!1),y=n(i.value.commentaire||"");U(()=>`${I("Commentaire")}`);function f(){v.value=!0,m.addComment(i.value.id,y.value).then(o=>{i.value=o.data,s.value=!1,x.showSuccess(I("Commentaire ajouté avec succès"))}).catch(o=>{v.value=!1,x.showError(o.message)}).then(()=>{v.value=!1})}return(o,c)=>(p(),k(W,{modelValue:s.value,"onUpdate:modelValue":c[3]||(c[3]=d=>s.value=d),"max-width":"500px"},{activator:t(({props:d})=>[e(S,z({density:"compact",dark:""},d,{variant:"outlined",color:"primary",onClick:c[0]||(c[0]=w=>v.value=!1)}),{default:t(()=>[_(a(!i.value.commentaire||i.value.commentaire.length==0?o.$t("Ajouter"):o.$t("Modifier")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(!i.value.commentaire||i.value.commentaire.length==0?o.$t("Ajouter un commentaire"):o.$t("Modifier le commentaire")),1)]),_:1}),e(F),e(T,null,{default:t(()=>[e(O,null,{default:t(()=>[e(C,{cols:"12"},{default:t(()=>[e(le,{modelValue:y.value,"onUpdate:modelValue":c[1]||(c[1]=d=>y.value=d),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(F),e(K,null,{default:t(()=>[e(D),e(S,{color:"error",variant:"flat",dark:"",onClick:c[2]||(c[2]=d=>s.value=!1)},{default:t(()=>[_(a(o.$t("Annuler")),1)]),_:1}),e(S,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:f},{default:t(()=>[_(a(o.$t("Enregistrer")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Oe={key:0,class:"ml-2"},Fe={class:"d-flex align-start"},Ne={class:"text-h4 mt-1"},Le={class:"ml-auto"},qe={class:"mt-9"},Be={class:"text-h4 font-weight-semibold mb-1"},Re={class:"d-flex align-start"},ze={class:"text-h4 mt-1"},Qe={class:"ml-auto"},Ke={class:"mt-9"},We={class:"text-h4 font-weight-semibold mb-1"},Xe={class:"d-flex align-start"},Ze={class:"text-h4 mt-1"},Ge={class:"mt-4"},He={class:"mb-1"},Je={class:"d-flex align-start"},Ye={class:"text-h4 mt-1"},et={class:"mt-4"},tt={class:"mb-1"},at={class:"d-flex align-start"},lt={class:"text-h4 mt-1"},st={class:"mt-4"},ot={class:"mb-1"},ut={class:"text-h6 d-flex align-center"},nt={class:"text-h6"},rt={class:"text-h6"},dt={class:"text-h6"},it={class:"text-h6"},mt={class:"text-h6"},ct={key:0,class:"d-flex align-center"},vt={class:"text-h6 d-flex align-center"},ft={class:"text-h6"},pt={class:"text-h6"},ht={class:"text-h6"},Ft=B({__name:"View",setup(P){n(),R();const l=n({id:null,status:0,service:"",demand_date:null,customer_id:null,demand_id:null,payments:[],services:[],customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),m=q(),x=ie(),A=n({title:I("Détails du devis")+" "+(l.value.event_type||"")+" "+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(L(l.value.demand_date)||"")}),h=n([{text:I("Dashboard"),disabled:!1,href:"/"},{text:m.pageTitle(l.value.status),disabled:!1,href:m.pageLink(l.value.status)},{text:l.value.event_type||"",disabled:!0,href:"#"}]);function i(){A.value={title:I("Prestation")+" "+(l.value.demand.event_type||"")+" ("+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(L(l.value.demand_date)||"")+")"},h.value=[{text:I("Dashboard"),disabled:!1,href:"/"},{text:m.pageTitle(l.value.status),disabled:!1,href:m.pageLink(l.value.status)},{text:A.value.title,disabled:!0,href:"#"}]}ae(()=>{b()});const s=n(!1);n(!1),n(!1),n(!1),n(!1),n(!1),n(!1),n({}),n({}),n(!1),n(10),n(2),n(2),n(!1),n(!1),n(null);const v=n("");n(["primary","secondary","error","success","warning"]),n([{key:"demand_date",order:"DESC"}]),n(0),n({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"demand_date",order:"DESC"}]});const y=n(-1);n({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const f=n({id:null,service_id:null,name:"",price:0,total:0,quantity:0}),o=n({id:null,prestation_id:null,amount:0});n({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),n(!1),n([{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la prestation",align:"start",key:"demand_date"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),U(()=>m.prestations.data.filter(r=>r.email.toLowerCase().includes(v.value.toLowerCase())));const c=U(()=>x.params.id);U(()=>l.value.customer.prestations?l.value.customer.prestations.filter(r=>r.id!=l.value.id):[]);const d=U(()=>l.value.services&&l.value.services.length?l.value.services.reduce((r,g)=>(console.log(g.total,r),parseFloat(g.total)+parseFloat(r)),0):0),w=U(()=>l.value.payments&&l.value.payments.length?d.value-l.value.payments.reduce((r,g)=>parseFloat(g.amount)+parseFloat(r),0):d.value);U(()=>y.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function b(){s.value=!0,m.fetchItem(x.params.id).then(r=>{r.data.error||(s.value=!1,l.value=r.data,i())}).catch(r=>{s.value=!1}).then(()=>{s.value=!1})}function V(r){l.value=r}return me(c,(r,g)=>{r!=g&&b()},{deep:!0}),(r,g)=>{const H=G("CurrencyEuroIcon");return p(),N(J,null,[s.value?M("",!0):(p(),k(ve,{key:0,title:A.value.title,breadcrumbs:h.value},null,8,["title","breadcrumbs"])),s.value?(p(),k(O,{key:1,justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(C,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(ce,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(p(),k(O,{key:2},{default:t(()=>[e(C,{cols:"12",md:"4"},{default:t(()=>[_(a(r.$t("Status :"))+" ",1),e(ee,{rounded:"md",class:"font-weight-bold",color:$(m).statusColor(l.value.status),size:"small",label:""},{default:t(()=>[_(a($(m).statusText(l.value.status)),1)]),_:1},8,["color"]),l.value.status==$(m).statuses.cancelled?(p(),N("span",Oe,a(r.$t("Le"))+" "+a($(L)(l.value.cancelled_date)||""),1)):M("",!0)]),_:1}),e(C,{cols:"12",md:"8",justify:"end","align-content":"end",align:"end"},{default:t(()=>[l.value.status==$(m).statuses.started||l.value.status==$(m).statuses.cancelled?(p(),k(Ve,{key:0,modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=j=>l.value=j)},null,8,["modelValue"])):M("",!0),l.value.status==$(m).statuses.validated?(p(),k(Te,{key:1,modelValue:l.value,"onUpdate:modelValue":g[1]||(g[1]=j=>l.value=j)},null,8,["modelValue"])):M("",!0),l.value.status!=$(m).statuses.cancelled?(p(),k(_e,{key:2,modelValue:l.value,"onUpdate:modelValue":g[2]||(g[2]=j=>l.value=j)},null,8,["modelValue"])):M("",!0),e(F,{vertical:""}),e(S,{variant:"elevated",color:"success",class:"ml-2",to:"/customers/"+l.value.customer_id},{default:t(()=>[_(a(r.$t("Voir le Client")),1)]),_:1},8,["to"]),e(S,{variant:"elevated",color:"info",class:"ml-2",to:"/demands/"+l.value.demand_id},{default:t(()=>[_(a(r.$t("Voir la demande associée")),1)]),_:1},8,["to"])]),_:1}),e(C,{cols:"12",md:"4"},{default:t(()=>[e(Ae,{modelValue:l.value,"onUpdate:modelValue":g[3]||(g[3]=j=>l.value=j),"show-demand-info":""},null,8,["modelValue"])]),_:1}),e(C,{cols:"12",md:"8",class:"justify-end align-end"},{default:t(()=>[e(O,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[e(C,{cols:"12",class:"h-50 align-end justify-end align-content-end"},{default:t(()=>[e(O,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[l.value.status>=$(m).statuses.validated?(p(),k(C,{key:0,cols:"12",md:"6",class:"h-100"},{default:t(()=>[e(E,{elevation:"10"},{default:t(()=>[e(T,null,{default:t(()=>[u("div",Fe,[u("h2",Ne,a(r.$t("Reste à payer")),1),e(D),u("div",Le,[e(S,{color:"primary",icon:"",flat:""},{default:t(()=>[e(H)]),_:1})])]),u("div",qe,[u("h2",Be,a($(Z)(w.value)),1)])]),_:1})]),_:1})]),_:1})):M("",!0),e(C,{class:"h-100",cols:"12",md:"6"},{default:t(()=>[e(E,{elevation:"10"},{default:t(()=>[e(T,null,{default:t(()=>[u("div",Re,[u("h2",ze,a(r.$t("Montant total")),1),e(D),u("div",Qe,[e(S,{color:"primary",icon:"",flat:""},{default:t(()=>[e(H)]),_:1})])]),u("div",Ke,[u("h2",We,a($(Z)(d.value||0)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(C,{cols:"12",class:"h-50 align-end justify-end align-content-end"},{default:t(()=>[e(O,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[l.value.status==$(m).statuses.cancelled?(p(),k(C,{key:0,class:"h-100",cols:"12",md:"6"},{default:t(()=>[e(E,{elevation:"10",class:"h-100"},{default:t(()=>[e(T,null,{default:t(()=>[u("div",Xe,[u("h2",Ze,a(r.$t("Raison de l'annulation")),1)]),u("div",Ge,[u("p",He,a(l.value.cancel_comment||r.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1})):M("",!0),e(C,{class:"h-100",cols:"12",md:l.value.status==$(m).statuses.cancelled?"6":"12"},{default:t(()=>[e(O,{class:"h-100"},{default:t(()=>[e(C,{cols:"12",md:"6",class:"h-100"},{default:t(()=>[e(E,{elevation:"10",class:"h-100"},{default:t(()=>[e(T,null,{default:t(()=>[u("div",Je,[u("h2",Ye,a(r.$t("Note liée à la prestation")),1)]),u("div",et,[u("p",tt,a(l.value.comment||r.$t("Aucun note")),1)])]),_:1})]),_:1})]),_:1}),e(C,{cols:"12",md:"6",class:"h-100"},{default:t(()=>[e(E,{elevation:"10",class:"h-100"},{default:t(()=>[e(T,null,{default:t(()=>[u("div",at,[u("h2",lt,a(r.$t("Commentaire")),1),e(Ee,{modelValue:l.value,"onUpdate:modelValue":g[4]||(g[4]=j=>l.value=j)},null,8,["modelValue"])]),u("div",st,[u("p",ot,a(l.value.commentaire||r.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})]),_:1})]),_:1})]),_:1}),e(C,{cols:"12",lg:l.value.status>$(m).statuses.started?"6":"12"},{default:t(()=>[e(E,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(Y,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[u("h4",ut,[u("span",null,a(r.$t("Désignation des services attendus")),1),e(D),l.value.status<$(m).statuses.processing?(p(),k(ne,{key:0,modelValue:f.value,"onUpdate:modelValue":g[5]||(g[5]=j=>f.value=j),prestation:l.value,"onUpdate:item":V,"button-text":r.$t("Ajouter un service"),title:r.$t("Ajouter un service")},null,8,["modelValue","prestation","button-text","title"])):M("",!0)])]),_:1}),e(T,{class:"pa-6"},{default:t(()=>[e(ue,{class:"month-table"},{default:t(()=>[u("thead",null,[u("tr",null,[u("th",nt,a(r.$t("Désignation")),1),u("th",rt,a(r.$t("Quantité")),1),u("th",dt,a(r.$t("Prix unitaire")),1),u("th",it,a(r.$t("Prix total")),1),u("th",mt,a(r.$t("Actions")),1)])]),u("tbody",null,[(p(!0),N(J,null,oe(l.value.services,(j,X)=>(p(),N("tr",{key:j.id,class:"month-item"},[u("td",null,a(j.name),1),u("td",null,a(j.quantity),1),u("td",null,a($(Z)(j.price)),1),u("td",null,a($(Z)(j.total)),1),u("td",null,[l.value.status<$(m).statuses.processing?(p(),N("div",ct,[e(he,{text:r.$t("Modifier")},{activator:t(({props:se})=>[e(ne,{modelValue:l.value.services[X],"onUpdate:modelValue":de=>l.value.services[X]=de,prestation:l.value,"onUpdate:item":V,"button-text":r.$t("Modifier le service"),title:r.$t("Modifier le service")},null,8,["modelValue","onUpdate:modelValue","prestation","button-text","title"])]),_:2},1032,["text"]),e(Ie,{modelValue:l.value,"onUpdate:modelValue":g[6]||(g[6]=se=>l.value=se),service:l.value.services[X]},null,8,["modelValue","service"])])):M("",!0)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"]),l.value.status>$(m).statuses.started?(p(),k(C,{key:0,cols:"12",lg:l.value.status>$(m).statuses.started?"6":"12"},{default:t(()=>[e(E,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(Y,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[u("h4",vt,[u("span",null,a(r.$t("Paiements")),1),e(D),l.value.status<$(m).statuses.closed?(p(),k(Me,{key:0,modelValue:o.value,"onUpdate:modelValue":g[7]||(g[7]=j=>o.value=j),prestation:l.value,"onUpdate:item":V,"button-text":r.$t("Ajouter un paiement"),title:r.$t("Ajouter un paiement")},null,8,["modelValue","prestation","button-text","title"])):M("",!0)])]),_:1}),e(T,{class:"pa-6"},{default:t(()=>[e(ue,{class:"month-table"},{default:t(()=>[u("thead",null,[u("tr",null,[u("th",ft,a(r.$t("Mode de paiement")),1),u("th",pt,a(r.$t("Montant payé")),1),u("th",ht,a(r.$t("Date du paiement")),1)])]),u("tbody",null,[(p(!0),N(J,null,oe(l.value.payments,(j,X)=>(p(),N("tr",{key:j.id},[u("td",null,a(j.payment_method),1),u("td",null,a(j.amount),1),u("td",null,a($(L)(j.created_at)),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"])):M("",!0)]),_:1}))],64)}}});export{Ft as default};
