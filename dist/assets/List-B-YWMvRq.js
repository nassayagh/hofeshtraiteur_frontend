import{u as Y}from"./customers-CpTKjJL8.js";import{u as Z}from"./eventType-CVjiJMC0.js";import{_ as ee}from"./BaseBreadcrumb-DnGwAJ0g.js";import{f as te}from"./formatters-Dv1Ro_l4.js";import{a6 as ae,ay as le,r as a,av as re,az as w,h as oe,e as k,g as se,q as ne,o as ue,c as ie,b as l,w as o,a8 as E,n as de,V as f,d as i,t as u,a as me,X as pe}from"./index-BJHM7gAy.js";import{_ as ve}from"./CustomerDashboard.vue_vue_type_script_setup_true_lang-EAC5yk8j.js";import{V as c,a as I}from"./VRow-DaH2-4tX.js";import{V as fe}from"./VDataTableServer-HF-5z8-L.js";import{V as ce}from"./VToolbar-vej033f8.js";import{V as B}from"./VTextField-DZFvITyZ.js";import{V as ge}from"./filter-DewXPuM-.js";import{V as L}from"./VDialog-DWoX183J.js";import{V as Ve}from"./VLocaleProvider-BvqD0Ko2.js";import{V as ye}from"./VDatePicker-B-XDH8Zh.js";import{V as S}from"./VSpacer-Bpz83XCP.js";import{V as he,a as be,b as Ce}from"./VCard-CaJ5j7gp.js";import{V as ke}from"./VChip-LZF3RSku.js";import"./VTable-C630wu6p.js";import"./VDivider-Bfst1i1T.js";import"./index-CUixWq4_.js";import"./VAvatar-DmrmHn3w.js";import"./VField-BKzd96f8.js";import"./VMenu-DeUjaQEK.js";import"./createSimpleFunctional-DlxeIP2p.js";import"./VSheet-DIl2hYRP.js";const Qe=ae({__name:"List",setup($e){const d=le();a();const j=re(),N=Z(),M=a({title:"Clients"}),O=a([{text:w("Dashboard"),disabled:!1,href:"/"},{text:w("Clients"),disabled:!0,href:"#"}]),g=a([]),R=a([]),V=Y();oe(()=>{x(),G()});const y=a(!1);a(!1),a(!1),a(!1),a(!1),a(""),a(),a(!1);const U=a(null);a(null),a(null),a(null);const h=a(!1);a();const $=a(10),p=a(2),b=a(2),P=a(0);a(!1);const z=a(!1);a(null);const D=a("");a(["primary","secondary","error","success","warning"]);const m=a([{key:"created_at",order:"DESC"}]);a(0);const s=a({search:null,status:null,date:null,event_type:null}),v=a({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"created_at",order:"DESC"}]}),F=a(-1),_=a({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});a({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const C=a(!1),K=a([{title:"Prénom",align:"start",key:"firstname"},{title:"Nom",align:"start",key:"lastname"},{title:"Email",align:"start",key:"email"},{title:"Téléphone",align:"start",key:"phone"},{title:"Date de creation",align:"start",key:"created_at"},{title:"Status",align:"start",key:"is_customer"},{title:"Actions",key:"actions",sortable:!1}]),T=k(()=>s.value.date&&s.value.date.length>0?d.format(s.value.date[0],"shortDate")+" - "+d.format(s.value.date[s.value.date.length-1],"shortDate"):null);k(()=>V.customers.data.filter(r=>r.email.toLowerCase().includes(D.value.toLowerCase())));function q(){V.deleteItem(_.value.id);const r=g.value.findIndex(e=>e.id==_.value.id);g.value.splice(r,1),C.value=!1,j.showSuccess(w("Utilisateur supprimé avec succès"))}k(()=>F.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const X=k(()=>s.value.date&&s.value.date.length?s.value.date.length>1?[d.format(s.value.date[0],"shortDate"),d.format(s.value.date[s.value.date.length-1],"shortDate")]:[d.format(s.value.date[0],"shortDate"),d.format(s.value.date[0],"shortDate")]:null);function x(){try{clearTimeout(U.value)}catch{}U.value=setTimeout(()=>{y.value=!0;let r="id",e="desc";console.log(m.value),m.value.length>0&&(r=m.value[0].key,e=m.value[0].order),V.fetchItems({term:D.value,paginate:$.value,current_page:p.value,direction:e,order_by:r,page:v.value.page,per_page:v.value.itemsPerPage,...s.value,date:X.value}).then(t=>{if(t.data){const{data:n,current_page:H,next_page_url:J,total:A,per_page:Q,to:Pe,last_page:W}=t.data;g.value=n,b.value=W,P.value=A}}).catch(t=>{console.error(t)}).then(()=>{y.value=!1})},1e3)}function G(){N.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(r=>{if(r.data){const{data:e,current_page:t,next_page_url:n,total:H,per_page:J,to:A,last_page:Q}=r.data;R.value=e}}).catch(r=>{console.error(r)}).then(()=>{y.value=!1})}return se([D,v,s],()=>{x()},{deep:!0}),ne(()=>{p.value>b.value&&(p.value=b.value)}),(r,e)=>(ue(),ie(pe,null,[l(ee,{title:M.value.title,breadcrumbs:O.value},null,8,["title","breadcrumbs"]),l(I,null,{default:o(()=>[l(c,{cols:"12"},{default:o(()=>[l(ve)]),_:1}),l(c,{cols:"12"},{default:o(()=>[l(fe,{class:"border rounded-md",headers:K.value,loading:y.value,items:g.value,"multi-sort":!1,"items-per-page":$.value,"onUpdate:itemsPerPage":e[11]||(e[11]=t=>$.value=t),"items-per-page-text":r.$t("Articles par page"),options:v.value,"onUpdate:options":e[12]||(e[12]=t=>v.value=t),"sort-by":m.value,"onUpdate:sortBy":e[13]||(e[13]=t=>m.value=t),page:p.value,"onUpdate:page":e[14]||(e[14]=t=>p.value=t),"items-length":P.value,"onUpdate:itemsLength":e[15]||(e[15]=t=>P.value=t),"show-select":!1,"loading-text":r.$t("Chargement des éléments"),"no-data-text":r.$t("Pas de données"),"no-results-text":r.$t("Aucun résultat"),onPageCount:e[16]||(e[16]=t=>b.value=t)},{top:o(()=>[l(ce,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:o(()=>[l(I,null,{default:o(()=>[l(c,null,{default:o(()=>[l(B,{density:"compact",modelValue:s.value.search,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.search=t),placeholder:r.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),l(c,null,{default:o(()=>[l(ge,{density:"compact",modelValue:s.value.status,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.status=t),placeholder:r.$t("Statut"),items:E(V).statusesList,"item-value":"id","item-title":"label",clearable:"","hide-details":"",variant:"solo"},null,8,["modelValue","placeholder","items"])]),_:1}),l(c,null,{default:o(()=>[l(L,{ref_key:"dialog",ref:z,modelValue:h.value,"onUpdate:modelValue":e[7]||(e[7]=t=>h.value=t),"return-value":s.value.date,"onUpdate:returnValue":e[8]||(e[8]=t=>s.value.date=t),persistent:"",width:"290px"},{activator:o(({props:t})=>[l(B,de({modelValue:T.value,"onUpdate:modelValue":e[2]||(e[2]=n=>T.value=n),"prepend-inner-icon":"bx-calendar"},t,{density:"compact",placeholder:r.$t("Date"),"hide-details":"",variant:"solo",clearable:"",readonly:"","onClick:clear":e[3]||(e[3]=n=>s.value.date=null)}),null,16,["modelValue","placeholder"])]),default:o(({isActive:t})=>[l(Ve,{locale:"fr"},{default:o(()=>[l(ye,{modelValue:s.value.date,"onUpdate:modelValue":e[6]||(e[6]=n=>s.value.date=n),"hide-header":"",multiple:"range"},{actions:o(()=>[l(f,{color:"primary",onClick:e[4]||(e[4]=n=>h.value=!1)},{default:o(()=>[i(u(r.$t("Annuler")),1)]),_:1}),l(S),l(f,{variant:"elevated",color:"primary",onClick:e[5]||(e[5]=n=>h.value=!1)},{default:o(()=>[i(u(r.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),l(L,{modelValue:C.value,"onUpdate:modelValue":e[10]||(e[10]=t=>C.value=t),"max-width":"500px"},{default:o(()=>[l(he,null,{default:o(()=>[l(be,{class:"text-h5 text-center py-6"},{default:o(()=>[i(u(r.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),l(Ce,null,{default:o(()=>[l(S),l(f,{color:"error",variant:"flat",dark:"",onClick:e[9]||(e[9]=t=>C.value=!1)},{default:o(()=>[i(u(r.$t("Annuler")),1)]),_:1}),l(f,{color:"success",variant:"flat",dark:"",onClick:q},{default:o(()=>[i(u(r.$t("OK")),1)]),_:1}),l(S)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.created_at":o(({item:t})=>[i(u(E(te)(t.created_at)),1)]),"item.is_customer":o(({item:t})=>[l(ke,{color:t.is_customer==1?"success":"warning",size:"small",label:""},{default:o(()=>[i(u(t.is_customer==1?r.$t("Client"):r.$t("Prospet")),1)]),_:2},1032,["color"])]),"item.actions":o(({item:t})=>[l(f,{density:"compact",color:"primary",variant:"outlined",to:"/customers/"+t.id},{default:o(()=>[i(u(r.$t("Voir")),1)]),_:2},1032,["to"])]),"no-data":o(()=>[me("span",null,u(r.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{Qe as default};
