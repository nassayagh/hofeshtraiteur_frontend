import{u as _e}from"./payments-lIZcUUrU.js";import{u as ye}from"./eventType-BXqcEFO4.js";import{u as we}from"./paymentMethod-CHeUa6e8.js";import{_ as be}from"./BaseBreadcrumb-nfEEB43r.js";import{f as R,a as K}from"./formatters-DCCWVJxZ.js";import{a6 as ie,Z as q,o as c,_ as x,w as t,b as e,a as s,t as i,V as h,a8 as v,c as w,a4 as p,aC as Ve,r as l,av as Pe,aM as _,aN as ke,h as xe,e as L,g as $e,q as Ce,n as X,d as $,X as De}from"./index-CVh0MMQn.js";import{u as Se}from"./Controller-Cr4EY00q.js";import{V as g,a as O}from"./VRow-D12LnFBq.js";import{V as P,a as b,b as Te,c as Ie}from"./VCard-QwDGsH5t.js";import{a as y}from"./VSpacer-yRvPXPta.js";import{V as Be}from"./VDataTableServer-DHNN39Q1.js";import{V as Me}from"./VToolbar-DPm-f_YC.js";import{V as se}from"./VTextField-B6PYK-xW.js";import{b as le}from"./VSelect-CQykGEFm.js";import{V as oe}from"./VDialog-DJ1-zx0P.js";import{V as Ue}from"./VLocaleProvider-Bc7yYfvg.js";import{V as Ee}from"./VDatePicker-rLpnnX-K.js";import{V as ne}from"./VTooltip-0-81gRU4.js";import"./VAvatar-DebhkieN.js";import"./filter-DW9a1be5.js";import"./VMenu-CG_nwP7Z.js";import"./VSheet-CZVJV8hd.js";const Ae={class:"d-flex align-start"},Ne={class:"text-h4"},je={class:"ml-auto"},Le={class:"mt-2"},Re={class:"text-h4 font-weight-regular"},qe={key:0,class:"text-subtitle-1"},Oe={class:"d-flex align-start"},ze={class:"text-h4"},Fe={class:"ml-auto"},Ge={class:"mt-2"},He={class:"text-h4 font-weight-regular"},Ke={key:0,class:"text-subtitle-1"},Xe={class:"d-flex align-start"},Ze={class:"text-h4"},Je={class:"ml-auto"},Qe={class:"mt-2"},We={class:"text-h4 font-weight-regular"},Ye={key:0,class:"text-subtitle-1"},et={class:"d-flex align-start"},tt={class:"text-h4"},at={class:"ml-auto"},st={class:"mt-2"},lt={class:"text-h4 font-weight-regular"},ot={key:0,class:"text-subtitle-1"},nt={class:"d-flex align-start"},it={class:"text-h4"},rt={class:"ml-auto"},dt={class:"mt-2"},ut={class:"text-h4 font-weight-regular"},ct={key:0,class:"text-subtitle-1"},mt={class:"d-flex align-start"},ht={class:"text-h4"},ft={class:"ml-auto"},pt={class:"mt-2"},vt={class:"text-h4 font-weight-regular"},gt={key:0,class:"text-subtitle-1"},_t={class:"d-flex align-start"},yt={class:"text-h4"},wt={class:"ml-auto"},bt={class:"mt-2"},Vt={class:"text-h4 font-weight-regular"},Pt={key:0,class:"text-subtitle-1"},kt={class:"d-flex align-start"},xt={class:"text-h4"},$t={class:"ml-auto"},Ct={class:"mt-2"},Dt={class:"text-h4 font-weight-regular"},St={key:0,class:"text-subtitle-1"},Tt=ie({__name:"PrespationDashboard",props:{showDescription:{type:Boolean,default:!1},showPayments:{type:Boolean,default:!1},showValidation:{type:Boolean,default:!1},showValidated:{type:Boolean,default:!1},showProcessing:{type:Boolean,default:!1},showClosed:{type:Boolean,default:!1},showCancelled:{type:Boolean,default:!1},showTotalPayments:{type:Boolean,default:!1},md:{type:String,default:"3"}},setup(d){const m=Se();return m.fetchStatistics({}),(u,Z)=>{const D=q("CurrencyEuroIcon"),k=q("HotelServiceIcon");return d.showPayments?(c(),x(O,{key:0},{default:t(()=>[d.showTotalPayments?(c(),x(g,{key:0,class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Ae,[s("h2",Ne,i(u.$t("Montant total")),1),e(y),s("div",je,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-info"})]),_:1})])]),s("div",Le,[s("h2",Re,i(v(R)(v(m).statistics.totalPayments||0)),1),d.showDescription?(c(),w("span",qe,i(u.$t("Montant total de service")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),e(g,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Oe,[s("h2",ze,i(u.$t("Montant à régler")),1),e(y),s("div",Fe,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-primary"})]),_:1})])]),s("div",Ge,[s("h2",He,i(v(R)(v(m).statistics.paymentsLeft||0)),1),d.showDescription?(c(),w("span",Ke,i(u.$t("Montant restant à régler")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),e(g,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Xe,[s("h2",Ze,i(u.$t("Montant réglé")),1),e(y),s("div",Je,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-success"})]),_:1})])]),s("div",Qe,[s("h2",We,i(v(R)(v(m).statistics.paymentsReceived||0)),1),d.showDescription?(c(),w("span",Ye,i(u.$t("Montant total déjà réglé")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})):(c(),x(O,{key:1},{default:t(()=>[e(g,{class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",et,[s("h2",tt,i(u.$t("Prestations")),1),e(y),s("div",at,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-primary"})]),_:1})])]),s("div",st,[s("h2",lt,i(v(m).statistics.total||0),1),d.showDescription?(c(),w("span",ot,i(u.$t("Prestations total")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),d.showValidation?(c(),x(g,{key:0,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",nt,[s("h2",it,i(u.$t("Prestations validées")),1),e(y),s("div",rt,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-success"})]),_:1})])]),s("div",dt,[s("h2",ut,i(v(m).statistics.validated||0),1),d.showDescription?(c(),w("span",ct,i(u.$t("Prestations total validées")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),d.showValidated?(c(),x(g,{key:1,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",mt,[s("h2",ht,i(u.$t("Prestations en validation")),1),e(y),s("div",ft,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",pt,[s("h2",vt,i(v(m).statistics.validation||0),1),d.showDescription?(c(),w("span",gt,i(u.$t("Prestations total en attende de validation")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),d.showClosed?(c(),x(g,{key:2,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",_t,[s("h2",yt,i(u.$t("Prestations Clôturée")),1),e(y),s("div",wt,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",bt,[s("h2",Vt,i(v(m).statistics.closed||0),1),d.showDescription?(c(),w("span",Pt,i(u.$t("Prestations total Clôturée")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0),d.showCancelled?(c(),x(g,{key:3,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-error h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",kt,[s("h2",xt,i(u.$t("Prestations annulées")),1),e(y),s("div",$t,[e(h,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-error"})]),_:1})])]),s("div",Ct,[s("h2",Dt,i(v(m).statistics.cancelled||0),1),d.showDescription?(c(),w("span",St,i(u.$t("Prestations total annulées")),1)):p("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):p("",!0)]),_:1}))}}}),It={class:"d-flex align-center"},ta=ie({__name:"List",setup(d){const m=Ve();l();const u=Pe(),Z=ye(),D=we(),k=l({title:"Gestion des paiements"}),re=l([{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Gestion des paiements"),disabled:!0,href:"#"}]),U=l([]),J=l([]),Q=l([]),z=_e(),W=ke();xe(()=>{W.query.method&&(r.value.payment_method=[W.query.method]),te(),pe(),ve()});const S=l(!1);l(!1),l(!1),l(!1),l(!1),l(""),l(),l(!1);const Y=l(null);l(null),l(null),l(null);const E=l(!1);l();const F=l(100),T=l(2),A=l(2),N=l(0);l(!1);const de=l(!1);l(null);const G=l("");l(["primary","secondary","error","success","warning"]);const C=l([{key:"payment_date",order:"DESC"}]);l(0);const r=l({search:null,status:null,date:null,event_type:null}),I=l({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"payment_date",order:"DESC"}]}),ue=l(-1),H=l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const B=l(!1),ce=l([{title:_("Prénom"),align:"start",key:"prestation.customer.firstname",sortable:!1},{title:_("Nom"),align:"start",key:"prestation.customer.lastname",sortable:!1},{title:_("Email"),align:"start",key:"prestation.customer.email",sortable:!1},{title:_("Téléphone"),align:"start",key:"prestation.customer.phone",sortable:!1},{title:_("Prestation"),align:"start",key:"prestation.event_type"},{title:_("Mode de paiement"),align:"start",key:"payment_method"},{title:_("Montant payé"),align:"start",key:"amount"},{title:_("Date du paiement"),align:"start",key:"payment_date"},{title:"Actions",key:"actions",sortable:!1}]),ee=L(()=>r.value.date&&r.value.date.length>0?K(r.value.date[0])+" - "+K(r.value.date[r.value.date.length-1]):null);L(()=>z.payments.data.filter(n=>n.email.toLowerCase().includes(G.value.toLowerCase())));function me(n){H.value=n,B.value=!0}function he(){z.deleteItem(H.value.id);const n=U.value.findIndex(a=>a.id==H.value.id);U.value.splice(n,1),B.value=!1,u.showSuccess(_("Utilisateur supprimé avec succès"))}L(()=>ue.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const fe=L(()=>r.value.date&&r.value.date.length?r.value.date.length>1?[m.format(r.value.date[0],"shortDate"),m.format(r.value.date[r.value.date.length-1],"shortDate")]:[m.format(r.value.date[0],"shortDate"),m.format(r.value.date[0],"shortDate")]:null);function te(){try{clearTimeout(Y.value)}catch{}Y.value=setTimeout(()=>{S.value=!0;let n="id",a="desc";console.log(C.value),C.value.length>0&&(n=C.value[0].key,a=C.value[0].order),z.fetchItems({term:G.value,paginate:F.value,current_page:T.value,direction:a,order_by:n,page:I.value.page,per_page:I.value.itemsPerPage,...r.value,date:fe.value}).then(V=>{if(V.data){const{data:M,current_page:o,next_page_url:f,total:j,per_page:ae,to:Bt,last_page:ge}=V.data;U.value=M,A.value=ge,N.value=j}}).catch(V=>{console.error(V)}).then(()=>{S.value=!1})},1e3)}function pe(){Z.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:M,total:o,per_page:f,to:j,last_page:ae}=n.data;J.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}function ve(){D.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:M,total:o,per_page:f,to:j,last_page:ae}=n.data;Q.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}return $e([G,I,r],()=>{te()},{deep:!0}),Ce(()=>{T.value>A.value&&(T.value=A.value)}),(n,a)=>{const V=q("EyeIcon"),M=q("TrashIcon");return c(),w(De,null,[e(be,{title:`${k.value.title}(${N.value})`,breadcrumbs:re.value},null,8,["title","breadcrumbs"]),e(Tt,{"show-payments":"","show-description":"","show-total-payments":""}),e(O,null,{default:t(()=>[e(g,{cols:"12"},{default:t(()=>[e(Be,{class:"border rounded-md",headers:ce.value,loading:S.value,items:U.value,"multi-sort":!1,"items-per-page":F.value,"onUpdate:itemsPerPage":a[12]||(a[12]=o=>F.value=o),"items-per-page-text":n.$t("Articles par page"),options:I.value,"onUpdate:options":a[13]||(a[13]=o=>I.value=o),"sort-by":C.value,"onUpdate:sortBy":a[14]||(a[14]=o=>C.value=o),page:T.value,"onUpdate:page":a[15]||(a[15]=o=>T.value=o),"items-length":N.value,"onUpdate:itemsLength":a[16]||(a[16]=o=>N.value=o),"show-select":!1,"loading-text":n.$t("Chargement des éléments"),"no-data-text":n.$t("Pas de données"),"no-results-text":n.$t("Aucun résultat"),onPageCount:a[17]||(a[17]=o=>A.value=o)},{top:t(()=>[e(Me,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:t(()=>[e(O,null,{default:t(()=>[e(g,null,{default:t(()=>[e(se,{density:"compact",modelValue:r.value.search,"onUpdate:modelValue":a[0]||(a[0]=o=>r.value.search=o),placeholder:n.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),e(g,null,{default:t(()=>[e(le,{density:"compact",modelValue:r.value.event_type,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value.event_type=o),placeholder:n.$t("Prestation"),items:J.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(g,null,{default:t(()=>[e(le,{density:"compact",modelValue:r.value.payment_method,"onUpdate:modelValue":a[2]||(a[2]=o=>r.value.payment_method=o),placeholder:n.$t("Mode de paiement"),items:Q.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(g,null,{default:t(()=>[e(oe,{ref_key:"dialog",ref:de,modelValue:E.value,"onUpdate:modelValue":a[8]||(a[8]=o=>E.value=o),"return-value":r.value.date,"onUpdate:returnValue":a[9]||(a[9]=o=>r.value.date=o),persistent:"",width:"290px"},{activator:t(({props:o})=>[e(se,X({modelValue:ee.value,"onUpdate:modelValue":a[3]||(a[3]=f=>ee.value=f),"prepend-inner-icon":"bx-calendar",readonly:""},o,{density:"compact",placeholder:n.$t("Date"),"hide-details":"",variant:"solo",clearable:"","onClick:clear":a[4]||(a[4]=f=>r.value.date=null)}),null,16,["modelValue","placeholder"])]),default:t(({isActive:o})=>[e(Ue,{locale:"fr"},{default:t(()=>[e(Ee,{modelValue:r.value.date,"onUpdate:modelValue":a[7]||(a[7]=f=>r.value.date=f),"hide-header":"",multiple:"range"},{actions:t(()=>[e(h,{color:"primary",onClick:a[5]||(a[5]=f=>E.value=!1)},{default:t(()=>[$(i(n.$t("Annuler")),1)]),_:1}),e(y),e(h,{variant:"elevated",color:"primary",onClick:a[6]||(a[6]=f=>E.value=!1)},{default:t(()=>[$(i(n.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),e(oe,{modelValue:B.value,"onUpdate:modelValue":a[11]||(a[11]=o=>B.value=o),"max-width":"500px"},{default:t(()=>[e(b,null,{default:t(()=>[e(Te,{class:"text-h5 text-center py-6"},{default:t(()=>[$(i(n.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),e(Ie,null,{default:t(()=>[e(y),e(h,{color:"error",variant:"flat",dark:"",onClick:a[10]||(a[10]=o=>B.value=!1)},{default:t(()=>[$(i(n.$t("Annuler")),1)]),_:1}),e(h,{color:"success",variant:"flat",dark:"",onClick:he},{default:t(()=>[$(i(n.$t("OK")),1)]),_:1}),e(y)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.amount":t(({item:o})=>[$(i(v(R)(o.amount)),1)]),"item.payment_date":t(({item:o})=>[$(i(v(K)(o.payment_date)),1)]),"item.actions":t(({item:o})=>[s("div",It,[e(ne,{text:n.$t("Voir la prestation liée")},{activator:t(({props:f})=>[e(h,X({icon:"",flat:"",to:"/prestations/"+o.prestation_id},f),{default:t(()=>[e(V,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["to"])]),_:2},1032,["text"]),e(ne,{text:n.$t("Supprimer")},{activator:t(({props:f})=>[e(h,X({icon:"",flat:"",onClick:j=>me(o)},f),{default:t(()=>[e(M,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])])]),"no-data":t(()=>[s("span",null,i(n.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64)}}});export{ta as default};
