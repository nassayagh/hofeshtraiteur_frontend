import{u as O}from"./demands-DsFrNd6l.js";import{O as F,aa as G,e as D,r,o as i,F as c,w as t,V as x,n as K,d as n,t as e,L as C,b as l,ae as g,af as Q,ag as X,h as Y,g as Z,q as ee,c as j,ah as te,Q as y,a as s,M as z,N as R}from"./index-CYfILRca.js";import{_ as ae}from"./BaseBreadcrumb-DRlD6SE8.js";import{f as S}from"./formatters-Dv1Ro_l4.js";import{a as H,b as J,V as I,c as E,d as L}from"./VCard-Dnooo6lu.js";import{V as U}from"./VSpacer-BBf-e-OC.js";import{V as W}from"./VDialog-6XXdTcm3.js";import{V as le}from"./VDivider-DiuNH7Gl.js";import{a as M,V as b}from"./VRow-PtTG9hte.js";import{V as se}from"./VTextarea-BUi19tgj.js";import{V as A}from"./VChip-wPEPIJH-.js";import{V as q}from"./VTable-D9vI0vca.js";import"./createSimpleFunctional-DQFtp_zt.js";import"./VAvatar-CjZwGR36.js";/* empty css              */import"./dialog-transition-Dvg3ebcB.js";/* empty css                   */import"./VField-xHnotgnH.js";import"./index-CFsFbVMi.js";import"./VLabel-DiIOZmLy.js";import"./VInput-D8bMUpni.js";import"./VSlideGroup-D8JjGdTS.js";const oe=F({__name:"CancelDemand",props:{modelValue:Object},emits:["update:modelValue"],setup(B,{emit:a}){const P=O(),w=G(),N=B,f=a,v=D({get:()=>N.modelValue,set:h=>f("update:modelValue",h)}),m=r(!1),p=r(!1);function $(){p.value=!0,P.cancelItem(v.value.id).then(h=>{v.value=h.data,m.value=!1,w.showSuccess(g("Devis annulé avec succès")),Q.push("/demands")}).then(()=>{p.value=!1})}return(h,k)=>(i(),c(W,{modelValue:m.value,"onUpdate:modelValue":k[1]||(k[1]=d=>m.value=d),"max-width":"350px"},{activator:t(({props:d})=>[v.value.status==0?(i(),c(x,K({key:0,color:"error",class:"ml-3",variant:"outlined",dark:""},d),{default:t(()=>[n(e(h.$t("Annuler la devis")),1)]),_:2},1040)):C("",!0)]),default:t(()=>[l(I,null,{default:t(()=>[l(H,{class:"text-h5 text-center py-6"},{default:t(()=>[n(e(h.$t("Êtes-vous sûr de vouloir annuller la devis?")),1)]),_:1}),l(J,null,{default:t(()=>[l(U),l(x,{color:"error",variant:"flat",dark:"",onClick:k[0]||(k[0]=d=>m.value=!1)},{default:t(()=>[n(e(h.$t("Annuler")),1)]),_:1}),l(x,{color:"success",variant:"flat",loading:p.value,dark:"",onClick:$},{default:t(()=>[n(e(h.$t("OK")),1)]),_:1},8,["loading"]),l(U)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),re=F({__name:"ValidateDemand",props:{modelValue:Object},emits:["update:modelValue"],setup(B,{emit:a}){const P=O(),w=G(),N=B,f=a,v=D({get:()=>N.modelValue,set:d=>f("update:modelValue",d)}),m=r(!1),p=r(!1),$=r(""),h=D(()=>`${g("Validation de la demande de ")} ${(v.value.customer||{firstname:""}).firstname} ${(v.value.customer||{lastname:""}).lastname} ${S(v.value.demand_date)||""}`);function k(){p.value=!0,P.validateItem(v.value.id,$.value).then(d=>{v.value=d.data,m.value=!1,w.showSuccess(g("Devis validé avec succès")),Q.push("/demands")}).catch(d=>{p.value=!1,w.showError(d.message)}).then(()=>{p.value=!1})}return(d,_)=>(i(),c(W,{modelValue:m.value,"onUpdate:modelValue":_[3]||(_[3]=V=>m.value=V),"max-width":"500px"},{activator:t(({props:V})=>[l(x,K({dark:""},V,{variant:"elevated",color:"primary",onClick:_[0]||(_[0]=o=>p.value=!1)}),{default:t(()=>[n(e(d.$t("Valider en prestation")),1)]),_:2},1040)]),default:t(()=>[l(I,null,{default:t(()=>[l(H,{class:"text-h5 text-center py-6"},{default:t(()=>[n(e(d.$t("Êtes-vous sûr de vouloir Valider en prestation?")),1)]),_:1}),l(le),l(E,null,{default:t(()=>[l(M,null,{default:t(()=>[l(b,{cols:"12"},{default:t(()=>[n(e(h.value),1)]),_:1}),l(b,{cols:"12"},{default:t(()=>[l(se,{modelValue:$.value,"onUpdate:modelValue":_[1]||(_[1]=V=>$.value=V),label:d.$t("Note de liée")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),l(J,null,{default:t(()=>[l(U),l(x,{color:"error",variant:"flat",dark:"",onClick:_[2]||(_[2]=V=>m.value=!1)},{default:t(()=>[n(e(d.$t("Annuler")),1)]),_:1}),l(x,{color:"success",variant:"flat",loading:p.value,dark:"",onClick:k},{default:t(()=>[n(e(d.$t("Créer la prestation")),1)]),_:1},8,["loading"]),l(U)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ne={class:"text-h6"},ue={class:"text-subtitle-1 textSecondary mt-3"},de={class:"text-subtitle-1 textSecondary mt-3"},ie={class:"text-subtitle-1 textSecondary mt-3"},me={class:"text-subtitle-1 textSecondary mt-3"},ce={class:"text-subtitle-1 textSecondary mt-3"},fe={class:"text-subtitle-1 textSecondary mt-3"},ve={class:"text-h6"},pe={class:"text-subtitle-1 textSecondary mt-3"},he={class:"text-subtitle-1 textSecondary mt-3"},_e={class:"text-subtitle-1 textSecondary mt-3"},ye={class:"text-subtitle-1 textSecondary mt-3"},Ve={class:"text-subtitle-1 textSecondary mt-3"},be={class:"text-subtitle-1 textSecondary mt-3"},ge=s("br",null,null,-1),xe={class:"text-h6"},$e=s("thead",null,[s("tr",null,[s("th",{class:"text-h6"},"ID"),s("th",{class:"text-h6"},"Prestation"),s("th",{class:"text-h6"},"Date de la demande"),s("th",{class:"text-h6"},"Status"),s("th",{class:"text-h6"},"Action")])],-1),ke={class:"text-h6 font-weight-medium text-medium-emphasis"},we={class:"text-h6"},Ce=s("thead",null,[s("tr",null,[s("th",{class:"text-h6"},"ID"),s("th",{class:"text-h6"},"Prestation"),s("th",{class:"text-h6"},"Date de la demande"),s("th",{class:"text-h6"},"Status"),s("th",{class:"text-h6"},"Action")])],-1),Se={class:"text-h6 font-weight-medium text-medium-emphasis"},We=F({__name:"View",setup(B){r(),G();const a=r({id:null,status:0,service:"",demand_date:null,customer_id:null,prestation_id:null,customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),P=r({title:g("Détails du devis")+" "+(a.value.event_type||"")+" "+(a.value.customer||{firstname:""}).firstname+" "+(a.value.customer||{lastname:""}).lastname+" "+(S(a.value.demand_date)||"")}),w=r([{text:g("Dashboard"),disabled:!1,href:"/"},{text:g("Gestion des devis"),disabled:!1,href:"/demands"},{text:a.value.event_type||"",disabled:!0,href:"#"}]);function N(){P.value={title:g("Détails du devis")+" "+(a.value.event_type||"")+" ("+(a.value.customer||{firstname:""}).firstname+" "+(a.value.customer||{lastname:""}).lastname+" "+(S(a.value.demand_date)||"")+")"},w.value=[{text:g("Dashboard"),disabled:!1,href:"/"},{text:g("Gestion des devis"),disabled:!1,href:"/demands"},{text:a.value.event_type||"",disabled:!0,href:"#"}]}const f=O(),v=X();Y(()=>{V()});const m=r(!1);r(!1),r(10);const p=r(2),$=r(2);r(!1),r(!1),r(null);const h=r("");r(["primary","secondary","error","success","warning"]),r([{key:"demand_date",order:"DESC"}]),r(0),r({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"demand_date",order:"DESC"}]});const k=r(-1);r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),r(!1),r([{title:"Prénom",align:"start",key:"customer.firstname",sortable:!1},{title:"Nom",align:"start",key:"customer.lastname",sortable:!1},{title:"Email",align:"start",key:"customer.email",sortable:!1},{title:"Téléphone",align:"start",key:"customer.phone",sortable:!1},{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la demande",align:"start",key:"demand_date"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),D(()=>f.demands.data.filter(o=>o.email.toLowerCase().includes(h.value.toLowerCase())));const d=D(()=>v.params.id),_=D(()=>a.value.customer.demands?a.value.customer.demands.filter(o=>o.id!=a.value.id):[]);D(()=>k.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function V(){m.value=!0,f.fetchItem(v.params.id).then(o=>{o.data.error||(m.value=!1,a.value=o.data,N())}).catch(o=>{m.value=!1}).then(()=>{m.value=!1})}return Z(d,(o,T)=>{o!=T&&V()},{deep:!0}),ee(()=>{p.value>$.value&&(p.value=$.value)}),(o,T)=>(i(),j(z,null,[m.value?C("",!0):(i(),c(ae,{key:0,title:P.value.title,breadcrumbs:w.value},null,8,["title","breadcrumbs"])),m.value?(i(),c(M,{key:1,justify:"center",align:"center","align-content":"center"},{default:t(()=>[l(b,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:t(()=>[l(te,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(i(),c(M,{key:2},{default:t(()=>[l(b,{cols:"12",md:"6"},{default:t(()=>[n(e(o.$t("Status :"))+" ",1),l(A,{rounded:"md",class:"font-weight-bold",color:y(f).statusColor(a.value.status),size:"small",label:""},{default:t(()=>[n(e(y(f).statusText(a.value.status)),1)]),_:1},8,["color"])]),_:1}),l(b,{cols:"12",md:"6",justify:"end","align-content":"end",align:"end"},{default:t(()=>[a.value.prestation?C("",!0):(i(),c(re,{key:0,modelValue:a.value,"onUpdate:modelValue":T[0]||(T[0]=u=>a.value=u)},null,8,["modelValue"])),a.value.prestation&&a.value.prestation.id?(i(),c(x,{key:1,variant:"elevated",color:"primary",to:"/prestations/"+a.value.prestation.id},{default:t(()=>[n(e(o.$t("Voir la prestation liée")),1)]),_:1},8,["to"])):C("",!0),a.value.prestation?C("",!0):(i(),c(oe,{key:2,modelValue:a.value,"onUpdate:modelValue":T[1]||(T[1]=u=>a.value=u)},null,8,["modelValue"]))]),_:1}),l(b,{cols:"12",md:"4"},{default:t(()=>[l(I,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[l(L,{class:"py-4 px-6 text-white bg-primary"},{default:t(()=>[s("h4",ne,e(o.$t("Identification du demandeur")),1)]),_:1}),l(E,{class:"pa-6"},{default:t(()=>[s("p",ue,e(o.$t("Prénom :"))+" "+e(a.value.customer.firstname||""),1),s("p",de,e(o.$t("Nom :"))+" "+e(a.value.customer.lastname||""),1),s("p",ie,e(o.$t("Email :"))+" "+e(a.value.customer.email||""),1),s("p",me,e(o.$t("Téléphone :"))+" "+e(a.value.customer.phone||""),1),s("p",ce,e(o.$t("Date d'enregistrement :"))+" "+e(y(S)(a.value.customer.created_at)||""),1),s("p",fe,[n(e(o.$t("Type :"))+" ",1),a.value.customer&&a.value.customer.is_customer?(i(),c(A,{key:0,color:"success"},{default:t(()=>[n(e(o.$t("Client")),1)]),_:1})):(i(),c(A,{key:1,color:"error"},{default:t(()=>[n(e(o.$t("Prospect")),1)]),_:1}))])]),_:1})]),_:1})]),_:1}),l(b,{cols:"12",md:"8"},{default:t(()=>[l(I,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[l(L,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[s("h4",ve,e(o.$t("Détails de la demande")),1)]),_:1}),l(E,{class:"pa-6"},{default:t(()=>[s("p",pe,e(o.$t("Type événement :"))+" "+e(a.value.event_type||""),1),s("p",he,e(o.$t("Date de l'événement :"))+" "+e(y(S)(a.value.event_date)||""),1),s("p",_e,e(o.$t("La réception se déroulera plutôt :"))+" "+e(a.value.reception_start_time||""),1),s("p",ye,e(o.$t("Lieu de l'événement :"))+" "+e(a.value.event_location||""),1),s("p",Ve,e(o.$t("Nombre de convives :"))+" "+e(a.value.number_people||""),1),s("p",be,[n(e(o.$t("Commentaires :"))+" ",1),ge,n(" "+e(a.value.comment),1)])]),_:1})]),_:1})]),_:1}),a.value.customer&&_.value?(i(),c(b,{key:0,cols:"12"},{default:t(()=>[l(I,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[l(L,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[s("h4",xe,e(o.$t("Autre demandes de devis de"))+" "+e(a.value.customer.firstname||"")+" "+e(a.value.customer.lastname||""),1)]),_:1}),l(E,{class:"pa-6"},{default:t(()=>[l(q,{class:"month-table"},{default:t(()=>[$e,s("tbody",null,[(i(!0),j(z,null,R(_.value,u=>(i(),j("tr",{key:u.id,class:"month-item"},[s("td",null,e(u.id),1),s("td",null,[s("h6",ke,e(u.event_type),1)]),s("td",null,e(y(S)(u.demand_date)),1),s("td",null,[l(A,{rounded:"md",class:"font-weight-bold",color:y(f).statusColor(u.status),size:"small",label:""},{default:t(()=>[n(e(y(f).statusText(u.status)),1)]),_:2},1032,["color"])]),s("td",null,[l(x,{variant:"outlined",density:"compact",color:"info",to:"/demands/"+u.id},{default:t(()=>[n(e(o.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0),a.value.customer&&a.value.customer.prestations?(i(),c(b,{key:1,cols:"12"},{default:t(()=>[l(I,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[l(L,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[s("h4",we,e(o.$t("Autre prestations de devis de"))+" "+e(a.value.customer.firstname||"")+" "+e(a.value.customer.lastname||""),1)]),_:1}),l(E,{class:"pa-6"},{default:t(()=>[l(q,{class:"month-table"},{default:t(()=>[Ce,s("tbody",null,[(i(!0),j(z,null,R(a.value.customer.prestations,u=>(i(),j("tr",{key:u.id,class:"month-item"},[s("td",null,e(u.id),1),s("td",null,[s("h6",Se,e(u.demand?u.demand.event_type:""),1)]),s("td",null,e(y(S)(u.demand_date)),1),s("td",null,[l(A,{rounded:"md",class:"font-weight-bold",color:y(f).statusColor(u.status),size:"small",label:""},{default:t(()=>[n(e(y(f).statusText(u.status)),1)]),_:2},1032,["color"])]),s("td",null,[l(x,{variant:"outlined",density:"compact",color:"info",to:"/prestations/"+u.id},{default:t(()=>[n(e(o.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})):C("",!0)]),_:1}))],64))}});export{We as default};
