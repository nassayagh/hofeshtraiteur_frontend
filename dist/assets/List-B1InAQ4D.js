import{u as me}from"./hall-C7cB23wV.js";import{_ as ve,a as g}from"./BaseBreadcrumb-BTU6PUKi.js";import{r as pe}from"./validators-BPi-vT8z.js";import{a6 as fe,r as s,av as ge,aD as u,h as be,e as ce,g as Ve,q as ke,Z as H,o as K,c as X,b as l,w as t,V as b,n as M,d as m,t as i,a as k,a8 as Z,a4 as $e,ae as O,af as E,X as ye}from"./index-CM0D4_qI.js";import{F as Ce,V as Ue}from"./vee-validate.esm-Cr45sfAl.js";import{V as v,a as J}from"./VRow-B_5CRJ_N.js";import{V as Te}from"./VDataTableServer-DIHUAebQ.js";import{V as Pe,a as Se}from"./VToolbar-DKkQEUA3.js";import{V as $}from"./VTextField-BfcsYLCK.js";import{i as B}from"./VSpacer-D4AWtNAJ.js";import{V as Q}from"./VDialog-BmmbiiJ_.js";import{a as W,b as Y,V as Ne,c as ee}from"./VCard-SRqtCCz8.js";import{V as _e}from"./VContainer-DXk4of46.js";import{V as we}from"./VTextarea-XN4TRbLn.js";import{V as y}from"./VTooltip-ZU9XQWpu.js";import"./VAvatar-D1rEUekq.js";const Ie={class:"text-h5"},he={key:0,class:"mt-2"},Qe=fe({__name:"List",setup(Ae){const j=s(),x=ge(),le=s({title:"Gestions des salles"}),ae=s([{text:u("Tableau de bord"),disabled:!1,href:"/"},{text:u("Salles"),disabled:!0,href:"#"}]),f=s([]),F=me();be(()=>{L()});const C=s(!1),U=s(!1),z=s(null),D=s(100),T=s(2),w=s(2),I=s(0),G=s(!1),P=s(!1),h=s("");s(["primary","secondary","error","success","warning"]);const c=s([{key:"name",order:"ASC"}]);s(0);const S=s({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"name",order:"ASC"}]}),V=s([{id:0,label:u("Non")},{id:1,label:u("Oui")}]),te=s([{id:"salle",label:u("Géré par la salle")},{id:"client",label:u("Géré par le client")}]),A=s(-1),n=s({id:null,name:"",description:"",price:0,status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),R=s({id:null,name:"",description:"",status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),N=s(!1),oe=s([{title:"Actions",key:"actions",sortable:!1},{title:u("Nom"),align:"start",key:"name"},{title:u("Adrse"),align:"start",key:"address"},{title:u("Nom.régis"),align:"start",key:"manager_name"},{title:u("Tél.rég"),align:"start",key:"manager_phone"},{title:u("Mail.rég"),align:"start",key:"manager_email"},{title:u("Parking"),align:"start",key:"packing"},{title:u("Cuisine"),align:"start",key:"kitchen"},{title:u("Chambre"),align:"start",key:"cold_room"},{title:u("Escalier"),align:"start",key:"ladder"},{title:u("Bac"),align:"start",key:"bin"},{title:u("Frais"),align:"start",key:"transportation_fee"},{title:u("Table"),align:"start",key:"transportation_fee"},{title:u("Cmt"),align:"start",key:"comment"}]);function q(o){C.value=!1,A.value=f.value.indexOf(o),n.value=Object.assign({},o),P.value=!0}function ne(o){n.value=o,N.value=!0}function re(){P.value=!1,setTimeout(()=>{n.value=Object.assign({},R.value),A.value=-1},300)}function se(o,{setErrors:a}){var p;(p=j.value)==null||p.validate().then(({valid:_})=>{_&&(U.value=!0,F.addItem(n.value).then(e=>{if(e.data.error){a({apiError:e.data.message});return}n.value.id!=null?Object.assign(f.value[A.value],e.data):f.value.unshift(e.data),U.value=!1,C.value=!1,P.value=!1,n.value={changePassword:!0},x.showSuccess(u("Salle sauvée avec succès"))}).catch(e=>{U.value=!1,a({apiError:e})}).then(()=>{U.value=!1,a({apiError:null})}))})}function ue(){F.deleteItem(n.value.id);const o=f.value.findIndex(a=>a.id==n.value.id);f.value.splice(o,1),N.value=!1,x.showSuccess(u("Salle supprimé avec succès"))}const ie=ce(()=>A.value===-1?u("Nouvel salle"):u("Modifier la salle"));function L(){try{clearTimeout(z.value)}catch{}z.value=setTimeout(()=>{C.value=!0;let o="id",a="desc";console.log(c.value),c.value.length>0&&(o=c.value[0].key,a=c.value[0].order),F.fetchItems({term:h.value,paginate:D.value,current_page:T.value,direction:a,order_by:o,page:S.value.page,per_page:S.value.itemsPerPage}).then(p=>{if(p.data){const{data:_,current_page:e,next_page_url:d,total:r,per_page:Oe,to:Ee,last_page:de}=p.data;f.value=_,w.value=de,I.value=r}}).catch(p=>{console.error(p)}).then(()=>{C.value=!1})},1e3)}return Ve([h,S],()=>{L()},{deep:!0}),ke(()=>{T.value>w.value&&(T.value=w.value)}),(o,a)=>{const p=H("EditIcon"),_=H("TrashIcon");return K(),X(ye,null,[l(ve,{title:`${le.value.title}(${I.value})`,breadcrumbs:ae.value},null,8,["title","breadcrumbs"]),l(J,null,{default:t(()=>[l(v,{cols:"12"},{default:t(()=>[l(Te,{class:"border rounded-md",headers:oe.value,loading:C.value,items:f.value,"multi-sort":!1,"items-per-page":D.value,"onUpdate:itemsPerPage":a[19]||(a[19]=e=>D.value=e),"items-per-page-text":o.$t("Articles par page"),options:S.value,"onUpdate:options":a[20]||(a[20]=e=>S.value=e),"sort-by":c.value,"onUpdate:sortBy":a[21]||(a[21]=e=>c.value=e),page:T.value,"onUpdate:page":a[22]||(a[22]=e=>T.value=e),"items-length":I.value,"onUpdate:itemsLength":a[23]||(a[23]=e=>I.value=e),"show-select":!1,"loading-text":o.$t("Chargement des éléments"),"no-data-text":o.$t("Pas de données"),"no-results-text":o.$t("Aucun résultat"),onPageCount:a[24]||(a[24]=e=>w.value=e)},{top:t(()=>[l(Pe,{class:"rounded-t-md",flat:""},{default:t(()=>[l(Se,null,{default:t(()=>[l($,{density:"compact",modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=e=>h.value=e),placeholder:o.$t("Rechercher..."),"hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder"])]),_:1}),l(B),l(Q,{modelValue:P.value,"onUpdate:modelValue":a[16]||(a[16]=e=>P.value=e),"max-width":"750px"},{activator:t(({props:e})=>[l(b,M({color:"primary",variant:"flat",onClick:a[1]||(a[1]=d=>q=R.value),dark:""},e),{default:t(()=>[m(i(o.$t("Ajouter une salle")),1)]),_:2},1040)]),default:t(()=>[l(W,null,{default:t(()=>[l(Y,{class:"pa-4 bg-secondary"},{default:t(()=>[k("span",Ie,i(ie.value),1)]),_:1}),l(Z(Ce),{ref_key:"refForm",ref:j,modelValue:G.value,"onUpdate:modelValue":a[15]||(a[15]=e=>G.value=e),onSubmit:se},{default:t(({errors:e,isSubmitting:d})=>[l(Ne,null,{default:t(()=>[l(_e,{class:"px-0"},{default:t(()=>[l(J,null,{default:t(()=>[l(v,{cols:"12",md:"6"},{default:t(()=>[l($,{modelValue:n.value.name,"onUpdate:modelValue":a[2]||(a[2]=r=>n.value.name=r),rules:[Z(pe)],label:o.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1}),l(v,{cols:"12",md:"6"},{default:t(()=>[l($,{modelValue:n.value.address,"onUpdate:modelValue":a[3]||(a[3]=r=>n.value.address=r),label:o.$t("Adresse de la salle")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l($,{modelValue:n.value.manager_name,"onUpdate:modelValue":a[4]||(a[4]=r=>n.value.manager_name=r),label:o.$t("Nom du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l($,{modelValue:n.value.manager_phone,"onUpdate:modelValue":a[5]||(a[5]=r=>n.value.manager_phone=r),label:o.$t("Téléphone du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l($,{modelValue:n.value.manager_email,"onUpdate:modelValue":a[6]||(a[6]=r=>n.value.manager_email=r),label:o.$t("Mail du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(g,{modelValue:n.value.packing,"onUpdate:modelValue":a[7]||(a[7]=r=>n.value.packing=r),items:V.value,"item-title":"label","item-value":"id",label:o.$t("Parking"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(g,{modelValue:n.value.kitchen,"onUpdate:modelValue":a[8]||(a[8]=r=>n.value.kitchen=r),items:V.value,"item-title":"label","item-value":"id",label:o.$t("Cuisine"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(g,{modelValue:n.value.cold_room,"onUpdate:modelValue":a[9]||(a[9]=r=>n.value.cold_room=r),items:V.value,"item-title":"label","item-value":"id",label:o.$t("Chambre froidre"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(g,{modelValue:n.value.ladder,"onUpdate:modelValue":a[10]||(a[10]=r=>n.value.ladder=r),items:V.value,"item-title":"label","item-value":"id",label:o.$t("Escalier pour déchargement"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(g,{modelValue:n.value.bin,"onUpdate:modelValue":a[11]||(a[11]=r=>n.value.bin=r),items:te.value,"item-title":"label","item-value":"id",label:o.$t("Bac de poubelle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(g,{modelValue:n.value.transportation_fee,"onUpdate:modelValue":a[12]||(a[12]=r=>n.value.transportation_fee=r),items:V.value,"item-title":"label","item-value":"id",label:o.$t("Frais de déplacement à prévoir"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(g,{modelValue:n.value.table,"onUpdate:modelValue":a[13]||(a[13]=r=>n.value.table=r),items:V.value,"item-title":"label","item-value":"id",label:o.$t("Table de buffet présent dans la salle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12"},{default:t(()=>[l(we,{modelValue:n.value.comment,"onUpdate:modelValue":a[14]||(a[14]=r=>n.value.comment=r),label:o.$t("Commentaire")},null,8,["modelValue","label"])]),_:1})]),_:1}),e.apiError?(K(),X("div",he,[l(Ue,{color:"error"},{default:t(()=>[m(i(e.apiError),1)]),_:2},1024)])):$e("",!0)]),_:2},1024)]),_:2},1024),l(ee,null,{default:t(()=>[l(B),l(b,{color:"error",variant:"flat",dark:"",onClick:re},{default:t(()=>[m(i(o.$t("Annuler")),1)]),_:1}),l(b,{color:"success",variant:"flat",loading:U.value,type:"submit"},{default:t(()=>[m(i(o.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(Q,{modelValue:N.value,"onUpdate:modelValue":a[18]||(a[18]=e=>N.value=e),"max-width":"500px"},{default:t(()=>[l(W,null,{default:t(()=>[l(Y,{class:"text-h5 text-center py-6"},{default:t(()=>[m(i(o.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),l(ee,null,{default:t(()=>[l(B),l(b,{color:"error",variant:"flat",dark:"",onClick:a[17]||(a[17]=e=>N.value=!1)},{default:t(()=>[m(i(o.$t("Annuler")),1)]),_:1}),l(b,{color:"success",variant:"flat",dark:"",onClick:ue},{default:t(()=>[m(i(o.$t("OK")),1)]),_:1}),l(B)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.address":t(({item:e})=>[l(y,{text:e.address},{activator:t(({props:d})=>[k("span",O(E(d)),i(!e.address||e.address.length<10?e.address:`${e.address.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.manager_email":t(({item:e})=>[l(y,{text:e.manager_email},{activator:t(({props:d})=>[k("span",O(E(d)),i(!e.manager_email||e.manager_email.length<10?e.manager_email:`${e.manager_email.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.manager_name":t(({item:e})=>[l(y,{text:e.manager_name},{activator:t(({props:d})=>[k("span",O(E(d)),i(!e.manager_name||e.manager_name.length<10?e.manager_name:`${e.manager_name.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.packing":t(({item:e})=>[m(i(e.packing?o.$t("Oui"):o.$t("Non")),1)]),"item.kitchen":t(({item:e})=>[m(i(e.kitchen?o.$t("Oui"):o.$t("Non")),1)]),"item.cold_room":t(({item:e})=>[m(i(e.cold_room?o.$t("Oui"):o.$t("Non")),1)]),"item.ladder":t(({item:e})=>[m(i(e.ladder?o.$t("Oui"):o.$t("Non")),1)]),"item.table":t(({item:e})=>[m(i(e.table?o.$t("Oui"):o.$t("Non")),1)]),"item.transportation_fee":t(({item:e})=>[m(i(e.transportation_fee?o.$t("Oui"):o.$t("Non")),1)]),"item.bin":t(({item:e})=>[m(i(e.bin=="salle"?o.$t("Salle"):o.$t("Client")),1)]),"item.comment":t(({item:e})=>[l(y,{text:e.comment},{activator:t(({props:d})=>[k("span",O(E(d)),i(!e.comment||e.comment.length<10?e.comment:`${e.comment.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.actions":t(({item:e})=>[l(y,{text:o.$t("Modifier")},{activator:t(({props:d})=>[l(b,M({icon:"",flat:"",onClick:r=>q(e)},d),{default:t(()=>[l(p,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1032,["text"]),l(y,{text:o.$t("Supprimer")},{activator:t(({props:d})=>[l(b,M({icon:"",flat:"",onClick:r=>ne(e)},d),{default:t(()=>[l(_,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),"no-data":t(()=>[k("span",null,i(o.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64)}}});export{Qe as default};
