import{u as de}from"./payments-So3pcLUw.js";import{u as ue}from"./eventType-CjBaBygH.js";import{_ as ce}from"./BaseBreadcrumb-CyhTw0EO.js";import{a as j,f as me}from"./formatters-DFmKRZND.js";import{a6 as W,Z,o as m,_ as x,w as t,b as e,a,t as n,V as v,a8 as h,c as y,a4 as f,aJ as fe,r as o,av as he,aK as g,h as ve,e as E,g as pe,q as ge,n as _e,d as V,X as ye}from"./index-9-eZvP1X.js";import{u as we}from"./Controller-CRy-4Wld.js";import{V as p,a as L}from"./VRow-N9LjNYdG.js";import{V as P,a as w,b as be,c as Ve}from"./VCard-DtJ5rnBm.js";import{a as _}from"./VSpacer-CLyyeSLR.js";import{V as Pe}from"./VDataTableServer-BjwbJtvD.js";import{V as ke}from"./VToolbar-DsDz4GhY.js";import{V as z}from"./VTextField-BqfpXedn.js";import{b as xe}from"./VSelect-B3OP60hq.js";import{V as Q}from"./VDialog-CN1mff8n.js";import{V as $e}from"./VLocaleProvider-CTOHBxHe.js";import{V as De}from"./VDatePicker-BJFcjgyu.js";import"./VAvatar-DXXRfvu0.js";import"./filter-Cq4czTX-.js";import"./VMenu-rMPtMPH-.js";import"./VSheet-Dud5Oh-u.js";const Ce={class:"d-flex align-start"},Se={class:"text-h4"},Te={class:"ml-auto"},Be={class:"mt-2"},Ue={class:"text-h4 font-weight-regular"},Ie={key:0,class:"text-subtitle-1"},Me={class:"d-flex align-start"},Ae={class:"text-h4"},Ee={class:"ml-auto"},je={class:"mt-2"},Le={class:"text-h4 font-weight-regular"},Ne={key:0,class:"text-subtitle-1"},Re={class:"d-flex align-start"},Ke={class:"text-h4"},Oe={class:"ml-auto"},Fe={class:"mt-2"},Ge={class:"text-h4 font-weight-regular"},He={key:0,class:"text-subtitle-1"},qe={class:"d-flex align-start"},Je={class:"text-h4"},Xe={class:"ml-auto"},Ze={class:"mt-2"},ze={class:"text-h4 font-weight-regular"},Qe={key:0,class:"text-subtitle-1"},We={class:"d-flex align-start"},Ye={class:"text-h4"},et={class:"ml-auto"},tt={class:"mt-2"},at={class:"text-h4 font-weight-regular"},st={key:0,class:"text-subtitle-1"},lt={class:"d-flex align-start"},ot={class:"text-h4"},nt={class:"ml-auto"},it={class:"mt-2"},rt={class:"text-h4 font-weight-regular"},dt={key:0,class:"text-subtitle-1"},ut={class:"d-flex align-start"},ct={class:"text-h4"},mt={class:"ml-auto"},ft={class:"mt-2"},ht={class:"text-h4 font-weight-regular"},vt={key:0,class:"text-subtitle-1"},pt={class:"d-flex align-start"},gt={class:"text-h4"},_t={class:"ml-auto"},yt={class:"mt-2"},wt={class:"text-h4 font-weight-regular"},bt={key:0,class:"text-subtitle-1"},Vt=W({__name:"PrespationDashboard",props:{showDescription:{type:Boolean,default:!1},showPayments:{type:Boolean,default:!1},showValidation:{type:Boolean,default:!1},showValidated:{type:Boolean,default:!1},showProcessing:{type:Boolean,default:!1},showClosed:{type:Boolean,default:!1},showCancelled:{type:Boolean,default:!1},showTotalPayments:{type:Boolean,default:!1},md:{type:String,default:"3"}},setup(r){const c=we();return c.fetchStatistics({}),(u,O)=>{const D=Z("CurrencyEuroIcon"),k=Z("HotelServiceIcon");return r.showPayments?(m(),x(L,{key:0},{default:t(()=>[r.showTotalPayments?(m(),x(p,{key:0,class:"h-100",cols:"12",md:r.showTotalPayments?"4":"6"},{default:t(()=>[e(w,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",Ce,[a("h2",Se,n(u.$t("Montant total")),1),e(_),a("div",Te,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-info"})]),_:1})])]),a("div",Be,[a("h2",Ue,n(h(j)(h(c).statistics.totalPayments||0)),1),r.showDescription?(m(),y("span",Ie,n(u.$t("Montant total de service")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),e(p,{class:"h-100",cols:"12",md:r.showTotalPayments?"4":"6"},{default:t(()=>[e(w,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",Me,[a("h2",Ae,n(u.$t("Montant à régler")),1),e(_),a("div",Ee,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-primary"})]),_:1})])]),a("div",je,[a("h2",Le,n(h(j)(h(c).statistics.paymentsLeft||0)),1),r.showDescription?(m(),y("span",Ne,n(u.$t("Montant restant à régler")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),e(p,{class:"h-100",cols:"12",md:r.showTotalPayments?"4":"6"},{default:t(()=>[e(w,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",Re,[a("h2",Ke,n(u.$t("Montant réglé")),1),e(_),a("div",Oe,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(D,{class:"text-success"})]),_:1})])]),a("div",Fe,[a("h2",Ge,n(h(j)(h(c).statistics.paymentsReceived||0)),1),r.showDescription?(m(),y("span",He,n(u.$t("Montant total déjà réglé")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})):(m(),x(L,{key:1},{default:t(()=>[e(p,{class:"h-100",cols:"12",md:r.md},{default:t(()=>[e(w,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",qe,[a("h2",Je,n(u.$t("Prestations")),1),e(_),a("div",Xe,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-primary"})]),_:1})])]),a("div",Ze,[a("h2",ze,n(h(c).statistics.total||0),1),r.showDescription?(m(),y("span",Qe,n(u.$t("Prestations total")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),r.showValidation?(m(),x(p,{key:0,class:"h-100",cols:"12",md:r.md},{default:t(()=>[e(w,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",We,[a("h2",Ye,n(u.$t("Prestations validées")),1),e(_),a("div",et,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-success"})]),_:1})])]),a("div",tt,[a("h2",at,n(h(c).statistics.validated||0),1),r.showDescription?(m(),y("span",st,n(u.$t("Prestations total validées")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),r.showValidated?(m(),x(p,{key:1,class:"h-100",cols:"12",md:r.md},{default:t(()=>[e(w,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",lt,[a("h2",ot,n(u.$t("Prestations en validation")),1),e(_),a("div",nt,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),a("div",it,[a("h2",rt,n(h(c).statistics.validation||0),1),r.showDescription?(m(),y("span",dt,n(u.$t("Prestations total en attende de validation")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),r.showClosed?(m(),x(p,{key:2,class:"h-100",cols:"12",md:r.md},{default:t(()=>[e(w,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",ut,[a("h2",ct,n(u.$t("Prestations Clôturée")),1),e(_),a("div",mt,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),a("div",ft,[a("h2",ht,n(h(c).statistics.closed||0),1),r.showDescription?(m(),y("span",vt,n(u.$t("Prestations total Clôturée")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),r.showCancelled?(m(),x(p,{key:3,class:"h-100",cols:"12",md:r.md},{default:t(()=>[e(w,{elevation:"10",class:"bg-error h-100"},{default:t(()=>[e(P,null,{default:t(()=>[a("div",pt,[a("h2",gt,n(u.$t("Prestations annulées")),1),e(_),a("div",_t,[e(v,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-error"})]),_:1})])]),a("div",yt,[a("h2",wt,n(h(c).statistics.cancelled||0),1),r.showDescription?(m(),y("span",bt,n(u.$t("Prestations total annulées")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0)]),_:1}))}}}),Gt=W({__name:"List",setup(r){const c=fe();o();const u=he(),O=ue(),D=o({title:"Gestion des devis"}),k=o([{text:g("Dashboard"),disabled:!1,href:"/"},{text:g("Gestion des devis"),disabled:!0,href:"#"}]),T=o([]),F=o([]),N=de();ve(()=>{J(),le()});const B=o(!1);o(!1),o(!1),o(!1),o(!1),o(""),o(),o(!1);const G=o(null);o(null),o(null),o(null);const U=o(!1);o();const R=o(25),C=o(2),I=o(2),M=o(0);o(!1);const Y=o(!1);o(null);const K=o("");o(["primary","secondary","error","success","warning"]);const $=o([{key:"created_at",order:"DESC"}]);o(0);const d=o({search:null,status:null,date:null,event_type:null}),S=o({itemsPerPage:25,rowsPerPage:25,page:1,sortDesc:[!0],sortBy:[{key:"created_at",order:"DESC"}]}),ee=o(-1),H=o({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});o({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const A=o(!1),te=o([{title:g("Prénom"),align:"start",key:"prestation.customer.firstname",sortable:!1},{title:g("Nom"),align:"start",key:"prestation.customer.lastname",sortable:!1},{title:g("Email"),align:"start",key:"prestation.customer.email",sortable:!1},{title:g("Téléphone"),align:"start",key:"prestation.customer.phone",sortable:!1},{title:g("Prestation"),align:"start",key:"prestation.event_type"},{title:g("Mode de paiement"),align:"start",key:"payment_method"},{title:g("Montant payé"),align:"start",key:"amount"},{title:g("Date du paiement"),align:"start",key:"created_at"},{title:"Actions",key:"actions",sortable:!1}]),q=E(()=>d.value.date&&d.value.date.length>0?c.format(d.value.date[0],"shortDate")+" - "+c.format(d.value.date[d.value.date.length-1],"shortDate"):null);E(()=>N.payments.data.filter(i=>i.email.toLowerCase().includes(K.value.toLowerCase())));function ae(){N.deleteItem(H.value.id);const i=T.value.findIndex(s=>s.id==H.value.id);T.value.splice(i,1),A.value=!1,u.showSuccess(g("Utilisateur supprimé avec succès"))}E(()=>ee.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const se=E(()=>d.value.date&&d.value.date.length?d.value.date.length>1?[c.format(d.value.date[0],"shortDate"),c.format(d.value.date[d.value.date.length-1],"shortDate")]:[c.format(d.value.date[0],"shortDate"),c.format(d.value.date[0],"shortDate")]:null);function J(){try{clearTimeout(G.value)}catch{}G.value=setTimeout(()=>{B.value=!0;let i="id",s="desc";console.log($.value),$.value.length>0&&(i=$.value[0].key,s=$.value[0].order),N.fetchItems({term:K.value,paginate:R.value,current_page:C.value,direction:s,order_by:i,page:S.value.page,per_page:S.value.itemsPerPage,...d.value,date:se.value}).then(l=>{if(l.data){const{data:b,current_page:oe,next_page_url:ne,total:X,per_page:ie,to:Pt,last_page:re}=l.data;T.value=b,I.value=re,M.value=X}}).catch(l=>{console.error(l)}).then(()=>{B.value=!1})},1e3)}function le(){O.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(i=>{if(i.data){const{data:s,current_page:l,next_page_url:b,total:oe,per_page:ne,to:X,last_page:ie}=i.data;F.value=s}}).catch(i=>{console.error(i)}).then(()=>{B.value=!1})}return pe([K,S,d],()=>{J()},{deep:!0}),ge(()=>{C.value>I.value&&(C.value=I.value)}),(i,s)=>(m(),y(ye,null,[e(ce,{title:`${D.value.title}(${M.value})`,breadcrumbs:k.value},null,8,["title","breadcrumbs"]),e(Vt,{"show-payments":"","show-description":"","show-total-payments":""}),e(L,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[e(Pe,{class:"border rounded-md",headers:te.value,loading:B.value,items:T.value,"multi-sort":!1,"items-per-page":R.value,"onUpdate:itemsPerPage":s[10]||(s[10]=l=>R.value=l),"items-per-page-text":i.$t("Articles par page"),options:S.value,"onUpdate:options":s[11]||(s[11]=l=>S.value=l),"sort-by":$.value,"onUpdate:sortBy":s[12]||(s[12]=l=>$.value=l),page:C.value,"onUpdate:page":s[13]||(s[13]=l=>C.value=l),"items-length":M.value,"onUpdate:itemsLength":s[14]||(s[14]=l=>M.value=l),"show-select":!1,"loading-text":i.$t("Chargement des éléments"),"no-data-text":i.$t("Pas de données"),"no-results-text":i.$t("Aucun résultat"),onPageCount:s[15]||(s[15]=l=>I.value=l)},{top:t(()=>[e(ke,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:t(()=>[e(L,null,{default:t(()=>[e(p,null,{default:t(()=>[e(z,{density:"compact",modelValue:d.value.search,"onUpdate:modelValue":s[0]||(s[0]=l=>d.value.search=l),placeholder:i.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),e(p,null,{default:t(()=>[e(xe,{density:"compact",modelValue:d.value.event_type,"onUpdate:modelValue":s[1]||(s[1]=l=>d.value.event_type=l),placeholder:i.$t("Prestation"),items:F.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo"},null,8,["modelValue","placeholder","items"])]),_:1}),e(p,null,{default:t(()=>[e(Q,{ref_key:"dialog",ref:Y,modelValue:U.value,"onUpdate:modelValue":s[6]||(s[6]=l=>U.value=l),"return-value":d.value.date,"onUpdate:returnValue":s[7]||(s[7]=l=>d.value.date=l),persistent:"",width:"290px"},{activator:t(({props:l})=>[e(z,_e({modelValue:q.value,"onUpdate:modelValue":s[2]||(s[2]=b=>q.value=b),"prepend-inner-icon":"bx-calendar",readonly:""},l,{density:"compact",placeholder:i.$t("Date"),"hide-details":"",variant:"solo"}),null,16,["modelValue","placeholder"])]),default:t(({isActive:l})=>[e($e,{locale:"fr"},{default:t(()=>[e(De,{modelValue:d.value.date,"onUpdate:modelValue":s[5]||(s[5]=b=>d.value.date=b),"hide-header":"",multiple:"range"},{actions:t(()=>[e(v,{color:"primary",onClick:s[3]||(s[3]=b=>U.value=!1)},{default:t(()=>[V(n(i.$t("Annuler")),1)]),_:1}),e(_),e(v,{variant:"elevated",color:"primary",onClick:s[4]||(s[4]=b=>U.value=!1)},{default:t(()=>[V(n(i.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),e(Q,{modelValue:A.value,"onUpdate:modelValue":s[9]||(s[9]=l=>A.value=l),"max-width":"500px"},{default:t(()=>[e(w,null,{default:t(()=>[e(be,{class:"text-h5 text-center py-6"},{default:t(()=>[V(n(i.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),e(Ve,null,{default:t(()=>[e(_),e(v,{color:"error",variant:"flat",dark:"",onClick:s[8]||(s[8]=l=>A.value=!1)},{default:t(()=>[V(n(i.$t("Annuler")),1)]),_:1}),e(v,{color:"success",variant:"flat",dark:"",onClick:ae},{default:t(()=>[V(n(i.$t("OK")),1)]),_:1}),e(_)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.amount":t(({item:l})=>[V(n(h(j)(l.amount)),1)]),"item.created_at":t(({item:l})=>[V(n(h(me)(l.created_at)),1)]),"item.actions":t(({item:l})=>[e(v,{density:"compact",color:"primary",variant:"outlined",to:"/prestations/"+l.prestation_id},{default:t(()=>[V(n(i.$t("Voir la prestation liée")),1)]),_:2},1032,["to"])]),"no-data":t(()=>[a("span",null,n(i.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{Gt as default};
