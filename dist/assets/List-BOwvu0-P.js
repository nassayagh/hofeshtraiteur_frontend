import{u as se}from"./eventType-BiPypW0S.js";import{_ as re}from"./BaseBreadcrumb-SFhi0e60.js";import{r as ne}from"./validators-BPi-vT8z.js";import{a6 as ue,r as s,av as ie,aD as u,h as de,e as me,g as ve,q as fe,o as D,c as E,b as t,w as o,V as C,n as ce,d as i,t as r,a as I,a8 as N,a4 as pe,ac as O,X as ge}from"./index-BjFWTEr_.js";import{F as Ve,V as be}from"./vee-validate.esm-D2e16B8d.js";import{V as j,a as q}from"./VRow-CeV0ez7H.js";import{V as Ce}from"./VDataTableServer-DLseUT65.js";import{V as ke,a as ye}from"./VToolbar-CoawaqQ_.js";import{V as z}from"./VTextField-CWkQ8t64.js";import{i as x,a as $e}from"./VSpacer-zVSMWsYI.js";import{V as L}from"./VDialog-suZyWcBK.js";import{a as M,b as R,V as he,c as G}from"./VCard-Ds3PvDnC.js";import{V as xe}from"./VContainer-yHGJ-PEc.js";import"./VAvatar-XjD8XNVT.js";const Pe={class:"text-h5"},Te={key:0,class:"mt-2"},we=["onClick"],Ke=ue({__name:"List",setup(_e){const S=s(),F=ie(),K=s({title:"Gestions des événements"}),X=s([{text:u("Tableau de bord"),disabled:!1,href:"/"},{text:u("Événements"),disabled:!0,href:"#"}]),v=s([]),P=se();de(()=>{B()});const f=s(!1),T=s(!1),A=s(null),w=s(100),p=s(2),k=s(2),y=s(0),U=s(!1),g=s(!1),$=s("");s(["primary","secondary","error","success","warning"]);const c=s([{key:"name",order:"asc"}]);s(0);const V=s({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"name",order:"desc"}]}),h=s(-1),n=s({id:null,name:"",description:"",status:null}),H=s({id:null,name:"",description:"",status:null});function J(l){return l==0?"#13DEB9":l==1?"#FA896B":l==2?"#5D87FF":"#FFAE1F"}function Q(l){return l==0?u("Started"):l=="cancel"?u("Cancelled"):l=="completed"?u("Completed"):u("Started")}const b=s(!1),W=s([{title:"Actions",key:"actions",sortable:!1},{title:"Nom",align:"start",key:"name"}]);function _(l){f.value=!1,h.value=v.value.indexOf(l),n.value=Object.assign({},l),g.value=!0}function Y(l){n.value=l,b.value=!0}function Z(){g.value=!1,setTimeout(()=>{n.value=Object.assign({},H.value),h.value=-1},300)}function ee(l,{setErrors:a}){var e;(e=S.value)==null||e.validate().then(({valid:m})=>{m&&(T.value=!0,P.addItem(n.value).then(d=>{if(d.data.error){a({apiError:d.data.message});return}n.value.id!=null?Object.assign(v.value[h.value],d.data):v.value.unshift(d.data),f.value=!1,g.value=!1,n.value={changePassword:!0},F.showSuccess(u("Événement sauvée avec succès"))}).catch(d=>{T.value=!1,a({apiError:d})}).then(()=>{T.value=!1,a({apiError:null})}))})}function ae(){P.deleteItem(n.value.id);const l=v.value.findIndex(a=>a.id==n.value.id);v.value.splice(l,1),b.value=!1,F.showSuccess(u("Événement supprimé avec succès"))}const te=me(()=>h.value===-1?u("Nouvel événements"):u("Modifier la événements"));function B(){try{clearTimeout(A.value)}catch{}A.value=setTimeout(()=>{f.value=!0;let l="id",a="desc";console.log(c.value),c.value.length>0&&(l=c.value[0].key,a=c.value[0].order),P.fetchItems({term:$.value,paginate:w.value,current_page:p.value,direction:a,order_by:l,page:V.value.page,per_page:V.value.itemsPerPage}).then(e=>{if(e.data){const{data:m,current_page:d,next_page_url:Ie,total:le,per_page:Se,to:Fe,last_page:oe}=e.data;v.value=m,k.value=oe,y.value=le}}).catch(e=>{console.error(e)}).then(()=>{f.value=!1})},1e3)}return ve([$,V],()=>{B()},{deep:!0}),fe(()=>{p.value>k.value&&(p.value=k.value)}),(l,a)=>(D(),E(ge,null,[t(re,{title:`${K.value.title}(${y.value})`,breadcrumbs:X.value},null,8,["title","breadcrumbs"]),t(q,null,{default:o(()=>[t(j,{cols:"12"},{default:o(()=>[t(Ce,{class:"border rounded-md",headers:W.value,loading:f.value,items:v.value,"multi-sort":!1,"items-per-page":w.value,"onUpdate:itemsPerPage":a[7]||(a[7]=e=>w.value=e),"items-per-page-text":l.$t("Articles par page"),options:V.value,"onUpdate:options":a[8]||(a[8]=e=>V.value=e),"sort-by":c.value,"onUpdate:sortBy":a[9]||(a[9]=e=>c.value=e),page:p.value,"onUpdate:page":a[10]||(a[10]=e=>p.value=e),"items-length":y.value,"onUpdate:itemsLength":a[11]||(a[11]=e=>y.value=e),"show-select":!1,"loading-text":l.$t("Chargement des éléments"),"no-data-text":l.$t("Pas de données"),"no-results-text":l.$t("Aucun résultat"),onPageCount:a[12]||(a[12]=e=>k.value=e)},{top:o(()=>[t(ke,{class:"rounded-t-md",flat:""},{default:o(()=>[t(ye,null,{default:o(()=>[t(z,{density:"compact",modelValue:$.value,"onUpdate:modelValue":a[0]||(a[0]=e=>$.value=e),placeholder:l.$t("Rechercher..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),t(x),t(L,{modelValue:g.value,"onUpdate:modelValue":a[4]||(a[4]=e=>g.value=e),"max-width":"350px"},{activator:o(({props:e})=>[t(C,ce({color:"primary",variant:"flat",onClick:a[1]||(a[1]=m=>_={}),dark:""},e),{default:o(()=>[i(r(l.$t("Ajouter une événements")),1)]),_:2},1040)]),default:o(()=>[t(M,null,{default:o(()=>[t(R,{class:"pa-4 bg-secondary"},{default:o(()=>[I("span",Pe,r(te.value),1)]),_:1}),t(N(Ve),{ref_key:"refForm",ref:S,modelValue:U.value,"onUpdate:modelValue":a[3]||(a[3]=e=>U.value=e),onSubmit:ee},{default:o(({errors:e,isSubmitting:m})=>[t(he,null,{default:o(()=>[t(xe,{class:"px-0"},{default:o(()=>[t(q,null,{default:o(()=>[t(j,{cols:"12"},{default:o(()=>[t(z,{modelValue:n.value.name,"onUpdate:modelValue":a[2]||(a[2]=d=>n.value.name=d),rules:[N(ne)],label:l.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1})]),_:1}),e.apiError?(D(),E("div",Te,[t(be,{color:"error"},{default:o(()=>[i(r(e.apiError),1)]),_:2},1024)])):pe("",!0)]),_:2},1024)]),_:2},1024),t(G,null,{default:o(()=>[t(x),t(C,{color:"error",variant:"flat",dark:"",onClick:Z},{default:o(()=>[i(r(l.$t("Annuler")),1)]),_:1}),t(C,{color:"success",variant:"flat",loading:f.value,type:"submit"},{default:o(()=>[i(r(l.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),t(L,{modelValue:b.value,"onUpdate:modelValue":a[6]||(a[6]=e=>b.value=e),"max-width":"500px"},{default:o(()=>[t(M,null,{default:o(()=>[t(R,{class:"text-h5 text-center py-6"},{default:o(()=>[i(r(l.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),t(G,null,{default:o(()=>[t(x),t(C,{color:"error",variant:"flat",dark:"",onClick:a[5]||(a[5]=e=>b.value=!1)},{default:o(()=>[i(r(l.$t("Annuler")),1)]),_:1}),t(C,{color:"success",variant:"flat",dark:"",onClick:ae},{default:o(()=>[i(r(l.$t("OK")),1)]),_:1}),t(x)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.status":o(({item:e})=>[t($e,{color:J(e.status)},{default:o(()=>[i(r(Q(e.status)),1)]),_:2},1032,["color"])]),"item.name":o(({item:e})=>[I("span",{onClick:m=>_(e),class:"cursor-pointer"},r(e.name),9,we)]),"item.actions":o(({item:e})=>[t(O,{color:"info",size:"small",class:"me-2",onClick:m=>_(e)},{default:o(()=>[i(" mdi-pencil ")]),_:2},1032,["onClick"]),t(O,{color:"error",size:"small",onClick:m=>Y(e)},{default:o(()=>[i(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":o(()=>[I("span",null,r(l.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{Ke as default};
