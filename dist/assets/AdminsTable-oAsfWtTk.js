import{ai as pe,aj as x,O as ve,r,aa as fe,ae as E,h as ce,e as O,g as ge,q as Ve,E as K,o as Q,c as H,b as a,w as s,V as g,n as M,d as V,t as m,a as L,Q as T,L as he,M as be}from"./index--eSAaoua.js";import{_ as we}from"./BaseBreadcrumb-CZWnI0nK.js";import{r as q,e as ye}from"./validators-BPi-vT8z.js";import{F as Pe}from"./vee-validate.esm-U2fcPC4K.js";import{s as p}from"./sidebarItem-CN8D32jV.js";import{V as A,a as J}from"./VRow-BqVouQvo.js";import{V as ke}from"./VDataTableServer-BSZaLEkB.js";import{V as Ue,a as $e}from"./VToolbar-v-kq36CI.js";import{V as N}from"./VTextField-BIunycXo.js";import{V as I}from"./VSpacer-BLion4vj.js";import{V as W}from"./VDialog-cLqV7fjH.js";import{V as X,a as Y,c as Ce,b as Z}from"./VCard-C_EOskDD.js";import{V as xe}from"./VContainer-CBQUJw06.js";import{V as Te}from"./VAutocomplete-CsKeJI1_.js";import{V as Ae}from"./VAlert-Cer_YOfD.js";import{V as ee}from"./VTooltip-M8fBUc9R.js";/* empty css              */import"./VDataTable-BW0Rty__.js";import"./VSelect-C3ZqDHK6.js";import"./VInput-BZmnskkf.js";import"./index-DyKrsRPI.js";import"./VList-BFwTxV7r.js";import"./ssrBoot-7kARyJyG.js";import"./createSimpleFunctional-BNLeBn9G.js";import"./VAvatar-DO5dze8k.js";import"./VDivider-DAcvfAJ7.js";import"./dialog-transition-mxOinYMm.js";import"./VMenu-B-yKHGiX.js";import"./VCheckboxBtn-zj9NycWb.js";import"./VSelectionControl-CgstZIWm.js";import"./VLabel-YNF6VYNN.js";import"./VChip-BkiHneXL.js";import"./VSlideGroup-xxvn732U.js";import"./VTable-BUYeiApe.js";import"./filter-BdPhCt1f.js";/* empty css                   */import"./VField-CkYLJqxY.js";const Ie=pe({id:"Authuser",state:()=>({users:{data:[],loading:!1,error:null}}),actions:{async getAll(){this.users.loading=!0,x.get("/users").then(i=>this.users.data=i.data).catch(i=>this.users.error=i)},fetchUsers(i){return x.get("/users",{params:i})},async addUser(i){return new Promise((v,f)=>{x.post("/users",i).then(n=>v(n)).catch(n=>f(n))})},fetchUser(i){return new Promise((v,f)=>{x.get(`/users/${i}`).then(n=>v(n)).catch(n=>f(n))})},deleteUser(i){return new Promise((v,f)=>{x.delete(`/users/${i}`).then(n=>v(n)).catch(n=>f(n))})}}}),Se={class:"text-h5"},je={key:0,class:"mt-2"},_e={class:"d-flex align-center"},ba=ve({__name:"AdminsTable",setup(i){const v=r(),f=fe(),n=r({title:"Gestions des administrateurs"}),ae=r([{text:E("Dashboard"),disabled:!1,href:"/"},{text:E("Administrateurs"),disabled:!0,href:"#"}]),c=r([]),S=Ie();ce(()=>{G()});const h=r(!1),B=r(!1);r(!1),r(!1),r(!1),r(""),r(),r(!1);const z=r(null);r(null),r(null),r(null),r(!1),r();const D=r(10),y=r(2),j=r(2),F=r(0),R=r(!1),P=r(!1);r(null);const k=r("");r(["primary","secondary","error","success","warning"]);const b=r([{key:"name",order:"asc"}]);r(0);const U=r({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"name",order:"desc"}]}),_=r(-1),o=r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:"",roles:[]}),te=r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:"",roles:[]}),$=r(!1),le=r([{title:"Nom",align:"start",key:"name"},{title:"Email",key:"email"},{title:"Actions",key:"actions",sortable:!1}]);O(()=>S.users.data.filter(t=>t.email.toLowerCase().includes(k.value.toLowerCase())));const re=O(()=>{const t=[];for(let e=0;e<p.length;e++)if(p[e].children)for(let u=0;u<p[e].children.length;u++)p[e].children[u].header||t.push({...p[e].children[u],title:p[e].title+" "+p[e].children[u].title});else p[e].header||t.push(p[e]);return t});function se(t){h.value=!1,_.value=c.value.indexOf(t),o.value=Object.assign({},{...t,roles:t.roles||[]}),P.value=!0}function oe(t){o.value=t,$.value=!0}function ue(){P.value=!1,setTimeout(()=>{o.value=Object.assign({},te.value),_.value=-1},300)}function ne(t,{setErrors:e}){var u;(u=v.value)==null||u.validate().then(({valid:C})=>{C&&(B.value=!0,S.addUser(o.value).then(l=>{if(l.data.error){e({apiError:l.data.message});return}o.value.id!=null?Object.assign(c.value[_.value],l.data):c.value.unshift(l.data),h.value=!1,P.value=!1,o.value={changePassword:!0},f.showSuccess(E("Utilisateur enregistrphp artisan serveé avec succès"))}).catch(l=>{B.value=!1,e({apiError:l})}).then(()=>{B.value=!1,e({apiError:null})}))})}function ie(){S.deleteUser(o.value.id);const t=c.value.findIndex(e=>e.id==o.value.id);c.value.splice(t,1),$.value=!1,f.showSuccess(E("Utilisateur supprimé avec succès"))}const de=O(()=>_.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function G(){try{clearTimeout(z.value)}catch{}z.value=setTimeout(()=>{h.value=!0;let t="id",e="desc";console.log(b.value),b.value.length>0&&(t=b.value[0].key,e=b.value[0].order),S.fetchUsers({term:k.value,paginate:D.value,current_page:y.value,direction:e,order_by:t,page:U.value.page,per_page:U.value.itemsPerPage}).then(u=>{if(u.data){const{data:C,current_page:l,next_page_url:w,total:d,per_page:Ee,to:Ne,last_page:me}=u.data;c.value=C,j.value=me,F.value=d}}).catch(u=>{console.error(u)}).then(()=>{h.value=!1})},1e3)}return ge([k,U],()=>{G()},{deep:!0}),Ve(()=>{y.value>j.value&&(y.value=j.value)}),(t,e)=>{const u=K("PencilIcon"),C=K("TrashIcon");return Q(),H(be,null,[a(we,{title:n.value.title,breadcrumbs:ae.value},null,8,["title","breadcrumbs"]),a(J,null,{default:s(()=>[a(A,{cols:"12"},{default:s(()=>[a(ke,{class:"border rounded-md",headers:le.value,loading:h.value,items:c.value,"multi-sort":!1,"items-per-page":D.value,"onUpdate:itemsPerPage":e[11]||(e[11]=l=>D.value=l),"items-per-page-text":t.$t("Articles par page"),options:U.value,"onUpdate:options":e[12]||(e[12]=l=>U.value=l),"sort-by":b.value,"onUpdate:sortBy":e[13]||(e[13]=l=>b.value=l),page:y.value,"onUpdate:page":e[14]||(e[14]=l=>y.value=l),"items-length":F.value,"onUpdate:itemsLength":e[15]||(e[15]=l=>F.value=l),"show-select":!1,"loading-text":t.$t("Chargement des éléments"),"no-data-text":t.$t("Pas de données"),"no-results-text":t.$t("Aucun résultat"),onPageCount:e[16]||(e[16]=l=>j.value=l)},{top:s(()=>[a(Ue,{class:"rounded-t-md",flat:""},{default:s(()=>[a($e,null,{default:s(()=>[a(N,{density:"compact",modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=l=>k.value=l),placeholder:t.$t("Rechercher..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),a(I),a(W,{modelValue:P.value,"onUpdate:modelValue":e[8]||(e[8]=l=>P.value=l),"max-width":"550px"},{activator:s(({props:l})=>[a(g,M({color:"primary",variant:"flat",onClick:e[1]||(e[1]=w=>o.value={roles:[]}),dark:""},l),{default:s(()=>[V(m(t.$t("Ajouter un administrateur")),1)]),_:2},1040)]),default:s(()=>[a(X,null,{default:s(()=>[a(Y,{class:"pa-4 bg-secondary"},{default:s(()=>[L("span",Se,m(de.value),1)]),_:1}),a(T(Pe),{ref_key:"refForm",ref:v,modelValue:R.value,"onUpdate:modelValue":e[7]||(e[7]=l=>R.value=l),onSubmit:ne},{default:s(({errors:l,isSubmitting:w})=>[a(Ce,null,{default:s(()=>[a(xe,{class:"px-0"},{default:s(()=>[a(J,null,{default:s(()=>[a(A,{cols:"12"},{default:s(()=>[a(N,{modelValue:o.value.name,"onUpdate:modelValue":e[2]||(e[2]=d=>o.value.name=d),rules:[T(q)],label:t.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1}),a(A,{cols:"12"},{default:s(()=>[a(N,{modelValue:o.value.email,"onUpdate:modelValue":e[3]||(e[3]=d=>o.value.email=d),label:t.$t("Email"),rules:[T(q),T(ye)]},null,8,["modelValue","label","rules"])]),_:1}),a(A,{cols:"12"},{default:s(()=>[a(N,{modelValue:o.value.password,"onUpdate:modelValue":e[4]||(e[4]=d=>o.value.password=d),label:t.$t("Mot de passe"),placeholder:"············","append-inner-icon":o.value.id&&o.value.changePassword?"mdi-eye-off":"mdi-eye",rules:[o.value.id&&o.value.changePassword||!o.value.id?T(q):!0],readonly:!o.value.changePassword,"onClick:appendInner":e[5]||(e[5]=d=>o.value.changePassword=!o.value.changePassword)},null,8,["modelValue","label","append-inner-icon","rules","readonly"])]),_:1}),a(A,{cols:"12"},{default:s(()=>[a(Te,{modelValue:o.value.roles,"onUpdate:modelValue":e[6]||(e[6]=d=>o.value.roles=d),items:re.value,"item-value":"to","item-title":"title",multiple:"",clearable:"",variant:"outlined"},null,8,["modelValue","items"])]),_:1})]),_:1}),l.apiError?(Q(),H("div",je,[a(Ae,{color:"error"},{default:s(()=>[V(m(l.apiError),1)]),_:2},1024)])):he("",!0)]),_:2},1024)]),_:2},1024),a(Z,null,{default:s(()=>[a(I),a(g,{color:"error",variant:"flat",dark:"",onClick:ue},{default:s(()=>[V(m(t.$t("Annuler")),1)]),_:1}),a(g,{color:"success",variant:"flat",loading:h.value,type:"submit"},{default:s(()=>[V(m(t.$t("Sauvegarder")),1)]),_:1},8,["loading"]),a(I)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),a(W,{modelValue:$.value,"onUpdate:modelValue":e[10]||(e[10]=l=>$.value=l),"max-width":"500px"},{default:s(()=>[a(X,null,{default:s(()=>[a(Y,{class:"text-h5 text-center py-6"},{default:s(()=>[V(m(t.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),a(Z,null,{default:s(()=>[a(I),a(g,{color:"error",variant:"flat",dark:"",onClick:e[9]||(e[9]=l=>$.value=!1)},{default:s(()=>[V(m(t.$t("Annuler")),1)]),_:1}),a(g,{color:"success",variant:"flat",dark:"",onClick:ie},{default:s(()=>[V(m(t.$t("OK")),1)]),_:1}),a(I)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.actions":s(({item:l})=>[L("div",_e,[a(ee,{text:t.$t("Modifier")},{activator:s(({props:w})=>[a(g,M({icon:"",flat:"",onClick:d=>se(l)},w),{default:s(()=>[a(u,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1032,["text"]),a(ee,{text:t.$t("Supprimer")},{activator:s(({props:w})=>[a(g,M({icon:"",flat:"",onClick:d=>oe(l)},w),{default:s(()=>[a(C,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])])]),"no-data":s(()=>[L("span",null,m(t.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64)}}});export{ba as default};
