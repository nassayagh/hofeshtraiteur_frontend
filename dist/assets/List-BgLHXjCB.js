import{u as ne}from"./hall-7KeFGRYm.js";import{_ as se}from"./BaseBreadcrumb-CFt10_zE.js";import{r as re}from"./validators-BPi-vT8z.js";import{a6 as ie,r as s,av as de,aK as r,h as me,e as ve,g as pe,q as fe,o as G,c as q,b as l,w as o,V as P,n as be,d as i,t as d,a as z,a8 as K,a4 as ge,ac as L,X as Ve}from"./index-vMEfgJST.js";import{F as ce}from"./vee-validate.esm-BZtJnlOx.js";import{V as m,a as R}from"./VRow-DE-T_oZA.js";import{V as ke}from"./VDataTableServer-DLn-xZX9.js";import{V as $e,a as ye}from"./VToolbar-A1oXgiYp.js";import{V}from"./VTextField-DM1cH84j.js";import{V as I}from"./VSpacer-BjRNd6_i.js";import{c as H,b as f}from"./VDialog-Byhq3zUz.js";import{V as X,b as J,a as Ce,c as Q}from"./VCard-CPkSy5kN.js";import{V as Ue}from"./VContainer-DfzSaaH7.js";import{V as Pe}from"./VTextarea-ZVeimCZ7.js";import{V as Te}from"./VAlert-DSb4bQl7.js";import"./VTable-DeYGWRVD.js";import"./filter-VsER4BpE.js";import"./VMenu-DjNVpjwh.js";import"./index-BIvFu00j.js";import"./VAvatar-BLwi9Kbr.js";import"./VChip-DFvAWgfR.js";const Ne={class:"text-h5"},Se={key:0,class:"mt-2"},xe=ie({__name:"List",setup(we){const B=s(),E=de(),W=s({title:"Gestions des salles"}),Y=s([{text:r("Tableau de bord"),disabled:!1,href:"/"},{text:r("Salles"),disabled:!0,href:"#"}]),v=s([]),O=ne();me(()=>{M()});const c=s(!1),k=s(!1),F=s(null),A=s(10),$=s(2),T=s(2),N=s(0),h=s(!1),y=s(!1),S=s("");s(["primary","secondary","error","success","warning"]);const b=s([{key:"id",order:"DESC"}]);s(0);const C=s({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"id",order:"desc"}]}),g=s([{id:0,label:r("Non")},{id:1,label:r("Oui")}]),Z=s([{id:"salle",label:r("Géré par la salle")},{id:"client",label:r("Géré par le client")}]),w=s(-1),u=s({id:null,name:"",description:"",price:0,status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),D=s({id:null,name:"",description:"",status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),U=s(!1),_=s([{title:"ID",align:"start",key:"id"},{title:r("Nom"),align:"start",key:"name"},{title:r("Adresse de la salle"),align:"start",key:"address"},{title:r("Nom du régisseur"),align:"start",key:"manager_name"},{title:r("Téléphone du régisseur"),align:"start",key:"manager_phone"},{title:r("Mail du régisseur"),align:"start",key:"manager_email"},{title:r("Parking"),align:"start",key:"packing"},{title:r("Cuisine"),align:"start",key:"kitchen"},{title:r("Chambre froidre"),align:"start",key:"cold_room"},{title:r("Escalier"),align:"start",key:"ladder"},{title:r("Bac de poubelle"),align:"start",key:"bin"},{title:r("Frais de déplacement"),align:"start",key:"transportation_fee"},{title:r("Table de buffet"),align:"start",key:"transportation_fee"},{title:r("Commentaire"),align:"start",key:"comment"},{title:"Actions",key:"actions",sortable:!1}]);function j(a){c.value=!1,w.value=v.value.indexOf(a),u.value=Object.assign({},a),y.value=!0}function x(a){u.value=a,U.value=!0}function ee(){y.value=!1,setTimeout(()=>{u.value=Object.assign({},D.value),w.value=-1},300)}function le(a,{setErrors:e}){var t;(t=B.value)==null||t.validate().then(({valid:p})=>{p&&(k.value=!0,O.addItem(u.value).then(n=>{if(n.data.error){e({apiError:n.data.message});return}u.value.id!=null?Object.assign(v.value[w.value],n.data):v.value.unshift(n.data),k.value=!1,c.value=!1,y.value=!1,u.value={changePassword:!0},E.showSuccess(r("Salle sauvée avec succès"))}).catch(n=>{k.value=!1,e({apiError:n})}).then(()=>{k.value=!1,e({apiError:null})}))})}function ae(){O.deleteItem(u.value.id);const a=v.value.findIndex(e=>e.id==u.value.id);v.value.splice(a,1),U.value=!1,E.showSuccess(r("Salle supprimé avec succès"))}const te=ve(()=>w.value===-1?r("Nouvel salle"):r("Modifier la salle"));function M(){try{clearTimeout(F.value)}catch{}F.value=setTimeout(()=>{c.value=!0;let a="id",e="desc";console.log(b.value),b.value.length>0&&(a=b.value[0].key,e=b.value[0].order),O.fetchItems({term:S.value,paginate:A.value,current_page:$.value,direction:e,order_by:a,page:C.value.page,per_page:C.value.itemsPerPage}).then(t=>{if(t.data){const{data:p,current_page:n,next_page_url:Ie,total:oe,per_page:Oe,to:Ae,last_page:ue}=t.data;v.value=p,T.value=ue,N.value=oe}}).catch(t=>{console.error(t)}).then(()=>{c.value=!1})},1e3)}return pe([S,C],()=>{M()},{deep:!0}),fe(()=>{$.value>T.value&&($.value=T.value)}),(a,e)=>(G(),q(Ve,null,[l(se,{title:`${W.value.title}(${N.value})`,breadcrumbs:Y.value},null,8,["title","breadcrumbs"]),l(R,null,{default:o(()=>[l(m,{cols:"12"},{default:o(()=>[l(ke,{class:"border rounded-md",headers:_.value,loading:c.value,items:v.value,"multi-sort":!1,"items-per-page":A.value,"onUpdate:itemsPerPage":e[19]||(e[19]=t=>A.value=t),"items-per-page-text":a.$t("Articles par page"),options:C.value,"onUpdate:options":e[20]||(e[20]=t=>C.value=t),"sort-by":b.value,"onUpdate:sortBy":e[21]||(e[21]=t=>b.value=t),page:$.value,"onUpdate:page":e[22]||(e[22]=t=>$.value=t),"items-length":N.value,"onUpdate:itemsLength":e[23]||(e[23]=t=>N.value=t),"show-select":!1,"loading-text":a.$t("Chargement des éléments"),"no-data-text":a.$t("Pas de données"),"no-results-text":a.$t("Aucun résultat"),onPageCount:e[24]||(e[24]=t=>T.value=t)},{top:o(()=>[l($e,{class:"rounded-t-md",flat:""},{default:o(()=>[l(ye,null,{default:o(()=>[l(V,{density:"compact",modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=t=>S.value=t),placeholder:a.$t("Rechercher..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),l(I),l(H,{modelValue:y.value,"onUpdate:modelValue":e[16]||(e[16]=t=>y.value=t),"max-width":"750px"},{activator:o(({props:t})=>[l(P,be({color:"primary",variant:"flat",onClick:e[1]||(e[1]=p=>j=D.value),dark:""},t),{default:o(()=>[i(d(a.$t("Ajouter une salle")),1)]),_:2},1040)]),default:o(()=>[l(X,null,{default:o(()=>[l(J,{class:"pa-4 bg-secondary"},{default:o(()=>[z("span",Ne,d(te.value),1)]),_:1}),l(K(ce),{ref_key:"refForm",ref:B,modelValue:h.value,"onUpdate:modelValue":e[15]||(e[15]=t=>h.value=t),onSubmit:le},{default:o(({errors:t,isSubmitting:p})=>[l(Ce,null,{default:o(()=>[l(Ue,{class:"px-0"},{default:o(()=>[l(R,null,{default:o(()=>[l(m,{cols:"12",md:"6"},{default:o(()=>[l(V,{modelValue:u.value.name,"onUpdate:modelValue":e[2]||(e[2]=n=>u.value.name=n),rules:[K(re)],label:a.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1}),l(m,{cols:"12",md:"6"},{default:o(()=>[l(V,{modelValue:u.value.address,"onUpdate:modelValue":e[3]||(e[3]=n=>u.value.address=n),label:a.$t("Adresse de la salle")},null,8,["modelValue","label"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(V,{modelValue:u.value.manager_name,"onUpdate:modelValue":e[4]||(e[4]=n=>u.value.manager_name=n),label:a.$t("Nom du régisseur")},null,8,["modelValue","label"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(V,{modelValue:u.value.manager_phone,"onUpdate:modelValue":e[5]||(e[5]=n=>u.value.manager_phone=n),label:a.$t("Téléphone du régisseur")},null,8,["modelValue","label"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(V,{modelValue:u.value.manager_email,"onUpdate:modelValue":e[6]||(e[6]=n=>u.value.manager_email=n),label:a.$t("Mail du régisseur")},null,8,["modelValue","label"])]),_:1}),l(m,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.packing,"onUpdate:modelValue":e[7]||(e[7]=n=>u.value.packing=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Parking"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(m,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.kitchen,"onUpdate:modelValue":e[8]||(e[8]=n=>u.value.kitchen=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Cuisine"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(m,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.cold_room,"onUpdate:modelValue":e[9]||(e[9]=n=>u.value.cold_room=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Chambre froidre"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(m,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.ladder,"onUpdate:modelValue":e[10]||(e[10]=n=>u.value.ladder=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Escalier pour déchargement"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(f,{modelValue:u.value.bin,"onUpdate:modelValue":e[11]||(e[11]=n=>u.value.bin=n),items:Z.value,"item-title":"label","item-value":"id",label:a.$t("Bac de poubelle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(f,{modelValue:u.value.transportation_fee,"onUpdate:modelValue":e[12]||(e[12]=n=>u.value.transportation_fee=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Frais de déplacement à prévoir"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(m,{cols:"12",md:"4"},{default:o(()=>[l(f,{modelValue:u.value.table,"onUpdate:modelValue":e[13]||(e[13]=n=>u.value.table=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Table de buffet présent dans la salle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(m,{cols:"12"},{default:o(()=>[l(Pe,{modelValue:u.value.comment,"onUpdate:modelValue":e[14]||(e[14]=n=>u.value.comment=n),label:a.$t("Commentaire")},null,8,["modelValue","label"])]),_:1})]),_:1}),t.apiError?(G(),q("div",Se,[l(Te,{color:"error"},{default:o(()=>[i(d(t.apiError),1)]),_:2},1024)])):ge("",!0)]),_:2},1024)]),_:2},1024),l(Q,null,{default:o(()=>[l(I),l(P,{color:"error",variant:"flat",dark:"",onClick:ee},{default:o(()=>[i(d(a.$t("Annuler")),1)]),_:1}),l(P,{color:"success",variant:"flat",loading:k.value,type:"submit"},{default:o(()=>[i(d(a.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(H,{modelValue:U.value,"onUpdate:modelValue":e[18]||(e[18]=t=>U.value=t),"max-width":"500px"},{default:o(()=>[l(X,null,{default:o(()=>[l(J,{class:"text-h5 text-center py-6"},{default:o(()=>[i(d(a.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),l(Q,null,{default:o(()=>[l(I),l(P,{color:"error",variant:"flat",dark:"",onClick:e[17]||(e[17]=t=>U.value=!1)},{default:o(()=>[i(d(a.$t("Annuler")),1)]),_:1}),l(P,{color:"success",variant:"flat",dark:"",onClick:ae},{default:o(()=>[i(d(a.$t("OK")),1)]),_:1}),l(I)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.packing":o(({item:t})=>[i(d(t.packing?a.$t("Oui"):a.$t("Non")),1)]),"item.kitchen":o(({item:t})=>[i(d(t.kitchen?a.$t("Oui"):a.$t("Non")),1)]),"item.cold_room":o(({item:t})=>[i(d(t.cold_room?a.$t("Oui"):a.$t("Non")),1)]),"item.ladder":o(({item:t})=>[i(d(t.ladder?a.$t("Oui"):a.$t("Non")),1)]),"item.table":o(({item:t})=>[i(d(t.table?a.$t("Oui"):a.$t("Non")),1)]),"item.transportation_fee":o(({item:t})=>[i(d(t.transportation_fee?a.$t("Oui"):a.$t("Non")),1)]),"item.bin":o(({item:t})=>[i(d(t.bin=="salle"?a.$t("Salle"):a.$t("Client")),1)]),"item.actions":o(({item:t})=>[l(L,{color:"info",size:"small",class:"me-2",onClick:p=>j(t)},{default:o(()=>[i(" mdi-pencil ")]),_:2},1032,["onClick"]),l(L,{color:"error",size:"small",onClick:p=>x(t)},{default:o(()=>[i(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":o(()=>[z("span",null,d(a.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{xe as default};
