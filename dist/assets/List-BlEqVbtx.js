import{u as pe}from"./payments-DzBUjvze.js";import{u as ve}from"./eventType-DjGqDcem.js";import{u as ge}from"./paymentMethod-Dy_iZ_N_.js";import{_ as _e}from"./BaseBreadcrumb-D1qOTCVJ.js";import{f as j,a as ye}from"./formatters-ChhyeSK0.js";import{a6 as oe,Z as F,o as m,_ as x,w as t,b as e,a as s,t as i,V as p,a8 as f,c as w,a4 as h,aJ as we,r as l,av as be,aK as _,aL as Ve,h as Pe,e as L,g as ke,q as xe,n as te,d as $,X as $e}from"./index-h10VwvxX.js";import{u as De}from"./Controller-BxXGpcEM.js";import{V as v,a as N}from"./VRow-BgUR1jT6.js";import{V as P,a as b,b as Ce,c as Se}from"./VCard-H_mlGdt1.js";import{a as y}from"./VSpacer-F9kYomq2.js";import{V as Te}from"./VDataTableServer-DdvL5mqf.js";import{V as Be}from"./VToolbar-BkDZSntF.js";import{V as ae}from"./VTextField-D8dBTZbl.js";import{b as se}from"./VSelect-gfH_aH7y.js";import{V as le}from"./VDialog-D7uODJgv.js";import{V as Ie}from"./VLocaleProvider-FIH8L2Ey.js";import{V as Me}from"./VDatePicker-aPSbzZcX.js";import{V as Ue}from"./VTooltip-B4o_zCxu.js";import"./VAvatar-DoqaIa0V.js";import"./filter-f_vm2mpL.js";import"./VMenu-y3tC03OP.js";import"./VSheet-CKRhl9Ap.js";const Ee={class:"d-flex align-start"},Ae={class:"text-h4"},Le={class:"ml-auto"},je={class:"mt-2"},Ne={class:"text-h4 font-weight-regular"},Re={key:0,class:"text-subtitle-1"},qe={class:"d-flex align-start"},Ke={class:"text-h4"},Oe={class:"ml-auto"},Fe={class:"mt-2"},Ge={class:"text-h4 font-weight-regular"},He={key:0,class:"text-subtitle-1"},ze={class:"d-flex align-start"},Je={class:"text-h4"},Xe={class:"ml-auto"},Ze={class:"mt-2"},Qe={class:"text-h4 font-weight-regular"},We={key:0,class:"text-subtitle-1"},Ye={class:"d-flex align-start"},et={class:"text-h4"},tt={class:"ml-auto"},at={class:"mt-2"},st={class:"text-h4 font-weight-regular"},lt={key:0,class:"text-subtitle-1"},ot={class:"d-flex align-start"},nt={class:"text-h4"},it={class:"ml-auto"},rt={class:"mt-2"},dt={class:"text-h4 font-weight-regular"},ut={key:0,class:"text-subtitle-1"},ct={class:"d-flex align-start"},mt={class:"text-h4"},ht={class:"ml-auto"},ft={class:"mt-2"},pt={class:"text-h4 font-weight-regular"},vt={key:0,class:"text-subtitle-1"},gt={class:"d-flex align-start"},_t={class:"text-h4"},yt={class:"ml-auto"},wt={class:"mt-2"},bt={class:"text-h4 font-weight-regular"},Vt={key:0,class:"text-subtitle-1"},Pt={class:"d-flex align-start"},kt={class:"text-h4"},xt={class:"ml-auto"},$t={class:"mt-2"},Dt={class:"text-h4 font-weight-regular"},Ct={key:0,class:"text-subtitle-1"},St=oe({__name:"PrespationDashboard",props:{showDescription:{type:Boolean,default:!1},showPayments:{type:Boolean,default:!1},showValidation:{type:Boolean,default:!1},showValidated:{type:Boolean,default:!1},showProcessing:{type:Boolean,default:!1},showClosed:{type:Boolean,default:!1},showCancelled:{type:Boolean,default:!1},showTotalPayments:{type:Boolean,default:!1},md:{type:String,default:"3"}},setup(d){const c=De();return c.fetchStatistics({}),(u,G)=>{const C=F("CurrencyEuroIcon"),k=F("HotelServiceIcon");return d.showPayments?(m(),x(N,{key:0},{default:t(()=>[d.showTotalPayments?(m(),x(v,{key:0,class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Ee,[s("h2",Ae,i(u.$t("Montant total")),1),e(y),s("div",Le,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(C,{class:"text-info"})]),_:1})])]),s("div",je,[s("h2",Ne,i(f(j)(f(c).statistics.totalPayments||0)),1),d.showDescription?(m(),w("span",Re,i(u.$t("Montant total de service")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):h("",!0),e(v,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",qe,[s("h2",Ke,i(u.$t("Montant à régler")),1),e(y),s("div",Oe,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(C,{class:"text-primary"})]),_:1})])]),s("div",Fe,[s("h2",Ge,i(f(j)(f(c).statistics.paymentsLeft||0)),1),d.showDescription?(m(),w("span",He,i(u.$t("Montant restant à régler")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),e(v,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",ze,[s("h2",Je,i(u.$t("Montant réglé")),1),e(y),s("div",Xe,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(C,{class:"text-success"})]),_:1})])]),s("div",Ze,[s("h2",Qe,i(f(j)(f(c).statistics.paymentsReceived||0)),1),d.showDescription?(m(),w("span",We,i(u.$t("Montant total déjà réglé")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})):(m(),x(N,{key:1},{default:t(()=>[e(v,{class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Ye,[s("h2",et,i(u.$t("Prestations")),1),e(y),s("div",tt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-primary"})]),_:1})])]),s("div",at,[s("h2",st,i(f(c).statistics.total||0),1),d.showDescription?(m(),w("span",lt,i(u.$t("Prestations total")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),d.showValidation?(m(),x(v,{key:0,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",ot,[s("h2",nt,i(u.$t("Prestations validées")),1),e(y),s("div",it,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-success"})]),_:1})])]),s("div",rt,[s("h2",dt,i(f(c).statistics.validated||0),1),d.showDescription?(m(),w("span",ut,i(u.$t("Prestations total validées")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):h("",!0),d.showValidated?(m(),x(v,{key:1,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",ct,[s("h2",mt,i(u.$t("Prestations en validation")),1),e(y),s("div",ht,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",ft,[s("h2",pt,i(f(c).statistics.validation||0),1),d.showDescription?(m(),w("span",vt,i(u.$t("Prestations total en attende de validation")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):h("",!0),d.showClosed?(m(),x(v,{key:2,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",gt,[s("h2",_t,i(u.$t("Prestations Clôturée")),1),e(y),s("div",yt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",wt,[s("h2",bt,i(f(c).statistics.closed||0),1),d.showDescription?(m(),w("span",Vt,i(u.$t("Prestations total Clôturée")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):h("",!0),d.showCancelled?(m(),x(v,{key:3,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-error h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Pt,[s("h2",kt,i(u.$t("Prestations annulées")),1),e(y),s("div",xt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-error"})]),_:1})])]),s("div",$t,[s("h2",Dt,i(f(c).statistics.cancelled||0),1),d.showDescription?(m(),w("span",Ct,i(u.$t("Prestations total annulées")),1)):h("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):h("",!0)]),_:1}))}}}),Tt={class:"d-flex align-center"},ea=oe({__name:"List",setup(d){const c=we();l();const u=be(),G=ve(),C=ge(),k=l({title:"Gestion des paiements"}),ne=l([{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Gestion des paiements"),disabled:!0,href:"#"}]),I=l([]),H=l([]),z=l([]),R=pe(),J=Ve();Pe(()=>{J.query.method&&(r.value.payment_method=[J.query.method]),W(),me(),he()});const S=l(!1);l(!1),l(!1),l(!1),l(!1),l(""),l(),l(!1);const X=l(null);l(null),l(null),l(null);const M=l(!1);l();const q=l(100),T=l(2),U=l(2),E=l(0);l(!1);const ie=l(!1);l(null);const K=l("");l(["primary","secondary","error","success","warning"]);const D=l([{key:"payment_date",order:"DESC"}]);l(0);const r=l({search:null,status:null,date:null,event_type:null}),B=l({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"payment_date",order:"DESC"}]}),re=l(-1),Z=l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const A=l(!1),de=l([{title:_("Prénom"),align:"start",key:"prestation.customer.firstname",sortable:!1},{title:_("Nom"),align:"start",key:"prestation.customer.lastname",sortable:!1},{title:_("Email"),align:"start",key:"prestation.customer.email",sortable:!1},{title:_("Téléphone"),align:"start",key:"prestation.customer.phone",sortable:!1},{title:_("Prestation"),align:"start",key:"prestation.event_type"},{title:_("Mode de paiement"),align:"start",key:"payment_method"},{title:_("Montant payé"),align:"start",key:"amount"},{title:_("Date du paiement"),align:"start",key:"payment_date"},{title:"Actions",key:"actions",sortable:!1}]),Q=L(()=>r.value.date&&r.value.date.length>0?c.format(r.value.date[0],"shortDate")+" - "+c.format(r.value.date[r.value.date.length-1],"shortDate"):null);L(()=>R.payments.data.filter(n=>n.email.toLowerCase().includes(K.value.toLowerCase())));function ue(){R.deleteItem(Z.value.id);const n=I.value.findIndex(a=>a.id==Z.value.id);I.value.splice(n,1),A.value=!1,u.showSuccess(_("Utilisateur supprimé avec succès"))}L(()=>re.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const ce=L(()=>r.value.date&&r.value.date.length?r.value.date.length>1?[c.format(r.value.date[0],"shortDate"),c.format(r.value.date[r.value.date.length-1],"shortDate")]:[c.format(r.value.date[0],"shortDate"),c.format(r.value.date[0],"shortDate")]:null);function W(){try{clearTimeout(X.value)}catch{}X.value=setTimeout(()=>{S.value=!0;let n="id",a="desc";console.log(D.value),D.value.length>0&&(n=D.value[0].key,a=D.value[0].order),R.fetchItems({term:K.value,paginate:q.value,current_page:T.value,direction:a,order_by:n,page:B.value.page,per_page:B.value.itemsPerPage,...r.value,date:ce.value}).then(V=>{if(V.data){const{data:o,current_page:g,next_page_url:Y,total:O,per_page:ee,to:Bt,last_page:fe}=V.data;I.value=o,U.value=fe,E.value=O}}).catch(V=>{console.error(V)}).then(()=>{S.value=!1})},1e3)}function me(){G.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:o,total:g,per_page:Y,to:O,last_page:ee}=n.data;H.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}function he(){C.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:o,total:g,per_page:Y,to:O,last_page:ee}=n.data;z.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}return ke([K,B,r],()=>{W()},{deep:!0}),xe(()=>{T.value>U.value&&(T.value=U.value)}),(n,a)=>{const V=F("EyeIcon");return m(),w($e,null,[e(_e,{title:`${k.value.title}(${E.value})`,breadcrumbs:ne.value},null,8,["title","breadcrumbs"]),e(St,{"show-payments":"","show-description":"","show-total-payments":""}),e(N,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(Te,{class:"border rounded-md",headers:de.value,loading:S.value,items:I.value,"multi-sort":!1,"items-per-page":q.value,"onUpdate:itemsPerPage":a[12]||(a[12]=o=>q.value=o),"items-per-page-text":n.$t("Articles par page"),options:B.value,"onUpdate:options":a[13]||(a[13]=o=>B.value=o),"sort-by":D.value,"onUpdate:sortBy":a[14]||(a[14]=o=>D.value=o),page:T.value,"onUpdate:page":a[15]||(a[15]=o=>T.value=o),"items-length":E.value,"onUpdate:itemsLength":a[16]||(a[16]=o=>E.value=o),"show-select":!1,"loading-text":n.$t("Chargement des éléments"),"no-data-text":n.$t("Pas de données"),"no-results-text":n.$t("Aucun résultat"),onPageCount:a[17]||(a[17]=o=>U.value=o)},{top:t(()=>[e(Be,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:t(()=>[e(N,null,{default:t(()=>[e(v,null,{default:t(()=>[e(ae,{density:"compact",modelValue:r.value.search,"onUpdate:modelValue":a[0]||(a[0]=o=>r.value.search=o),placeholder:n.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),e(v,null,{default:t(()=>[e(se,{density:"compact",modelValue:r.value.event_type,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value.event_type=o),placeholder:n.$t("Prestation"),items:H.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(v,null,{default:t(()=>[e(se,{density:"compact",modelValue:r.value.payment_method,"onUpdate:modelValue":a[2]||(a[2]=o=>r.value.payment_method=o),placeholder:n.$t("Mode de paiement"),items:z.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(v,null,{default:t(()=>[e(le,{ref_key:"dialog",ref:ie,modelValue:M.value,"onUpdate:modelValue":a[8]||(a[8]=o=>M.value=o),"return-value":r.value.date,"onUpdate:returnValue":a[9]||(a[9]=o=>r.value.date=o),persistent:"",width:"290px"},{activator:t(({props:o})=>[e(ae,te({modelValue:Q.value,"onUpdate:modelValue":a[3]||(a[3]=g=>Q.value=g),"prepend-inner-icon":"bx-calendar",readonly:""},o,{density:"compact",placeholder:n.$t("Date"),"hide-details":"",variant:"solo",clearable:"","onClick:clear":a[4]||(a[4]=g=>r.value.date=null)}),null,16,["modelValue","placeholder"])]),default:t(({isActive:o})=>[e(Ie,{locale:"fr"},{default:t(()=>[e(Me,{modelValue:r.value.date,"onUpdate:modelValue":a[7]||(a[7]=g=>r.value.date=g),"hide-header":"",multiple:"range"},{actions:t(()=>[e(p,{color:"primary",onClick:a[5]||(a[5]=g=>M.value=!1)},{default:t(()=>[$(i(n.$t("Annuler")),1)]),_:1}),e(y),e(p,{variant:"elevated",color:"primary",onClick:a[6]||(a[6]=g=>M.value=!1)},{default:t(()=>[$(i(n.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),e(le,{modelValue:A.value,"onUpdate:modelValue":a[11]||(a[11]=o=>A.value=o),"max-width":"500px"},{default:t(()=>[e(b,null,{default:t(()=>[e(Ce,{class:"text-h5 text-center py-6"},{default:t(()=>[$(i(n.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),e(Se,null,{default:t(()=>[e(y),e(p,{color:"error",variant:"flat",dark:"",onClick:a[10]||(a[10]=o=>A.value=!1)},{default:t(()=>[$(i(n.$t("Annuler")),1)]),_:1}),e(p,{color:"success",variant:"flat",dark:"",onClick:ue},{default:t(()=>[$(i(n.$t("OK")),1)]),_:1}),e(y)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.amount":t(({item:o})=>[$(i(f(j)(o.amount)),1)]),"item.payment_date":t(({item:o})=>[$(i(f(ye)(o.payment_date)),1)]),"item.actions":t(({item:o})=>[s("div",Tt,[e(Ue,{text:n.$t("Voir la prestation liée")},{activator:t(({props:g})=>[e(p,te({icon:"",flat:"",to:"/prestations/"+o.prestation_id},g),{default:t(()=>[e(V,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["to"])]),_:2},1032,["text"])])]),"no-data":t(()=>[s("span",null,i(n.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64)}}});export{ea as default};
