import{u as B}from"./Controller-BClcbkec.js";import{a6 as F,e as U,o as h,_ as C,w as t,b as e,a as o,t as a,a8 as f,d as _,a4 as M,c as L,av as z,r as i,aD as P,n as Q,V as w,h as ie,Z as K,aE as me,g as ce,aF as ve,X as ee,a5 as se}from"./index-qrr1DAJJ.js";import{_ as pe,V as oe}from"./BaseBreadcrumb-DALnWbhU.js";import{a as q,f as N}from"./formatters-DCCWVJxZ.js";import{d as te,V as A,a as T,b as W,c as X}from"./VCard-CxTcpius.js";import{f as O}from"./VMenu-B5A0bEHj.js";import{a as E,V as k}from"./VRow-CQyRA3pe.js";import{V as le}from"./VTextarea-CuMWUVD_.js";import{V as ae,a as D}from"./VSpacer-tw-DC6ch.js";import{V as Z}from"./VDialog-CRQCz79p.js";import{u as fe}from"./service-BBUALsj0.js";import{V as _e}from"./VAutocomplete-CiWjyYKR.js";import{V as ne}from"./VTextField-C0CgDO9d.js";import{a as Ve,_ as ue}from"./PaymentForm.vue_vue_type_script_setup_true_lang-B_Eoi-Nj.js";import{_ as he}from"./HallWidget.vue_vue_type_script_setup_true_lang-2Gd2ebcC.js";import{V as re}from"./VTooltip-BDi6ZtNQ.js";import"./VAvatar-yP-BgKpL.js";import"./filter-D9aFNwMX.js";import"./paymentMethod-D4e70dbT.js";import"./VLocaleProvider-B0asxUN5.js";import"./VDatePicker-IBfduAgM.js";import"./VSheet-oPSJDQk_.js";import"./ChangeHall.vue_vue_type_script_setup_true_lang-CRyW272L.js";import"./hall-cxke1gTv.js";import"./VAlert-CT_1jegC.js";const ye={class:"text-h6"},$e={class:"text-subtitle-1 textSecondary mt-3"},ge={class:"text-subtitle-1 textSecondary mt-3"},be={class:"text-subtitle-1 textSecondary mt-3"},ke={class:"text-subtitle-1 textSecondary mt-3"},Ce={class:"text-subtitle-1 textSecondary mt-3"},Se={class:"text-subtitle-1 textSecondary mt-3"},we={class:"text-subtitle-1 textSecondary mt-3"},xe={class:"text-subtitle-1 textSecondary mt-3"},je={class:"text-subtitle-1 textSecondary mt-3"},Pe={class:"text-subtitle-1 textSecondary mt-3"},Ue={class:"text-subtitle-1 textSecondary mt-3"},De={class:"text-subtitle-1 textSecondary mt-3"},Ie={class:"text-subtitle-1 textSecondary mt-3"},Ae={class:"text-subtitle-1 textSecondary mt-3"},Te={key:0,class:"text-subtitle-1 textSecondary mt-3"},Me=F({__name:"CustomerWidget",props:{modelValue:Object,showDemandInfo:Boolean,source:{type:String,default:"SITE"}},emits:["update:modelValue"],setup(j,{emit:l}){const p=B(),S=j,x=l,v=U({get:()=>S.modelValue,set:r=>x("update:modelValue",r)});return(r,n)=>(h(),C(T,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(te,{class:"py-4 px-6 text-white bg-primary"},{default:t(()=>[o("h4",ye,a(r.$t("Identification du demandeur")),1)]),_:1}),e(A,{class:"pl-6 pr-6"},{default:t(()=>[o("p",$e,a(r.$t("Prénom :"))+" "+a(v.value.customer.firstname||""),1),o("p",ge,a(r.$t("Nom :"))+" "+a(v.value.customer.lastname||""),1),o("p",be,a(r.$t("Email :"))+" "+a(v.value.customer.email||""),1),o("p",ke,a(r.$t("Téléphone :"))+" "+a(v.value.customer.phone||""),1),o("p",Ce,a(r.$t("Date d'enregistrement :"))+" "+a(f(q)(v.value.customer.created_at)||""),1),o("p",Se,[_(a(r.$t("Type :"))+" ",1),v.value.customer&&v.value.customer.is_customer?(h(),C(ae,{key:0,color:"success"},{default:t(()=>[_(a(r.$t("Client")),1)]),_:1})):(h(),C(ae,{key:1,color:"error"},{default:t(()=>[_(a(r.$t("Prospect")),1)]),_:1}))])]),_:1}),j.showDemandInfo?(h(),C(A,{key:0,class:"pt-0 pb-0"},{default:t(()=>[e(O)]),_:1})):M("",!0),j.showDemandInfo?(h(),C(A,{key:1,class:"pl-6 pr-6"},{default:t(()=>[o("p",we,a(r.$t("Source :"))+" "+a(S.source||""),1),o("p",xe,a(r.$t("Type événement :"))+" "+a(v.value.event_type||""),1),o("p",je,a(r.$t("Date de la demande :"))+" "+a(f(q)(v.value.demand_date)||""),1),o("p",Pe,a(r.$t("Date création de la prestation :"))+" "+a(f(q)(v.value.created_at)||""),1),o("p",Ue,a(r.$t("La réception se déroulera plutôt :"))+" "+a(v.value.reception_period||""),1),o("p",De,a(r.$t("Heure de réception :"))+" "+a(v.value.reception_start_time||""),1),o("p",Ie,a(r.$t("Lieu de l'événement :"))+" "+a(v.value.event_location||""),1),o("p",Ae,a(r.$t("Nombre de convives :"))+" "+a(v.value.number_people||""),1),v.value.status>=f(p).statuses.closed?(h(),L("p",Te,a(r.$t("Date clôture de la prestation :"))+" "+a(f(q)(v.value.closed_date)||""),1)):M("",!0)]),_:1})):M("",!0)]),_:1}))}}),Ee=F({__name:"CancelPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=B(),S=z(),x=j,v=l,r=U({get:()=>x.modelValue,set:s=>v("update:modelValue",s)}),n=i(!1),m=i(!1),b=i("");U(()=>`${P("Annuler la prestation")}`);function V(){m.value=!0,p.cancelItem(r.value.id,b.value).then(s=>{r.value=s.data,n.value=!1,S.showSuccess(P("Prestation annulée avec succès"))}).catch(s=>{m.value=!1,S.showError(s.message)}).then(()=>{m.value=!1})}return(s,c)=>(h(),C(Z,{modelValue:n.value,"onUpdate:modelValue":c[3]||(c[3]=u=>n.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(w,Q({class:"ml-2",dark:""},u,{variant:"outlined",color:"primary",onClick:c[0]||(c[0]=$=>m.value=!1)}),{default:t(()=>[_(a(s.$t("Annuler la prestation")),1)]),_:2},1040)]),default:t(()=>[e(T,null,{default:t(()=>[e(W,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(s.$t("Annuler la prestation")),1)]),_:1}),e(O),e(A,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12",class:"text-center"},{default:t(()=>[_(a(s.$t("Êtes-vous sûr de vouloir Annuler la prestation?")),1)]),_:1}),e(k,{cols:"12"},{default:t(()=>[e(le,{modelValue:b.value,"onUpdate:modelValue":c[1]||(c[1]=u=>b.value=u),placeholder:s.$t("Commentaire"),label:s.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(O),e(X,null,{default:t(()=>[e(D),e(w,{color:"error",variant:"flat",dark:"",onClick:c[2]||(c[2]=u=>n.value=!1)},{default:t(()=>[_(a(s.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:m.value,dark:"",onClick:V},{default:t(()=>[_(a(s.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Oe=F({__name:"ValidatePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=B(),S=z(),x=j,v=l,r=U({get:()=>x.modelValue,set:s=>v("update:modelValue",s)}),n=i(!1),m=i(!1),b=i("");U(()=>`${P("Valider la prestation")}`);function V(){m.value=!0,p.validateItem(r.value.id,b.value).then(s=>{r.value=s.data,n.value=!1,S.showSuccess(P("Prestation validée avec succès"))}).catch(s=>{m.value=!1,S.showError(s.message)}).then(()=>{m.value=!1})}return(s,c)=>(h(),C(Z,{modelValue:n.value,"onUpdate:modelValue":c[3]||(c[3]=u=>n.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(w,Q({dark:""},u,{variant:"elevated",color:"primary",onClick:c[0]||(c[0]=$=>m.value=!1)}),{default:t(()=>[_(a(r.value.status==f(p).statuses.cancelled?s.$t("Rouvrir la prestation"):s.$t("Valider la prestation")),1)]),_:2},1040)]),default:t(()=>[e(T,null,{default:t(()=>[e(W,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(r.value.status==f(p).statuses.cancelled?s.$t("Rouvrir la prestation"):s.$t("Valider la prestation")),1)]),_:1}),e(O),e(A,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12",class:"text-center"},{default:t(()=>[_(a(r.value.status==f(p).statuses.cancelled?s.$t("Êtes-vous sûr de vouloir Rouvrir la prestation"):s.$t("Êtes-vous sûr de vouloir Valider la prestation?")),1)]),_:1}),r.value.status==f(p).statuses.cancelled?(h(),C(k,{key:0,cols:"12"},{default:t(()=>[e(le,{modelValue:b.value,"onUpdate:modelValue":c[1]||(c[1]=u=>b.value=u),placeholder:s.$t("Commentaire"),label:s.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})):M("",!0)]),_:1})]),_:1}),e(O),e(X,null,{default:t(()=>[e(D),e(w,{color:"error",variant:"flat",dark:"",onClick:c[2]||(c[2]=u=>n.value=!1)},{default:t(()=>[_(a(s.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:m.value,dark:"",onClick:V},{default:t(()=>[_(a(s.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ne={key:1},de=F({__name:"ServiceForm",props:{modelValue:Object,prestation:Object,isNew:{type:Boolean,default:!1},title:P("Service"),buttonText:P("Ajouter un service")},emits:["update:modelValue","update:item"],setup(j,{emit:l}){const p=B(),S=z(),x=fe(),v=j,r=l,n=U({get:()=>v.modelValue,set:u=>r("update:modelValue",u)}),m=i(!1),b=i(!1),V=i([]);ie(()=>{x.fetchItems({per_page:500}).then(u=>{V.value=u.data.data,console.log(V.value)})});function s(){b.value=!0,p.saveService(v.prestation.id,n.value).then(u=>{m.value=!1,r("update:item",u.data),v.isNew&&(n.value={}),S.showSuccess(P("Service enregistré avec succès"))}).catch(u=>{b.value=!1,S.showError(u.message)}).then(()=>{b.value=!1})}function c(u){if(console.log("service",u),u){const $=V.value.find(H=>H.name==u);$&&(n.value.quantity=n.value.quantity||1,n.value.service_id=$.id||null,n.value.price=$.price||0,n.value.total=(n.value.quantity||1)*($.price||0))}}return(u,$)=>{const H=K("EditIcon");return h(),C(Z,{modelValue:m.value,"onUpdate:modelValue":$[5]||($[5]=I=>m.value=I),"max-width":"500px"},{activator:t(({props:I})=>[e(w,Q({dark:""},I,{icon:n.value.id!=null,flat:n.value.id!=null,variant:"elevated",color:n.value.id!=null?null:"primary",onClick:$[0]||($[0]=d=>b.value=!1)}),{default:t(()=>[n.value.id?(h(),C(H,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary",density:"compact"})):(h(),L("span",Ne,a(j.buttonText),1))]),_:2},1040,["icon","flat","color"])]),default:t(()=>[e(T,null,{default:t(()=>[e(W,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(j.title),1)]),_:1}),e(O),e(A,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[e(_e,{modelValue:n.value.name,"onUpdate:modelValue":[$[1]||($[1]=I=>n.value.name=I),c],label:u.$t("Service"),clearable:"",items:V.value,"item-title":"name","item-value":"name",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(ne,{min:1,modelValue:n.value.quantity,"onUpdate:modelValue":$[2]||($[2]=I=>n.value.quantity=I),type:"number",label:u.$t("Quantité")},null,8,["modelValue","label"])]),_:1}),e(k,{cols:"12",md:"6"},{default:t(()=>[e(ne,{min:0,modelValue:n.value.price,"onUpdate:modelValue":$[3]||($[3]=I=>n.value.price=I),type:"number",label:u.$t("Prix")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(X,null,{default:t(()=>[e(D),e(w,{color:"error",variant:"flat",dark:"",onClick:$[4]||($[4]=I=>m.value=!1)},{default:t(()=>[_(a(u.$t("Annuler")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:b.value,dark:"",onClick:s},{default:t(()=>[_(a(u.$t("Ajouter")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Le=F({__name:"DeleteService",props:{modelValue:Object,service:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=B(),S=z(),x=j,v=l,r=U({get:()=>x.modelValue,set:V=>v("update:modelValue",V)}),n=i(!1),m=i(!1);function b(){m.value=!0,p.deleteService(r.value.id,x.service.id).then(V=>{r.value=V.data,n.value=!1,S.showSuccess(P("Service supprimé avec succès"))}).then(()=>{n.value=!1,m.value=!1})}return(V,s)=>{const c=K("TrashIcon");return h(),C(Z,{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=u=>n.value=u),"max-width":"350px"},{activator:t(({props:u})=>[e(w,Q({icon:"",flat:"",class:"ml-3",dark:""},u,{onClick:s[0]||(s[0]=$=>m.value=!1)}),{default:t(()=>[e(c,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040)]),default:t(()=>[e(T,null,{default:t(()=>[e(W,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(V.$t("Êtes-vous sûr de vouloir supprimer le service?")),1)]),_:1}),e(X,null,{default:t(()=>[e(D),e(w,{color:"error",variant:"flat",dark:"",onClick:s[1]||(s[1]=u=>n.value=!1)},{default:t(()=>[_(a(V.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:m.value,dark:"",onClick:b},{default:t(()=>[_(a(V.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),qe=F({__name:"DeletePayment",props:{modelValue:Object,payment:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=B(),S=z(),x=j,v=l,r=U({get:()=>x.modelValue,set:V=>v("update:modelValue",V)}),n=i(!1),m=i(!1);function b(){m.value=!0,p.deletePayment(x.payment.prestation_id,x.payment.id).then(V=>{r.value=V.data,n.value=!1,S.showSuccess(P("Paiement supprimé avec succès"))}).then(()=>{n.value=!1,m.value=!1})}return(V,s)=>{const c=K("TrashIcon");return h(),C(Z,{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=u=>n.value=u),"max-width":"350px"},{activator:t(({props:u})=>[e(w,Q({icon:"",flat:"",class:"ml-3",dark:""},u,{onClick:s[0]||(s[0]=$=>m.value=!1)}),{default:t(()=>[e(c,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040)]),default:t(()=>[e(T,null,{default:t(()=>[e(W,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(V.$t("Êtes-vous sûr de vouloir supprimer le paiement?")),1)]),_:1}),e(X,null,{default:t(()=>[e(D),e(w,{color:"error",variant:"flat",dark:"",onClick:s[1]||(s[1]=u=>n.value=!1)},{default:t(()=>[_(a(V.$t("Non")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:m.value,dark:"",onClick:b},{default:t(()=>[_(a(V.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Be=F({__name:"CommentPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const p=B(),S=z(),x=j,v=l,r=U({get:()=>x.modelValue,set:s=>v("update:modelValue",s)}),n=i(!1),m=i(!1),b=i(r.value.comment||"");U(()=>`${P("Commentaire")}`);function V(){m.value=!0,p.addComment(r.value.id,b.value).then(s=>{r.value=s.data,n.value=!1,S.showSuccess(P("Commentaire ajouté avec succès"))}).catch(s=>{m.value=!1,S.showError(s.message)}).then(()=>{m.value=!1})}return(s,c)=>(h(),C(Z,{modelValue:n.value,"onUpdate:modelValue":c[3]||(c[3]=u=>n.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(w,Q({density:"compact",dark:""},u,{variant:"outlined",color:"primary",onClick:c[0]||(c[0]=$=>m.value=!1)}),{default:t(()=>[_(a(!r.value.comment||r.value.comment.length==0?s.$t("Ajouter"):s.$t("Modifier")),1)]),_:2},1040)]),default:t(()=>[e(T,null,{default:t(()=>[e(W,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(!r.value.comment||r.value.comment.length==0?s.$t("Ajouter un commentaire"):s.$t("Modifier le commentaire")),1)]),_:1}),e(O),e(A,null,{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[e(le,{modelValue:b.value,"onUpdate:modelValue":c[1]||(c[1]=u=>b.value=u),placeholder:s.$t("Commentaire"),label:s.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(O),e(X,null,{default:t(()=>[e(D),e(w,{color:"error",variant:"flat",dark:"",onClick:c[2]||(c[2]=u=>n.value=!1)},{default:t(()=>[_(a(s.$t("Annuler")),1)]),_:1}),e(w,{color:"success",variant:"flat",loading:m.value,dark:"",onClick:V},{default:t(()=>[_(a(s.$t("Enregistrer")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Fe={key:0,class:"ml-2"},Re={class:"d-flex align-start"},ze={class:"text-h4 mt-1"},He={class:"ml-auto"},Qe={class:"mt-9"},We={class:"text-h4 font-weight-semibold mb-1"},Xe={class:"d-flex align-start"},Ze={class:"text-h4 mt-1"},Ge={class:"ml-auto"},Je={class:"mt-9"},Ke={class:"text-h4 font-weight-semibold mb-1"},Ye={class:"d-flex align-start"},et={class:"text-h4 mt-1"},tt={class:"mt-4"},at=["innerHTML"],lt={class:"d-flex align-start"},st={class:"text-h4 mt-1"},ot={class:"mt-4"},nt=["innerHTML"],ut={class:"text-h6 d-flex align-center"},rt={class:"text-h6"},dt={class:"text-h6"},it={class:"text-h6"},mt={class:"text-h6"},ct={class:"text-h6"},vt={class:"d-flex align-center"},pt={class:"text-h6 d-flex align-center"},ft={class:"mr-2"},_t={class:"text-h6"},Vt={class:"text-h6"},ht={class:"text-h6"},yt={class:"text-h6"},Ht=F({__name:"View",setup(j){i(),z();const l=i({id:null,status:0,service:"",demand_date:null,customer_id:null,demand_id:null,payments:[],services:[],customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),p=B(),S=me(),x=i({title:P("Détails du prestation")+" "+(l.value.eventtype&&l.value.eventtype.name||"")+" "+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(q(l.value.demand_date)||"")}),v=i([{text:P("Dashboard"),disabled:!1,href:"/"},{text:P("Prestations"),disabled:!1,href:"/prestations"},{text:l.value.eventtype?l.value.eventtype.name:"",disabled:!0,href:"#"}]);function r(){x.value={title:P("Prestation")+" "+(l.value.eventtype&&l.value.eventtype.name||"")+" ("+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(q(l.value.event_date)||"")+")"},v.value=[{text:P("Dashboard"),disabled:!1,href:"/"},{text:P("Prestations"),disabled:!1,href:"/prestations"},{text:x.value.title,disabled:!0,href:"#"}]}ie(()=>{H()});const n=i(!1);i(!1),i(!1),i(!1),i(!1),i(!1),i(!1),i({}),i({}),i(!1),i(10),i(2),i(2),i(!1),i(!1),i(null);const m=i("");i(["primary","secondary","error","success","warning"]),i([{key:"demand_date",order:"DESC"}]),i(0),i({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"demand_date",order:"DESC"}]});const b=i(-1);i({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const V=i({id:null,service_id:null,name:"",price:0,total:0,quantity:0}),s=i({id:null,prestation_id:null,amount:0});i({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),i(!1),i([{title:"Prestation",align:"start",key:"eventtype.name"},{title:"Date de la prestation",align:"start",key:"demand_date"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),U(()=>p.prestations.data.filter(d=>d.email.toLowerCase().includes(m.value.toLowerCase())));const c=U(()=>S.params.id);U(()=>l.value.customer.prestations?l.value.customer.prestations.filter(d=>d.id!=l.value.id):[]);const u=U(()=>l.value.services&&l.value.services.length?l.value.services.reduce((d,y)=>(console.log(y.total,d),parseFloat(y.total)+parseFloat(d)),0):0),$=U(()=>l.value.payments&&l.value.payments.length?u.value-l.value.payments.reduce((d,y)=>parseFloat(y.amount)+parseFloat(d),0):u.value);U(()=>b.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function H(){n.value=!0,p.fetchItem(S.params.id).then(d=>{d.data.error||(n.value=!1,l.value=d.data,l.value.payments=(l.value.payments||[]).map(y=>{const J=y.payment_date!=null?new Date(y.payment_date):null;return{...y,payment_date:J}}),r())}).catch(d=>{n.value=!1}).then(()=>{n.value=!1})}function I(d){l.value=d,V.value={id:null,service_id:null,name:"",price:0,total:0,quantity:0}}return ce(c,(d,y)=>{d!=y&&H()},{deep:!0}),(d,y)=>{const J=K("CurrencyEuroIcon");return h(),L(ee,null,[n.value?M("",!0):(h(),C(pe,{key:0,title:x.value.title,breadcrumbs:v.value},null,8,["title","breadcrumbs"])),n.value?(h(),C(E,{key:1,justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(k,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(ve,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(h(),C(E,{key:2},{default:t(()=>[e(k,{cols:"12",md:"4"},{default:t(()=>[_(a(d.$t("Status :"))+" ",1),e(ae,{rounded:"md",class:"font-weight-bold",color:f(p).statusColor(l.value.status),size:"small",label:""},{default:t(()=>[_(a(f(p).statusText(l.value.status)),1)]),_:1},8,["color"]),l.value.status==f(p).statuses.cancelled?(h(),L("span",Fe,a(d.$t("Le"))+" "+a(f(q)(l.value.cancelled_date)||""),1)):M("",!0)]),_:1}),e(k,{cols:"12",md:"8",justify:"end","align-content":"end",align:"end"},{default:t(()=>[l.value.status==f(p).statuses.started||l.value.status==f(p).statuses.cancelled?(h(),C(Oe,{key:0,modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=g=>l.value=g)},null,8,["modelValue"])):M("",!0),l.value.status==f(p).statuses.validated?(h(),C(Ve,{key:1,modelValue:l.value,"onUpdate:modelValue":y[1]||(y[1]=g=>l.value=g)},null,8,["modelValue"])):M("",!0),l.value.status!=f(p).statuses.cancelled?(h(),C(Ee,{key:2,modelValue:l.value,"onUpdate:modelValue":y[2]||(y[2]=g=>l.value=g)},null,8,["modelValue"])):M("",!0),e(O,{vertical:""}),e(w,{variant:"elevated",color:"success",class:"ml-2",to:"/customers/"+l.value.customer_id},{default:t(()=>[_(a(d.$t("Voir le Client")),1)]),_:1},8,["to"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(Me,{modelValue:l.value,"onUpdate:modelValue":y[3]||(y[3]=g=>l.value=g),"show-demand-info":"",source:l.value.source},null,8,["modelValue","source"])]),_:1}),e(k,{cols:"12",md:"3"},{default:t(()=>[e(he,{modelValue:l.value,"onUpdate:modelValue":y[4]||(y[4]=g=>l.value=g),"show-demand-info":""},null,8,["modelValue"])]),_:1}),e(k,{cols:"12",md:"6",class:"justify-end align-end"},{default:t(()=>[e(E,{class:"align-end justify-end align-content-end"},{default:t(()=>[e(k,{cols:"12",class:"align-end justify-end align-content-end"},{default:t(()=>[e(E,{class:"align-end justify-end align-content-end"},{default:t(()=>[l.value.status>=f(p).statuses.validated?(h(),C(k,{key:0,cols:"12",md:"6",class:""},{default:t(()=>[e(T,{elevation:"10"},{default:t(()=>[e(A,null,{default:t(()=>[o("div",Re,[o("h2",ze,a(d.$t("Reste à payer")),1),e(D),o("div",He,[e(w,{color:"primary",icon:"",flat:""},{default:t(()=>[e(J)]),_:1})])]),o("div",Qe,[o("h2",We,a(f(N)($.value)),1)])]),_:1})]),_:1})]),_:1})):M("",!0),e(k,{cols:"12",md:"6"},{default:t(()=>[e(T,{elevation:"10"},{default:t(()=>[e(A,null,{default:t(()=>[o("div",Xe,[o("h2",Ze,a(d.$t("Montant total")),1),e(D),o("div",Ge,[e(w,{color:"primary",icon:"",flat:""},{default:t(()=>[e(J)]),_:1})])]),o("div",Je,[o("h2",Ke,a(f(N)(l.value.payment_total||0))+"/"+a(f(N)(u.value||0)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",class:"align-end justify-end align-content-end"},{default:t(()=>[e(E,{class:"align-end justify-end align-content-end"},{default:t(()=>[e(k,{class:"h-100",cols:"12"},{default:t(()=>[e(E,null,{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[e(T,{elevation:"10",class:"h-100"},{default:t(()=>[e(A,null,{default:t(()=>[o("div",Ye,[o("h2",et,a(d.$t("Commentaire")),1),e(Be,{modelValue:l.value,"onUpdate:modelValue":y[5]||(y[5]=g=>l.value=g)},null,8,["modelValue"])]),o("div",tt,[o("p",{class:"mb-1",innerHTML:(l.value.comment||d.$t("Aucun commentaire")).replace(/\n/g,"<br/>")},null,8,at)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l.value.status==f(p).statuses.cancelled?(h(),C(k,{key:0,cols:"12"},{default:t(()=>[e(T,{elevation:"10",class:"h-100"},{default:t(()=>[e(A,null,{default:t(()=>[o("div",lt,[o("h2",st,a(d.$t("Raison de l'annulation")),1)]),o("div",ot,[o("p",{class:"mb-1",innerHTML:(l.value.cancel_comment||d.$t("Aucun commentaire")).replace(/\n/g,"<br/>")},null,8,nt)])]),_:1})]),_:1})]),_:1})):M("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),e(k,{cols:"12",lg:l.value.status>f(p).statuses.started?"6":"12"},{default:t(()=>[e(T,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(te,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[o("h4",ut,[o("span",null,a(d.$t("Désignation des services attendus")),1),_(" : "+a(l.value.services?l.value.services.length:0)+" - "+a(f(N)(u.value||0))+" ",1),e(D),e(de,{modelValue:V.value,"onUpdate:modelValue":y[6]||(y[6]=g=>V.value=g),prestation:l.value,"is-new":"","onUpdate:item":I,"button-text":d.$t("Ajouter un service"),title:d.$t("Ajouter un service")},null,8,["modelValue","prestation","button-text","title"])])]),_:1}),e(A,{class:"pa-6"},{default:t(()=>[e(oe,{class:"month-table"},{default:t(()=>[o("thead",null,[o("tr",null,[o("th",rt,a(d.$t("Désignation")),1),o("th",dt,a(d.$t("Quantité")),1),o("th",it,a(d.$t("Prix unitaire")),1),o("th",mt,a(d.$t("Prix total")),1),o("th",ct,a(d.$t("Actions")),1)])]),o("tbody",null,[(h(!0),L(ee,null,se(l.value.services,(g,R)=>(h(),L("tr",{key:g.id,class:"month-item"},[o("td",null,a(g.service_name),1),o("td",null,a(g.quantity),1),o("td",null,a(f(N)(g.price)),1),o("td",null,a(f(N)(g.total)),1),o("td",null,[o("div",vt,[e(re,{text:d.$t("Modifier")},{activator:t(({props:G})=>[e(de,{modelValue:l.value.services[R],"onUpdate:modelValue":Y=>l.value.services[R]=Y,prestation:l.value,"onUpdate:item":I,"button-text":d.$t("Modifier le service"),title:d.$t("Modifier le service")},null,8,["modelValue","onUpdate:modelValue","prestation","button-text","title"])]),_:2},1032,["text"]),e(Le,{modelValue:l.value,"onUpdate:modelValue":y[7]||(y[7]=G=>l.value=G),service:l.value.services[R]},null,8,["modelValue","service"])])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"]),l.value.status>f(p).statuses.started?(h(),C(k,{key:0,cols:"12",lg:l.value.status>f(p).statuses.started?"6":"12"},{default:t(()=>[e(T,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(te,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[o("h4",pt,[o("span",ft,a(d.$t("Paiements")),1),_(" : "+a(l.value.payments.length)+" - "+a(f(N)(l.value.payment_total||0))+" ",1),e(D),e(ue,{prestation:l.value,"onUpdate:item":I,"button-text":d.$t("Ajouter un paiement"),title:d.$t("Ajouter un paiement")},null,8,["prestation","button-text","title"])])]),_:1}),e(A,{class:"pa-6"},{default:t(()=>[e(oe,{class:"month-table"},{default:t(()=>[o("thead",null,[o("tr",null,[o("th",_t,a(d.$t("Mode de paiement")),1),o("th",Vt,a(d.$t("Montant payé")),1),o("th",ht,a(d.$t("Date du paiement")),1),o("th",yt,a(d.$t("Actions")),1)])]),o("tbody",null,[(h(!0),L(ee,null,se(l.value.payments,(g,R)=>(h(),L("tr",{key:s.value.id},[o("td",null,a(g.payment_method_name||g.payment_method),1),o("td",null,a(f(N)(g.amount)),1),o("td",null,a(f(q)(g.payment_date)),1),o("td",null,[e(re,{text:d.$t("Modifier")},{activator:t(({props:G})=>[e(ue,{modelValue:l.value.payments[R],"onUpdate:modelValue":Y=>l.value.payments[R]=Y,icon:"",prestation:l.value,"onUpdate:item":I,"button-text":d.$t("Modifier le paiement"),title:d.$t("Modifier le paiement")},null,8,["modelValue","onUpdate:modelValue","prestation","button-text","title"])]),_:2},1032,["text"]),e(qe,{modelValue:l.value,"onUpdate:modelValue":y[8]||(y[8]=G=>l.value=G),payment:l.value.payments[R]},null,8,["modelValue","payment"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"])):M("",!0)]),_:1}))],64)}}});export{Ht as default};
