import{u as q}from"./Controller-B-jP1_5w.js";import{a6 as B,av as R,e as U,r as n,aK as A,o as f,_ as b,w as t,b as e,d as _,t as a,n as z,V as C,aL as G,a8 as V,a4 as T,a as u,c as O,h as le,Z as H,aM as me,g as ce,aN as ve,X as Y,a5 as oe}from"./index-DkwRdgHS.js";import{_ as fe}from"./BaseBreadcrumb-DLYx4N78.js";import{f as F,a as Z}from"./formatters-Dv1Ro_l4.js";import{a as Q,b as M,c as K,V as L,d as ee}from"./VCard-CHYAf1cI.js";import{V as E}from"./VDivider-DVIF2Pbn.js";import{a as N,V as P}from"./VRow-DqZu2hjJ.js";import{V as re}from"./VTextarea-B5Z6D_kn.js";import{V as D}from"./VSpacer-yr7dW-s2.js";import{V as W}from"./VDialog-CXq5mtyx.js";import{V as te}from"./VChip-CdYipKHe.js";import{u as pe}from"./service-DBpy8Sam.js";import{V as de}from"./VAutocomplete-CZVMu9ag.js";import{V as ae}from"./VTextField-4vZxFc38.js";import{u as he}from"./paymentMethod-C_A0PcRd.js";import{V as ue}from"./VTable-2-qK-iWv.js";import{V as _e}from"./VTooltip-DVopnj7G.js";import"./createSimpleFunctional-BUfBUTNM.js";import"./VAvatar-D_utZLn9.js";import"./VField-BeJau0qT.js";import"./index-DziAIju4.js";import"./filter-2uO5JHRc.js";import"./VMenu-D49WRTb8.js";const Ve=B({__name:"CancelPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const d=q(),w=R(),I=j,p=l,m=U({get:()=>I.modelValue,set:o=>p("update:modelValue",o)}),s=n(!1),v=n(!1),$=n("");U(()=>`${A("Annuler la prestation")}`);function i(){v.value=!0,d.cancelItem(m.value.id,$.value).then(o=>{m.value=o.data,s.value=!1,w.showSuccess(A("Prestation annulée avec succès")),G.push(d.pageLink(m.value.status))}).catch(o=>{v.value=!1,w.showError(o.message)}).then(()=>{v.value=!1})}return(o,h)=>(f(),b(W,{modelValue:s.value,"onUpdate:modelValue":h[3]||(h[3]=c=>s.value=c),"max-width":"500px"},{activator:t(({props:c})=>[e(C,z({class:"ml-2",dark:""},c,{variant:"outlined",color:"primary",onClick:h[0]||(h[0]=S=>v.value=!1)}),{default:t(()=>[_(a(o.$t("Annuler la prestation")),1)]),_:2},1040)]),default:t(()=>[e(L,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(o.$t("Annuler la prestation")),1)]),_:1}),e(E),e(M,null,{default:t(()=>[e(N,null,{default:t(()=>[e(P,{cols:"12",class:"text-center"},{default:t(()=>[_(a(o.$t("Êtes-vous sûr de vouloir Annuler la prestation?")),1)]),_:1}),e(P,{cols:"12"},{default:t(()=>[e(re,{modelValue:$.value,"onUpdate:modelValue":h[1]||(h[1]=c=>$.value=c),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(E),e(K,null,{default:t(()=>[e(D),e(C,{color:"error",variant:"flat",dark:"",onClick:h[2]||(h[2]=c=>s.value=!1)},{default:t(()=>[_(a(o.$t("Non")),1)]),_:1}),e(C,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:i},{default:t(()=>[_(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ge=B({__name:"ValidatePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const d=q(),w=R(),I=j,p=l,m=U({get:()=>I.modelValue,set:o=>p("update:modelValue",o)}),s=n(!1),v=n(!1),$=n("");U(()=>`${A("Valider la prestation")}`);function i(){v.value=!0,d.validateItem(m.value.id,$.value).then(o=>{m.value=o.data,s.value=!1,w.showSuccess(A("Prestation validée avec succès")),G.push(d.pageLink(m.value.status))}).catch(o=>{v.value=!1,w.showError(o.message)}).then(()=>{v.value=!1})}return(o,h)=>(f(),b(W,{modelValue:s.value,"onUpdate:modelValue":h[3]||(h[3]=c=>s.value=c),"max-width":"500px"},{activator:t(({props:c})=>[e(C,z({dark:""},c,{variant:"elevated",color:"primary",onClick:h[0]||(h[0]=S=>v.value=!1)}),{default:t(()=>[_(a(m.value.status==V(d).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:2},1040)]),default:t(()=>[e(L,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(m.value.status==V(d).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:1}),e(E),e(M,null,{default:t(()=>[e(N,null,{default:t(()=>[e(P,{cols:"12",class:"text-center"},{default:t(()=>[_(a(m.value.status==V(d).statuses.cancelled?o.$t("Êtes-vous sûr de vouloir Rouvrir la prestation"):o.$t("Êtes-vous sûr de vouloir Valider la prestation?")),1)]),_:1}),m.value.status==V(d).statuses.cancelled?(f(),b(P,{key:0,cols:"12"},{default:t(()=>[e(re,{modelValue:$.value,"onUpdate:modelValue":h[1]||(h[1]=c=>$.value=c),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})):T("",!0)]),_:1})]),_:1}),e(E),e(K,null,{default:t(()=>[e(D),e(C,{color:"error",variant:"flat",dark:"",onClick:h[2]||(h[2]=c=>s.value=!1)},{default:t(()=>[_(a(o.$t("Non")),1)]),_:1}),e(C,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:i},{default:t(()=>[_(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ye={class:"text-h6"},$e={class:"text-subtitle-1 textSecondary mt-3"},ke={class:"text-subtitle-1 textSecondary mt-3"},be={class:"text-subtitle-1 textSecondary mt-3"},Ce={class:"text-subtitle-1 textSecondary mt-3"},we={class:"text-subtitle-1 textSecondary mt-3"},Se={class:"text-subtitle-1 textSecondary mt-3"},xe={class:"text-subtitle-1 textSecondary mt-3"},Pe={class:"text-subtitle-1 textSecondary mt-3"},je={key:0,class:"text-subtitle-1 textSecondary mt-3"},Ie={key:1,class:"text-subtitle-1 textSecondary mt-3"},Ue=B({__name:"CustomerWidget",props:{modelValue:Object,showDemandInfo:Boolean},emits:["update:modelValue"],setup(j,{emit:l}){const d=q(),w=j,I=l,p=U({get:()=>w.modelValue,set:m=>I("update:modelValue",m)});return(m,s)=>(f(),b(L,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(ee,{class:"py-4 px-6 text-white bg-primary"},{default:t(()=>[u("h4",ye,a(m.$t("Identification du demandeur")),1)]),_:1}),e(M,{class:"pl-6 pr-6"},{default:t(()=>[u("p",$e,a(m.$t("Prénom :"))+" "+a(p.value.customer.firstname||""),1),u("p",ke,a(m.$t("Nom :"))+" "+a(p.value.customer.lastname||""),1),u("p",be,a(m.$t("Email :"))+" "+a(p.value.customer.email||""),1),u("p",Ce,a(m.$t("Téléphone :"))+" "+a(p.value.customer.phone||""),1),u("p",we,a(m.$t("Date d'enregistrement :"))+" "+a(V(F)(p.value.customer.created_at)||""),1),u("p",Se,[_(a(m.$t("Type :"))+" ",1),p.value.customer&&p.value.customer.is_customer?(f(),b(te,{key:0,color:"success"},{default:t(()=>[_(a(m.$t("Client")),1)]),_:1})):(f(),b(te,{key:1,color:"error"},{default:t(()=>[_(a(m.$t("Prospect")),1)]),_:1}))])]),_:1}),j.showDemandInfo?(f(),b(M,{key:0,class:"pt-0 pb-0"},{default:t(()=>[e(E)]),_:1})):T("",!0),j.showDemandInfo?(f(),b(M,{key:1,class:"pl-6 pr-6"},{default:t(()=>[u("p",xe,a(m.$t("Date de la demande :"))+" "+a(V(F)(p.value.demand_date)||""),1),u("p",Pe,a(m.$t("Date création de la prestation :"))+" "+a(V(F)(p.value.created_at)||""),1),p.value.status>=V(d).statuses.processing?(f(),O("p",je,a(m.$t("Date lancement de la prestation :"))+" "+a(V(F)(p.value.start_date)||""),1)):T("",!0),p.value.status>=V(d).statuses.closed?(f(),O("p",Ie,a(m.$t("Date clôture de la prestation :"))+" "+a(V(F)(p.value.closed_date)||""),1)):T("",!0)]),_:1})):T("",!0)]),_:1}))}}),Ae={key:1},ne=B({__name:"ServiceForm",props:{modelValue:Object,prestation:Object,title:A("Service"),buttonText:A("Ajouter un service")},emits:["update:modelValue","update:item"],setup(j,{emit:l}){const d=q(),w=R(),I=pe(),p=j,m=l,s=U({get:()=>p.modelValue,set:c=>m("update:modelValue",c)}),v=n(!1),$=n(!1),i=n([]);le(()=>{I.fetchItems({per_page:500}).then(c=>{i.value=c.data.data,console.log(i.value)})});function o(){$.value=!0,d.saveService(p.prestation.id,s.value).then(c=>{v.value=!1,m("update:item",c.data),w.showSuccess(A("Service enregistré avec succès"))}).catch(c=>{$.value=!1,w.showError(c.message)}).then(()=>{$.value=!1})}function h(c){if(c){const S=i.value.find(k=>k.name==c);S&&(s.value.quantity=s.value.quantity||1,s.value.service_id=S.id||null,s.value.price=S.price||0,s.value.total=(s.value.quantity||1)*(S.price||0))}}return(c,S)=>{const k=H("EditIcon");return f(),b(W,{modelValue:v.value,"onUpdate:modelValue":S[5]||(S[5]=g=>v.value=g),"max-width":"500px"},{activator:t(({props:g})=>[e(C,z({dark:""},g,{icon:s.value.id!=null,flat:s.value.id!=null,variant:"elevated",color:s.value.id!=null?null:"primary",onClick:S[0]||(S[0]=r=>$.value=!1)}),{default:t(()=>[s.value.id?(f(),b(k,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(f(),O("span",Ae,a(j.buttonText),1))]),_:2},1040,["icon","flat","color"])]),default:t(()=>[e(L,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(j.title),1)]),_:1}),e(E),e(M,null,{default:t(()=>[e(N,null,{default:t(()=>[e(P,{cols:"12"},{default:t(()=>[e(de,{modelValue:s.value.name,"onUpdate:modelValue":[S[1]||(S[1]=g=>s.value.name=g),h],label:c.$t("Service"),clearable:"",items:i.value,"item-title":"name","item-value":"name",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(P,{cols:"12",md:"6"},{default:t(()=>[e(ae,{min:1,modelValue:s.value.quantity,"onUpdate:modelValue":S[2]||(S[2]=g=>s.value.quantity=g),type:"number",label:c.$t("Quantité")},null,8,["modelValue","label"])]),_:1}),e(P,{cols:"12",md:"6"},{default:t(()=>[e(ae,{min:0,modelValue:s.value.price,"onUpdate:modelValue":S[3]||(S[3]=g=>s.value.price=g),type:"number",label:c.$t("Prix")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(D),e(C,{color:"error",variant:"flat",dark:"",onClick:S[4]||(S[4]=g=>v.value=!1)},{default:t(()=>[_(a(c.$t("Annuler")),1)]),_:1}),e(C,{color:"success",variant:"flat",loading:$.value,dark:"",onClick:o},{default:t(()=>[_(a(c.$t("Ajouter")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),De=B({__name:"DeleteService",props:{modelValue:Object,service:Object},emits:["update:modelValue"],setup(j,{emit:l}){const d=q(),w=R(),I=j,p=l,m=U({get:()=>I.modelValue,set:i=>p("update:modelValue",i)}),s=n(!1),v=n(!1);function $(){v.value=!0,d.deleteService(m.value.id,I.service.id).then(i=>{m.value=i.data,s.value=!1,w.showSuccess(A("Service supprimé avec succès"))}).then(()=>{s.value=!1,v.value=!1})}return(i,o)=>{const h=H("TrashIcon");return f(),b(W,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=c=>s.value=c),"max-width":"350px"},{activator:t(({props:c})=>[e(C,z({icon:"",flat:"",class:"ml-3",dark:""},c,{onClick:o[0]||(o[0]=S=>v.value=!1)}),{default:t(()=>[e(h,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040)]),default:t(()=>[e(L,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(i.$t("Êtes-vous sûr de vouloir supprimer le service?")),1)]),_:1}),e(K,null,{default:t(()=>[e(D),e(C,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=c=>s.value=!1)},{default:t(()=>[_(a(i.$t("Non")),1)]),_:1}),e(C,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:$},{default:t(()=>[_(a(i.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Te={key:1},Me=B({__name:"PaymentForm",props:{modelValue:Object,prestation:Object,title:A("PaymentMethod"),buttonText:A("Ajouter un paymentMethod")},emits:["update:modelValue","update:item"],setup(j,{emit:l}){const d=q(),w=R(),I=he(),p=j,m=l,s=U({get:()=>p.modelValue,set:k=>m("update:modelValue",k)}),v=n(!1),$=n(!1),i=n([]);le(()=>{I.fetchItems({per_page:500}).then(k=>{i.value=k.data.data,console.log(i.value)}),s.value.amount=h.value});const o=U(()=>p.prestation.services?p.prestation.services.reduce((k,g)=>(console.log(g.total,k),parseFloat(g.total)+parseFloat(k)),0):0),h=U(()=>p.prestation.payments&&p.prestation.payments.length?o.value-p.prestation.payments.reduce((k,g)=>parseFloat(g.amount)+parseFloat(k),0):o.value);function c(){$.value=!0,d.savePayment(p.prestation.id,s.value).then(k=>{v.value=!1,m("update:item",k.data),w.showSuccess(A("PaymentMethod enregistré avec succès"))}).catch(k=>{$.value=!1,w.showError(k.message)}).then(()=>{$.value=!1})}function S(k){if(console.log(h.value),k){const g=i.value.find(r=>r.id==k);g&&(s.value.payment_method=g.name||null,s.value.amount=h.value)}}return(k,g)=>{const r=H("EditIcon");return f(),b(W,{modelValue:v.value,"onUpdate:modelValue":g[4]||(g[4]=y=>v.value=y),"max-width":"500px"},{activator:t(({props:y})=>[e(C,z({dark:""},y,{icon:s.value.id!=null,flat:s.value.id!=null,variant:"elevated",color:s.value.id!=null?null:"primary",onClick:g[0]||(g[0]=J=>$.value=!1)}),{default:t(()=>[s.value.id?(f(),b(r,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(f(),O("span",Te,a(j.buttonText),1))]),_:2},1040,["icon","flat","color"])]),default:t(()=>[e(L,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(j.title),1)]),_:1}),e(E),e(M,null,{default:t(()=>[e(N,null,{default:t(()=>[e(P,{cols:"12"},{default:t(()=>[e(de,{modelValue:s.value.payment_method_id,"onUpdate:modelValue":[g[1]||(g[1]=y=>s.value.payment_method_id=y),S],label:k.$t("PaymentMethod"),clearable:"",items:i.value,"item-title":"name","item-value":"id",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(P,{cols:"12"},{default:t(()=>[e(ae,{min:0,modelValue:s.value.amount,"onUpdate:modelValue":g[2]||(g[2]=y=>s.value.amount=y),type:"number",label:k.$t("Montant")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(K,null,{default:t(()=>[e(D),e(C,{color:"error",variant:"flat",dark:"",onClick:g[3]||(g[3]=y=>v.value=!1)},{default:t(()=>[_(a(k.$t("Annuler")),1)]),_:1}),e(C,{color:"success",variant:"flat",loading:$.value,dark:"",onClick:c},{default:t(()=>[_(a(k.$t("Ajouter")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Le=B({__name:"StartPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const d=q(),w=R(),I=j,p=l,m=U({get:()=>I.modelValue,set:i=>p("update:modelValue",i)}),s=n(!1),v=n(!1);n(""),U(()=>`${A("Lancer la prestation")}`);function $(){v.value=!0,d.startItem(m.value.id).then(i=>{m.value=i.data,s.value=!1,w.showSuccess(A("Prestation lancée avec succès")),G.push(d.pageLink(m.value.status))}).catch(i=>{v.value=!1,w.showError(i.message)}).then(()=>{v.value=!1})}return(i,o)=>(f(),b(W,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=h=>s.value=h),"max-width":"500px"},{activator:t(({props:h})=>[e(C,z({dark:""},h,{variant:"elevated",color:"primary",onClick:o[0]||(o[0]=c=>v.value=!1)}),{default:t(()=>[_(a(i.$t("Lancer la prestation")),1)]),_:2},1040)]),default:t(()=>[e(L,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(i.$t("Lancer la prestation")),1)]),_:1}),e(E),e(M,null,{default:t(()=>[e(N,null,{default:t(()=>[e(P,{cols:"12",class:"text-center"},{default:t(()=>[_(a(i.$t("Êtes-vous sûr de vouloir Lancer la prestation?")),1)]),_:1})]),_:1})]),_:1}),e(E),e(K,null,{default:t(()=>[e(D),e(C,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=h=>s.value=!1)},{default:t(()=>[_(a(i.$t("Non")),1)]),_:1}),e(C,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:$},{default:t(()=>[_(a(i.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ee=B({__name:"ClosePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(j,{emit:l}){const d=q(),w=R(),I=j,p=l,m=U({get:()=>I.modelValue,set:i=>p("update:modelValue",i)}),s=n(!1),v=n(!1);n(""),U(()=>`${A("Terminer la prestation")}`);function $(){v.value=!0,d.closeItem(m.value.id).then(i=>{m.value=i.data,s.value=!1,w.showSuccess(A("Prestation clôturée avec succès")),G.push(d.pageLink(m.value.status))}).catch(i=>{v.value=!1,w.showError(i.message)}).then(()=>{v.value=!1})}return(i,o)=>(f(),b(W,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=h=>s.value=h),"max-width":"500px"},{activator:t(({props:h})=>[e(C,z({dark:""},h,{variant:"elevated",color:"primary",onClick:o[0]||(o[0]=c=>v.value=!1)}),{default:t(()=>[_(a(i.$t("Terminer la prestation")),1)]),_:2},1040)]),default:t(()=>[e(L,null,{default:t(()=>[e(Q,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(i.$t("Terminer la prestation")),1)]),_:1}),e(E),e(M,null,{default:t(()=>[e(N,null,{default:t(()=>[e(P,{cols:"12",class:"text-center"},{default:t(()=>[_(a(i.$t("Êtes-vous sûr de vouloir terminer la prestation?")),1)]),_:1})]),_:1})]),_:1}),e(E),e(K,null,{default:t(()=>[e(D),e(C,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=h=>s.value=!1)},{default:t(()=>[_(a(i.$t("Non")),1)]),_:1}),e(C,{color:"success",variant:"flat",loading:v.value,dark:"",onClick:$},{default:t(()=>[_(a(i.$t("Oui")),1)]),_:1},8,["loading"]),e(D)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Oe={key:0,class:"ml-2"},Ne={class:"d-flex align-start"},Fe={class:"text-h4 mt-1"},qe={class:"ml-auto"},Be={class:"mt-9"},Re={class:"text-h4 font-weight-semibold mb-1"},ze={class:"d-flex align-start"},Qe={class:"text-h4 mt-1"},Ke={class:"ml-auto"},We={class:"mt-9"},Xe={class:"text-h4 font-weight-semibold mb-1"},Ze={class:"d-flex align-start"},Ge={class:"text-h4 mt-1"},He={class:"mt-4"},Je={class:"mb-1"},Ye={class:"d-flex align-start"},et={class:"text-h4 mt-1"},tt={class:"mt-4"},at={class:"mb-1"},lt={class:"text-h6 d-flex align-center"},st={class:"text-h6"},ot={class:"text-h6"},ut={class:"text-h6"},nt={class:"text-h6"},rt={class:"text-h6"},dt={key:0,class:"d-flex align-center"},it={class:"text-h6 d-flex align-center"},mt={class:"text-h6"},ct={class:"text-h6"},vt={class:"text-h6"},Et=B({__name:"View",setup(j){n(),R();const l=n({id:null,status:0,service:"",demand_date:null,customer_id:null,demand_id:null,payments:[],services:[],customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),d=q(),w=me(),I=n({title:A("Détails du devis")+" "+(l.value.event_type||"")+" "+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(F(l.value.demand_date)||"")}),p=n([{text:A("Dashboard"),disabled:!1,href:"/"},{text:d.pageTitle(l.value.status),disabled:!1,href:d.pageLink(l.value.status)},{text:l.value.event_type||"",disabled:!0,href:"#"}]);function m(){I.value={title:A("Prestation")+" "+(l.value.demand.event_type||"")+" ("+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(F(l.value.demand_date)||"")+")"},p.value=[{text:A("Dashboard"),disabled:!1,href:"/"},{text:d.pageTitle(l.value.status),disabled:!1,href:d.pageLink(l.value.status)},{text:I.value.title,disabled:!0,href:"#"}]}le(()=>{k()});const s=n(!1);n(!1),n(!1),n(!1),n(!1),n(!1),n(!1),n({}),n({}),n(!1),n(10),n(2),n(2),n(!1),n(!1),n(null);const v=n("");n(["primary","secondary","error","success","warning"]),n([{key:"demand_date",order:"DESC"}]),n(0),n({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"demand_date",order:"DESC"}]});const $=n(-1);n({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const i=n({id:null,service_id:null,name:"",price:0,total:0,quantity:0}),o=n({id:null,prestation_id:null,amount:0});n({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),n(!1),n([{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la prestation",align:"start",key:"demand_date"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),U(()=>d.prestations.data.filter(r=>r.email.toLowerCase().includes(v.value.toLowerCase())));const h=U(()=>w.params.id);U(()=>l.value.customer.prestations?l.value.customer.prestations.filter(r=>r.id!=l.value.id):[]);const c=U(()=>l.value.services&&l.value.services.length?l.value.services.reduce((r,y)=>(console.log(y.total,r),parseFloat(y.total)+parseFloat(r)),0):0),S=U(()=>l.value.payments&&l.value.payments.length?c.value-l.value.payments.reduce((r,y)=>parseFloat(y.amount)+parseFloat(r),0):c.value);U(()=>$.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function k(){s.value=!0,d.fetchItem(w.params.id).then(r=>{r.data.error||(s.value=!1,l.value=r.data,m())}).catch(r=>{s.value=!1}).then(()=>{s.value=!1})}function g(r){l.value=r}return ce(h,(r,y)=>{r!=y&&k()},{deep:!0}),(r,y)=>{const J=H("CurrencyEuroIcon");return f(),O(Y,null,[s.value?T("",!0):(f(),b(fe,{key:0,title:I.value.title,breadcrumbs:p.value},null,8,["title","breadcrumbs"])),s.value?(f(),b(N,{key:1,justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(P,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(ve,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(f(),b(N,{key:2},{default:t(()=>[e(P,{cols:"12",md:"4"},{default:t(()=>[_(a(r.$t("Status :"))+" ",1),e(te,{rounded:"md",class:"font-weight-bold",color:V(d).statusColor(l.value.status),size:"small",label:""},{default:t(()=>[_(a(V(d).statusText(l.value.status)),1)]),_:1},8,["color"]),l.value.status==V(d).statuses.cancelled?(f(),O("span",Oe,a(r.$t("Le"))+" "+a(V(F)(l.value.cancelled_date)||""),1)):T("",!0)]),_:1}),e(P,{cols:"12",md:"8",justify:"end","align-content":"end",align:"end"},{default:t(()=>[l.value.status==V(d).statuses.started||l.value.status==V(d).statuses.cancelled?(f(),b(ge,{key:0,modelValue:l.value,"onUpdate:modelValue":y[0]||(y[0]=x=>l.value=x)},null,8,["modelValue"])):T("",!0),l.value.status==V(d).statuses.validated?(f(),b(Le,{key:1,modelValue:l.value,"onUpdate:modelValue":y[1]||(y[1]=x=>l.value=x)},null,8,["modelValue"])):T("",!0),l.value.status==V(d).statuses.processing?(f(),b(Ee,{key:2,modelValue:l.value,"onUpdate:modelValue":y[2]||(y[2]=x=>l.value=x)},null,8,["modelValue"])):T("",!0),l.value.status!=V(d).statuses.cancelled?(f(),b(Ve,{key:3,modelValue:l.value,"onUpdate:modelValue":y[3]||(y[3]=x=>l.value=x)},null,8,["modelValue"])):T("",!0),e(E,{vertical:""}),e(C,{variant:"elevated",color:"success",class:"ml-2",to:"/customers/"+l.value.customer_id},{default:t(()=>[_(a(r.$t("Voir le Client")),1)]),_:1},8,["to"]),e(C,{variant:"elevated",color:"info",class:"ml-2",to:"/demands/"+l.value.demand_id},{default:t(()=>[_(a(r.$t("Voir la demande associée")),1)]),_:1},8,["to"])]),_:1}),e(P,{cols:"12",md:"4"},{default:t(()=>[e(Ue,{modelValue:l.value,"onUpdate:modelValue":y[4]||(y[4]=x=>l.value=x),"show-demand-info":""},null,8,["modelValue"])]),_:1}),e(P,{cols:"12",md:"8",class:"justify-end align-end"},{default:t(()=>[e(N,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[e(P,{cols:"12",class:"h-50 align-end justify-end align-content-end"},{default:t(()=>[e(N,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[l.value.status>=V(d).statuses.validated?(f(),b(P,{key:0,cols:"12",md:"6",class:"h-100"},{default:t(()=>[e(L,{elevation:"10"},{default:t(()=>[e(M,null,{default:t(()=>[u("div",Ne,[u("h2",Fe,a(r.$t("Reste à payer")),1),e(D),u("div",qe,[e(C,{color:"primary",icon:"",flat:""},{default:t(()=>[e(J)]),_:1})])]),u("div",Be,[u("h2",Re,a(V(Z)(S.value)),1)])]),_:1})]),_:1})]),_:1})):T("",!0),e(P,{class:"h-100",cols:"12",md:"6"},{default:t(()=>[e(L,{elevation:"10"},{default:t(()=>[e(M,null,{default:t(()=>[u("div",ze,[u("h2",Qe,a(r.$t("Montant total")),1),e(D),u("div",Ke,[e(C,{color:"primary",icon:"",flat:""},{default:t(()=>[e(J)]),_:1})])]),u("div",We,[u("h2",Xe,a(V(Z)(c.value||0)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(P,{cols:"12",class:"h-50 align-end justify-end align-content-end"},{default:t(()=>[e(N,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[l.value.status==V(d).statuses.cancelled?(f(),b(P,{key:0,class:"h-100",cols:"12",md:"6"},{default:t(()=>[e(L,{elevation:"10",class:"h-100"},{default:t(()=>[e(M,null,{default:t(()=>[u("div",Ze,[u("h2",Ge,a(r.$t("Raison de l'annulation")),1)]),u("div",He,[u("p",Je,a(l.value.cancel_comment||r.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1})):T("",!0),e(P,{class:"h-100",cols:"12",md:l.value.status==V(d).statuses.cancelled?"6":"12"},{default:t(()=>[e(L,{elevation:"10",class:"h-100"},{default:t(()=>[e(M,null,{default:t(()=>[u("div",Ye,[u("h2",et,a(r.$t("Note liée à la prestation")),1)]),u("div",tt,[u("p",at,a(l.value.comment||r.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})]),_:1})]),_:1})]),_:1}),e(P,{cols:"12",lg:l.value.status>V(d).statuses.started?"6":"12"},{default:t(()=>[e(L,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(ee,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[u("h4",lt,[u("span",null,a(r.$t("Désignation des services attendus")),1),e(D),l.value.status<V(d).statuses.processing?(f(),b(ne,{key:0,modelValue:i.value,"onUpdate:modelValue":y[5]||(y[5]=x=>i.value=x),prestation:l.value,"onUpdate:item":g,"button-text":r.$t("Ajouter un service"),title:r.$t("Ajouter un service")},null,8,["modelValue","prestation","button-text","title"])):T("",!0)])]),_:1}),e(M,{class:"pa-6"},{default:t(()=>[e(ue,{class:"month-table"},{default:t(()=>[u("thead",null,[u("tr",null,[u("th",st,a(r.$t("Désignation")),1),u("th",ot,a(r.$t("Quantité")),1),u("th",ut,a(r.$t("Prix unitaire")),1),u("th",nt,a(r.$t("Prix total")),1),u("th",rt,a(r.$t("Actions")),1)])]),u("tbody",null,[(f(!0),O(Y,null,oe(l.value.services,(x,X)=>(f(),O("tr",{key:x.id,class:"month-item"},[u("td",null,a(x.name),1),u("td",null,a(x.quantity),1),u("td",null,a(V(Z)(x.price)),1),u("td",null,a(V(Z)(x.total)),1),u("td",null,[l.value.status<V(d).statuses.processing?(f(),O("div",dt,[e(_e,{text:r.$t("Modifier")},{activator:t(({props:se})=>[e(ne,{modelValue:l.value.services[X],"onUpdate:modelValue":ie=>l.value.services[X]=ie,prestation:l.value,"onUpdate:item":g,"button-text":r.$t("Modifier le service"),title:r.$t("Modifier le service")},null,8,["modelValue","onUpdate:modelValue","prestation","button-text","title"])]),_:2},1032,["text"]),e(De,{modelValue:l.value,"onUpdate:modelValue":y[6]||(y[6]=se=>l.value=se),service:l.value.services[X]},null,8,["modelValue","service"])])):T("",!0)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"]),l.value.status>V(d).statuses.started?(f(),b(P,{key:0,cols:"12",lg:l.value.status>V(d).statuses.started?"6":"12"},{default:t(()=>[e(L,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(ee,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[u("h4",it,[u("span",null,a(r.$t("Paiements")),1),e(D),l.value.status<V(d).statuses.closed?(f(),b(Me,{key:0,modelValue:o.value,"onUpdate:modelValue":y[7]||(y[7]=x=>o.value=x),prestation:l.value,"onUpdate:item":g,"button-text":r.$t("Ajouter un paiement"),title:r.$t("Ajouter un paiement")},null,8,["modelValue","prestation","button-text","title"])):T("",!0)])]),_:1}),e(M,{class:"pa-6"},{default:t(()=>[e(ue,{class:"month-table"},{default:t(()=>[u("thead",null,[u("tr",null,[u("th",mt,a(r.$t("Mode de paiement")),1),u("th",ct,a(r.$t("Montant payé")),1),u("th",vt,a(r.$t("Date du paiement")),1)])]),u("tbody",null,[(f(!0),O(Y,null,oe(l.value.payments,(x,X)=>(f(),O("tr",{key:x.id},[u("td",null,a(x.payment_method),1),u("td",null,a(x.amount),1),u("td",null,a(V(F)(x.created_at)),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"])):T("",!0)]),_:1}))],64)}}});export{Et as default};
