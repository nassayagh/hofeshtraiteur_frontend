import{u as he}from"./payments-CNWrJHI-.js";import{u as pe}from"./eventType-CiW_NwR-.js";import{u as ve}from"./paymentMethod-BussdfIa.js";import{_ as ge}from"./BaseBreadcrumb-CB9g-Nme.js";import{f as L,a as _e}from"./formatters-ChhyeSK0.js";import{a6 as le,Z as G,o as m,_ as x,w as t,b as e,a as s,t as i,V as p,a8 as h,c as w,a4 as f,aJ as ye,r as l,av as we,aK as _,h as be,e as j,g as Ve,q as Pe,n as ee,d as $,X as ke}from"./index-DPZztH9X.js";import{u as xe}from"./Controller-yAgY4EPl.js";import{V as v,a as N}from"./VRow-Bm15jFuu.js";import{V as P,a as b,b as $e,c as De}from"./VCard-B5CcMp7v.js";import{a as y}from"./VSpacer-DRAL-vqi.js";import{V as Ce}from"./VDataTableServer-CQAfMd-l.js";import{V as Se}from"./VToolbar-CgsRc2BM.js";import{V as te}from"./VTextField-DEgGgLCB.js";import{b as ae}from"./VSelect-CGAhY-3L.js";import{V as se}from"./VDialog-Df0kMf4O.js";import{V as Te}from"./VLocaleProvider-B1Gc8JLJ.js";import{V as Be}from"./VDatePicker-CcVENDaQ.js";import{V as Ie}from"./VTooltip-4AWh0zmE.js";import"./VAvatar-Cqzzm8fb.js";import"./filter-D5xaSG18.js";import"./VMenu-C9pIWCM1.js";import"./VSheet-DwT8Mg-k.js";const Me={class:"d-flex align-start"},Ue={class:"text-h4"},Ee={class:"ml-auto"},Ae={class:"mt-2"},je={class:"text-h4 font-weight-regular"},Le={key:0,class:"text-subtitle-1"},Ne={class:"d-flex align-start"},Re={class:"text-h4"},Ke={class:"ml-auto"},Oe={class:"mt-2"},Fe={class:"text-h4 font-weight-regular"},Ge={key:0,class:"text-subtitle-1"},He={class:"d-flex align-start"},qe={class:"text-h4"},ze={class:"ml-auto"},Je={class:"mt-2"},Xe={class:"text-h4 font-weight-regular"},Ze={key:0,class:"text-subtitle-1"},Qe={class:"d-flex align-start"},We={class:"text-h4"},Ye={class:"ml-auto"},et={class:"mt-2"},tt={class:"text-h4 font-weight-regular"},at={key:0,class:"text-subtitle-1"},st={class:"d-flex align-start"},lt={class:"text-h4"},ot={class:"ml-auto"},nt={class:"mt-2"},it={class:"text-h4 font-weight-regular"},rt={key:0,class:"text-subtitle-1"},dt={class:"d-flex align-start"},ut={class:"text-h4"},ct={class:"ml-auto"},mt={class:"mt-2"},ft={class:"text-h4 font-weight-regular"},ht={key:0,class:"text-subtitle-1"},pt={class:"d-flex align-start"},vt={class:"text-h4"},gt={class:"ml-auto"},_t={class:"mt-2"},yt={class:"text-h4 font-weight-regular"},wt={key:0,class:"text-subtitle-1"},bt={class:"d-flex align-start"},Vt={class:"text-h4"},Pt={class:"ml-auto"},kt={class:"mt-2"},xt={class:"text-h4 font-weight-regular"},$t={key:0,class:"text-subtitle-1"},Dt=le({__name:"PrespationDashboard",props:{showDescription:{type:Boolean,default:!1},showPayments:{type:Boolean,default:!1},showValidation:{type:Boolean,default:!1},showValidated:{type:Boolean,default:!1},showProcessing:{type:Boolean,default:!1},showClosed:{type:Boolean,default:!1},showCancelled:{type:Boolean,default:!1},showTotalPayments:{type:Boolean,default:!1},md:{type:String,default:"3"}},setup(d){const c=xe();return c.fetchStatistics({}),(u,H)=>{const C=G("CurrencyEuroIcon"),k=G("HotelServiceIcon");return d.showPayments?(m(),x(N,{key:0},{default:t(()=>[d.showTotalPayments?(m(),x(v,{key:0,class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Me,[s("h2",Ue,i(u.$t("Montant total")),1),e(y),s("div",Ee,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(C,{class:"text-info"})]),_:1})])]),s("div",Ae,[s("h2",je,i(h(L)(h(c).statistics.totalPayments||0)),1),d.showDescription?(m(),w("span",Le,i(u.$t("Montant total de service")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),e(v,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Ne,[s("h2",Re,i(u.$t("Montant à régler")),1),e(y),s("div",Ke,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(C,{class:"text-primary"})]),_:1})])]),s("div",Oe,[s("h2",Fe,i(h(L)(h(c).statistics.paymentsLeft||0)),1),d.showDescription?(m(),w("span",Ge,i(u.$t("Montant restant à régler")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),e(v,{class:"h-100",cols:"12",md:d.showTotalPayments?"4":"6"},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",He,[s("h2",qe,i(u.$t("Montant réglé")),1),e(y),s("div",ze,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(C,{class:"text-success"})]),_:1})])]),s("div",Je,[s("h2",Xe,i(h(L)(h(c).statistics.paymentsReceived||0)),1),d.showDescription?(m(),w("span",Ze,i(u.$t("Montant total déjà réglé")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})):(m(),x(N,{key:1},{default:t(()=>[e(v,{class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-primary h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",Qe,[s("h2",We,i(u.$t("Prestations")),1),e(y),s("div",Ye,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-primary"})]),_:1})])]),s("div",et,[s("h2",tt,i(h(c).statistics.total||0),1),d.showDescription?(m(),w("span",at,i(u.$t("Prestations total")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"]),d.showValidation?(m(),x(v,{key:0,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-success h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",st,[s("h2",lt,i(u.$t("Prestations validées")),1),e(y),s("div",ot,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-success"})]),_:1})])]),s("div",nt,[s("h2",it,i(h(c).statistics.validated||0),1),d.showDescription?(m(),w("span",rt,i(u.$t("Prestations total validées")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),d.showValidated?(m(),x(v,{key:1,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",dt,[s("h2",ut,i(u.$t("Prestations en validation")),1),e(y),s("div",ct,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",mt,[s("h2",ft,i(h(c).statistics.validation||0),1),d.showDescription?(m(),w("span",ht,i(u.$t("Prestations total en attende de validation")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),d.showClosed?(m(),x(v,{key:2,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-info h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",pt,[s("h2",vt,i(u.$t("Prestations Clôturée")),1),e(y),s("div",gt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-info"})]),_:1})])]),s("div",_t,[s("h2",yt,i(h(c).statistics.closed||0),1),d.showDescription?(m(),w("span",wt,i(u.$t("Prestations total Clôturée")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0),d.showCancelled?(m(),x(v,{key:3,class:"h-100",cols:"12",md:d.md},{default:t(()=>[e(b,{elevation:"10",class:"bg-error h-100"},{default:t(()=>[e(P,null,{default:t(()=>[s("div",bt,[s("h2",Vt,i(u.$t("Prestations annulées")),1),e(y),s("div",Pt,[e(p,{depressed:"",color:"white",class:"btn-custom-sm",small:"",icon:""},{default:t(()=>[e(k,{class:"text-error"})]),_:1})])]),s("div",kt,[s("h2",xt,i(h(c).statistics.cancelled||0),1),d.showDescription?(m(),w("span",$t,i(u.$t("Prestations total annulées")),1)):f("",!0)])]),_:1})]),_:1})]),_:1},8,["md"])):f("",!0)]),_:1}))}}}),Ct={class:"d-flex align-center"},Wt=le({__name:"List",setup(d){const c=ye();l();const u=we(),H=pe(),C=ve(),k=l({title:"Gestion des paiements"}),oe=l([{text:_("Dashboard"),disabled:!1,href:"/"},{text:_("Gestion des paiements"),disabled:!0,href:"#"}]),I=l([]),q=l([]),z=l([]),R=he();be(()=>{Q(),ce(),me()});const S=l(!1);l(!1),l(!1),l(!1),l(!1),l(""),l(),l(!1);const J=l(null);l(null),l(null),l(null);const M=l(!1);l();const K=l(100),T=l(2),U=l(2),E=l(0);l(!1);const ne=l(!1);l(null);const O=l("");l(["primary","secondary","error","success","warning"]);const D=l([{key:"payment_date",order:"DESC"}]);l(0);const r=l({search:null,status:null,date:null,event_type:null}),B=l({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"payment_date",order:"DESC"}]}),ie=l(-1),X=l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});l({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const A=l(!1),re=l([{title:_("Prénom"),align:"start",key:"prestation.customer.firstname",sortable:!1},{title:_("Nom"),align:"start",key:"prestation.customer.lastname",sortable:!1},{title:_("Email"),align:"start",key:"prestation.customer.email",sortable:!1},{title:_("Téléphone"),align:"start",key:"prestation.customer.phone",sortable:!1},{title:_("Prestation"),align:"start",key:"prestation.event_type"},{title:_("Mode de paiement"),align:"start",key:"payment_method"},{title:_("Montant payé"),align:"start",key:"amount"},{title:_("Date du paiement"),align:"start",key:"payment_date"},{title:"Actions",key:"actions",sortable:!1}]),Z=j(()=>r.value.date&&r.value.date.length>0?c.format(r.value.date[0],"shortDate")+" - "+c.format(r.value.date[r.value.date.length-1],"shortDate"):null);j(()=>R.payments.data.filter(n=>n.email.toLowerCase().includes(O.value.toLowerCase())));function de(){R.deleteItem(X.value.id);const n=I.value.findIndex(a=>a.id==X.value.id);I.value.splice(n,1),A.value=!1,u.showSuccess(_("Utilisateur supprimé avec succès"))}j(()=>ie.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const ue=j(()=>r.value.date&&r.value.date.length?r.value.date.length>1?[c.format(r.value.date[0],"shortDate"),c.format(r.value.date[r.value.date.length-1],"shortDate")]:[c.format(r.value.date[0],"shortDate"),c.format(r.value.date[0],"shortDate")]:null);function Q(){try{clearTimeout(J.value)}catch{}J.value=setTimeout(()=>{S.value=!0;let n="id",a="desc";console.log(D.value),D.value.length>0&&(n=D.value[0].key,a=D.value[0].order),R.fetchItems({term:O.value,paginate:K.value,current_page:T.value,direction:a,order_by:n,page:B.value.page,per_page:B.value.itemsPerPage,...r.value,date:ue.value}).then(V=>{if(V.data){const{data:o,current_page:g,next_page_url:W,total:F,per_page:Y,to:St,last_page:fe}=V.data;I.value=o,U.value=fe,E.value=F}}).catch(V=>{console.error(V)}).then(()=>{S.value=!1})},1e3)}function ce(){H.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:o,total:g,per_page:W,to:F,last_page:Y}=n.data;q.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}function me(){C.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(n=>{if(n.data){const{data:a,current_page:V,next_page_url:o,total:g,per_page:W,to:F,last_page:Y}=n.data;z.value=a}}).catch(n=>{console.error(n)}).then(()=>{S.value=!1})}return Ve([O,B,r],()=>{Q()},{deep:!0}),Pe(()=>{T.value>U.value&&(T.value=U.value)}),(n,a)=>{const V=G("EyeIcon");return m(),w(ke,null,[e(ge,{title:`${k.value.title}(${E.value})`,breadcrumbs:oe.value},null,8,["title","breadcrumbs"]),e(Dt,{"show-payments":"","show-description":"","show-total-payments":""}),e(N,null,{default:t(()=>[e(v,{cols:"12"},{default:t(()=>[e(Ce,{class:"border rounded-md",headers:re.value,loading:S.value,items:I.value,"multi-sort":!1,"items-per-page":K.value,"onUpdate:itemsPerPage":a[12]||(a[12]=o=>K.value=o),"items-per-page-text":n.$t("Articles par page"),options:B.value,"onUpdate:options":a[13]||(a[13]=o=>B.value=o),"sort-by":D.value,"onUpdate:sortBy":a[14]||(a[14]=o=>D.value=o),page:T.value,"onUpdate:page":a[15]||(a[15]=o=>T.value=o),"items-length":E.value,"onUpdate:itemsLength":a[16]||(a[16]=o=>E.value=o),"show-select":!1,"loading-text":n.$t("Chargement des éléments"),"no-data-text":n.$t("Pas de données"),"no-results-text":n.$t("Aucun résultat"),onPageCount:a[17]||(a[17]=o=>U.value=o)},{top:t(()=>[e(Se,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:t(()=>[e(N,null,{default:t(()=>[e(v,null,{default:t(()=>[e(te,{density:"compact",modelValue:r.value.search,"onUpdate:modelValue":a[0]||(a[0]=o=>r.value.search=o),placeholder:n.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),e(v,null,{default:t(()=>[e(ae,{density:"compact",modelValue:r.value.event_type,"onUpdate:modelValue":a[1]||(a[1]=o=>r.value.event_type=o),placeholder:n.$t("Prestation"),items:q.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(v,null,{default:t(()=>[e(ae,{density:"compact",modelValue:r.value.payment_method,"onUpdate:modelValue":a[2]||(a[2]=o=>r.value.payment_method=o),placeholder:n.$t("Mode de paiement"),items:z.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo",clearable:""},null,8,["modelValue","placeholder","items"])]),_:1}),e(v,null,{default:t(()=>[e(se,{ref_key:"dialog",ref:ne,modelValue:M.value,"onUpdate:modelValue":a[8]||(a[8]=o=>M.value=o),"return-value":r.value.date,"onUpdate:returnValue":a[9]||(a[9]=o=>r.value.date=o),persistent:"",width:"290px"},{activator:t(({props:o})=>[e(te,ee({modelValue:Z.value,"onUpdate:modelValue":a[3]||(a[3]=g=>Z.value=g),"prepend-inner-icon":"bx-calendar",readonly:""},o,{density:"compact",placeholder:n.$t("Date"),"hide-details":"",variant:"solo",clearable:"","onClick:clear":a[4]||(a[4]=g=>r.value.date=null)}),null,16,["modelValue","placeholder"])]),default:t(({isActive:o})=>[e(Te,{locale:"fr"},{default:t(()=>[e(Be,{modelValue:r.value.date,"onUpdate:modelValue":a[7]||(a[7]=g=>r.value.date=g),"hide-header":"",multiple:"range"},{actions:t(()=>[e(p,{color:"primary",onClick:a[5]||(a[5]=g=>M.value=!1)},{default:t(()=>[$(i(n.$t("Annuler")),1)]),_:1}),e(y),e(p,{variant:"elevated",color:"primary",onClick:a[6]||(a[6]=g=>M.value=!1)},{default:t(()=>[$(i(n.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),e(se,{modelValue:A.value,"onUpdate:modelValue":a[11]||(a[11]=o=>A.value=o),"max-width":"500px"},{default:t(()=>[e(b,null,{default:t(()=>[e($e,{class:"text-h5 text-center py-6"},{default:t(()=>[$(i(n.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),e(De,null,{default:t(()=>[e(y),e(p,{color:"error",variant:"flat",dark:"",onClick:a[10]||(a[10]=o=>A.value=!1)},{default:t(()=>[$(i(n.$t("Annuler")),1)]),_:1}),e(p,{color:"success",variant:"flat",dark:"",onClick:de},{default:t(()=>[$(i(n.$t("OK")),1)]),_:1}),e(y)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.amount":t(({item:o})=>[$(i(h(L)(o.amount)),1)]),"item.payment_date":t(({item:o})=>[$(i(h(_e)(o.payment_date)),1)]),"item.actions":t(({item:o})=>[s("div",Ct,[e(Ie,{text:n.$t("Voir la prestation liée")},{activator:t(({props:g})=>[e(p,ee({icon:"",flat:"",to:"/prestations/"+o.prestation_id},g),{default:t(()=>[e(V,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["to"])]),_:2},1032,["text"])])]),"no-data":t(()=>[s("span",null,i(n.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64)}}});export{Wt as default};
