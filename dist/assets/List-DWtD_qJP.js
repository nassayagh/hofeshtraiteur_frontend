import{u as ie}from"./hall-Dq7HmS3W.js";import{_ as de,a as f}from"./BaseBreadcrumb-SFhi0e60.js";import{r as me}from"./validators-BPi-vT8z.js";import{a6 as ve,r as s,av as pe,aD as r,h as fe,e as ge,g as be,q as Ve,o as q,c as L,b as l,w as t,V as T,n as ce,d,t as i,a as V,a8 as H,a4 as ke,ae as I,af as _,ac as K,X as $e}from"./index-BjFWTEr_.js";import{F as ye,V as Ce}from"./vee-validate.esm-D2e16B8d.js";import{V as v,a as X}from"./VRow-CeV0ez7H.js";import{V as Ue}from"./VDataTableServer-DLseUT65.js";import{V as Pe,a as Te}from"./VToolbar-CoawaqQ_.js";import{V as c}from"./VTextField-CWkQ8t64.js";import{i as O}from"./VSpacer-zVSMWsYI.js";import{V as J}from"./VDialog-suZyWcBK.js";import{a as Q,b as W,V as Se,c as Y}from"./VCard-Ds3PvDnC.js";import{V as Ne}from"./VContainer-yHGJ-PEc.js";import{V as we}from"./VTextarea-M9eqSA2_.js";import{V as h}from"./VTooltip-CwuJ1zkF.js";import"./VAvatar-XjD8XNVT.js";const Ae={class:"text-h5"},Ie={key:0,class:"mt-2"},Ye=ve({__name:"List",setup(_e){const E=s(),D=pe(),Z=s({title:"Gestions des salles"}),x=s([{text:r("Tableau de bord"),disabled:!1,href:"/"},{text:r("Salles"),disabled:!0,href:"#"}]),p=s([]),B=ie();fe(()=>{R()});const k=s(!1),$=s(!1),j=s(null),F=s(100),y=s(2),S=s(2),N=s(0),M=s(!1),C=s(!1),w=s("");s(["primary","secondary","error","success","warning"]);const g=s([{key:"name",order:"ASC"}]);s(0);const U=s({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"name",order:"ASC"}]}),b=s([{id:0,label:r("Non")},{id:1,label:r("Oui")}]),ee=s([{id:"salle",label:r("Géré par la salle")},{id:"client",label:r("Géré par le client")}]),A=s(-1),n=s({id:null,name:"",description:"",price:0,status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),z=s({id:null,name:"",description:"",status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),P=s(!1),le=s([{title:"Actions",key:"actions",sortable:!1},{title:r("Nom"),align:"start",key:"name"},{title:r("Adrse"),align:"start",key:"address"},{title:r("Nom.régis"),align:"start",key:"manager_name"},{title:r("Tél.rég"),align:"start",key:"manager_phone"},{title:r("Mail.rég"),align:"start",key:"manager_email"},{title:r("Parking"),align:"start",key:"packing"},{title:r("Cuisine"),align:"start",key:"kitchen"},{title:r("Chambre"),align:"start",key:"cold_room"},{title:r("Escalier"),align:"start",key:"ladder"},{title:r("Bac"),align:"start",key:"bin"},{title:r("Frais"),align:"start",key:"transportation_fee"},{title:r("Table"),align:"start",key:"transportation_fee"},{title:r("Cmt"),align:"start",key:"comment"}]);function G(o){k.value=!1,A.value=p.value.indexOf(o),n.value=Object.assign({},o),C.value=!0}function ae(o){n.value=o,P.value=!0}function te(){C.value=!1,setTimeout(()=>{n.value=Object.assign({},z.value),A.value=-1},300)}function oe(o,{setErrors:a}){var e;(e=E.value)==null||e.validate().then(({valid:m})=>{m&&($.value=!0,B.addItem(n.value).then(u=>{if(u.data.error){a({apiError:u.data.message});return}n.value.id!=null?Object.assign(p.value[A.value],u.data):p.value.unshift(u.data),$.value=!1,k.value=!1,C.value=!1,n.value={changePassword:!0},D.showSuccess(r("Salle sauvée avec succès"))}).catch(u=>{$.value=!1,a({apiError:u})}).then(()=>{$.value=!1,a({apiError:null})}))})}function ne(){B.deleteItem(n.value.id);const o=p.value.findIndex(a=>a.id==n.value.id);p.value.splice(o,1),P.value=!1,D.showSuccess(r("Salle supprimé avec succès"))}const ue=ge(()=>A.value===-1?r("Nouvel salle"):r("Modifier la salle"));function R(){try{clearTimeout(j.value)}catch{}j.value=setTimeout(()=>{k.value=!0;let o="id",a="desc";console.log(g.value),g.value.length>0&&(o=g.value[0].key,a=g.value[0].order),B.fetchItems({term:w.value,paginate:F.value,current_page:y.value,direction:a,order_by:o,page:U.value.page,per_page:U.value.itemsPerPage}).then(e=>{if(e.data){const{data:m,current_page:u,next_page_url:Oe,total:se,per_page:he,to:Be,last_page:re}=e.data;p.value=m,S.value=re,N.value=se}}).catch(e=>{console.error(e)}).then(()=>{k.value=!1})},1e3)}return be([w,U],()=>{R()},{deep:!0}),Ve(()=>{y.value>S.value&&(y.value=S.value)}),(o,a)=>(q(),L($e,null,[l(de,{title:`${Z.value.title}(${N.value})`,breadcrumbs:x.value},null,8,["title","breadcrumbs"]),l(X,null,{default:t(()=>[l(v,{cols:"12"},{default:t(()=>[l(Ue,{class:"border rounded-md",headers:le.value,loading:k.value,items:p.value,"multi-sort":!1,"items-per-page":F.value,"onUpdate:itemsPerPage":a[19]||(a[19]=e=>F.value=e),"items-per-page-text":o.$t("Articles par page"),options:U.value,"onUpdate:options":a[20]||(a[20]=e=>U.value=e),"sort-by":g.value,"onUpdate:sortBy":a[21]||(a[21]=e=>g.value=e),page:y.value,"onUpdate:page":a[22]||(a[22]=e=>y.value=e),"items-length":N.value,"onUpdate:itemsLength":a[23]||(a[23]=e=>N.value=e),"show-select":!1,"loading-text":o.$t("Chargement des éléments"),"no-data-text":o.$t("Pas de données"),"no-results-text":o.$t("Aucun résultat"),onPageCount:a[24]||(a[24]=e=>S.value=e)},{top:t(()=>[l(Pe,{class:"rounded-t-md",flat:""},{default:t(()=>[l(Te,null,{default:t(()=>[l(c,{density:"compact",modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),placeholder:o.$t("Rechercher..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),l(O),l(J,{modelValue:C.value,"onUpdate:modelValue":a[16]||(a[16]=e=>C.value=e),"max-width":"750px"},{activator:t(({props:e})=>[l(T,ce({color:"primary",variant:"flat",onClick:a[1]||(a[1]=m=>G=z.value),dark:""},e),{default:t(()=>[d(i(o.$t("Ajouter une salle")),1)]),_:2},1040)]),default:t(()=>[l(Q,null,{default:t(()=>[l(W,{class:"pa-4 bg-secondary"},{default:t(()=>[V("span",Ae,i(ue.value),1)]),_:1}),l(H(ye),{ref_key:"refForm",ref:E,modelValue:M.value,"onUpdate:modelValue":a[15]||(a[15]=e=>M.value=e),onSubmit:oe},{default:t(({errors:e,isSubmitting:m})=>[l(Se,null,{default:t(()=>[l(Ne,{class:"px-0"},{default:t(()=>[l(X,null,{default:t(()=>[l(v,{cols:"12",md:"6"},{default:t(()=>[l(c,{modelValue:n.value.name,"onUpdate:modelValue":a[2]||(a[2]=u=>n.value.name=u),rules:[H(me)],label:o.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1}),l(v,{cols:"12",md:"6"},{default:t(()=>[l(c,{modelValue:n.value.address,"onUpdate:modelValue":a[3]||(a[3]=u=>n.value.address=u),label:o.$t("Adresse de la salle")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(c,{modelValue:n.value.manager_name,"onUpdate:modelValue":a[4]||(a[4]=u=>n.value.manager_name=u),label:o.$t("Nom du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(c,{modelValue:n.value.manager_phone,"onUpdate:modelValue":a[5]||(a[5]=u=>n.value.manager_phone=u),label:o.$t("Téléphone du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(c,{modelValue:n.value.manager_email,"onUpdate:modelValue":a[6]||(a[6]=u=>n.value.manager_email=u),label:o.$t("Mail du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.packing,"onUpdate:modelValue":a[7]||(a[7]=u=>n.value.packing=u),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Parking"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.kitchen,"onUpdate:modelValue":a[8]||(a[8]=u=>n.value.kitchen=u),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Cuisine"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.cold_room,"onUpdate:modelValue":a[9]||(a[9]=u=>n.value.cold_room=u),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Chambre froidre"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.ladder,"onUpdate:modelValue":a[10]||(a[10]=u=>n.value.ladder=u),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Escalier pour déchargement"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(f,{modelValue:n.value.bin,"onUpdate:modelValue":a[11]||(a[11]=u=>n.value.bin=u),items:ee.value,"item-title":"label","item-value":"id",label:o.$t("Bac de poubelle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(f,{modelValue:n.value.transportation_fee,"onUpdate:modelValue":a[12]||(a[12]=u=>n.value.transportation_fee=u),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Frais de déplacement à prévoir"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(f,{modelValue:n.value.table,"onUpdate:modelValue":a[13]||(a[13]=u=>n.value.table=u),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Table de buffet présent dans la salle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12"},{default:t(()=>[l(we,{modelValue:n.value.comment,"onUpdate:modelValue":a[14]||(a[14]=u=>n.value.comment=u),label:o.$t("Commentaire")},null,8,["modelValue","label"])]),_:1})]),_:1}),e.apiError?(q(),L("div",Ie,[l(Ce,{color:"error"},{default:t(()=>[d(i(e.apiError),1)]),_:2},1024)])):ke("",!0)]),_:2},1024)]),_:2},1024),l(Y,null,{default:t(()=>[l(O),l(T,{color:"error",variant:"flat",dark:"",onClick:te},{default:t(()=>[d(i(o.$t("Annuler")),1)]),_:1}),l(T,{color:"success",variant:"flat",loading:$.value,type:"submit"},{default:t(()=>[d(i(o.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(J,{modelValue:P.value,"onUpdate:modelValue":a[18]||(a[18]=e=>P.value=e),"max-width":"500px"},{default:t(()=>[l(Q,null,{default:t(()=>[l(W,{class:"text-h5 text-center py-6"},{default:t(()=>[d(i(o.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),l(Y,null,{default:t(()=>[l(O),l(T,{color:"error",variant:"flat",dark:"",onClick:a[17]||(a[17]=e=>P.value=!1)},{default:t(()=>[d(i(o.$t("Annuler")),1)]),_:1}),l(T,{color:"success",variant:"flat",dark:"",onClick:ne},{default:t(()=>[d(i(o.$t("OK")),1)]),_:1}),l(O)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.address":t(({item:e})=>[l(h,{text:e.address},{activator:t(({props:m})=>[V("span",I(_(m)),i(!e.address||e.address.length<10?e.address:`${e.address.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.manager_email":t(({item:e})=>[l(h,{text:e.manager_email},{activator:t(({props:m})=>[V("span",I(_(m)),i(!e.manager_email||e.manager_email.length<10?e.manager_email:`${e.manager_email.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.manager_name":t(({item:e})=>[l(h,{text:e.manager_name},{activator:t(({props:m})=>[V("span",I(_(m)),i(!e.manager_name||e.manager_name.length<10?e.manager_name:`${e.manager_name.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.packing":t(({item:e})=>[d(i(e.packing?o.$t("Oui"):o.$t("Non")),1)]),"item.kitchen":t(({item:e})=>[d(i(e.kitchen?o.$t("Oui"):o.$t("Non")),1)]),"item.cold_room":t(({item:e})=>[d(i(e.cold_room?o.$t("Oui"):o.$t("Non")),1)]),"item.ladder":t(({item:e})=>[d(i(e.ladder?o.$t("Oui"):o.$t("Non")),1)]),"item.table":t(({item:e})=>[d(i(e.table?o.$t("Oui"):o.$t("Non")),1)]),"item.transportation_fee":t(({item:e})=>[d(i(e.transportation_fee?o.$t("Oui"):o.$t("Non")),1)]),"item.bin":t(({item:e})=>[d(i(e.bin=="salle"?o.$t("Salle"):o.$t("Client")),1)]),"item.comment":t(({item:e})=>[l(h,{text:e.comment},{activator:t(({props:m})=>[V("span",I(_(m)),i(!e.comment||e.comment.length<10?e.comment:`${e.comment.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.actions":t(({item:e})=>[l(K,{color:"info",size:"small",class:"me-2",onClick:m=>G(e)},{default:t(()=>[d(" mdi-pencil ")]),_:2},1032,["onClick"]),l(K,{color:"error",size:"small",onClick:m=>ae(e)},{default:t(()=>[d(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":t(()=>[V("span",null,i(o.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{Ye as default};
