import{u as Y}from"./demands-Dky71OLi.js";import{u as Z}from"./eventType-BUh3A0pt.js";import{_ as ee}from"./BaseBreadcrumb-CZWnI0nK.js";import{f as te}from"./formatters-Dv1Ro_l4.js";import{O as ae,ad as le,r as a,aa as oe,ae as $,h as re,e as k,g as se,q as ne,o as ue,c as de,b as l,w as r,n as ie,V as c,d,t as n,Q as x,a as me,M as pe}from"./index--eSAaoua.js";import{V as D,a as B}from"./VRow-BqVouQvo.js";import{V as ve}from"./VDataTableServer-BSZaLEkB.js";import{V as fe}from"./VToolbar-v-kq36CI.js";import{V as j}from"./VTextField-BIunycXo.js";import{V as ce}from"./VSelect-C3ZqDHK6.js";import{V as L}from"./VDialog-cLqV7fjH.js";import{V as ge}from"./VLocaleProvider-BbsbWvyY.js";import{V as Ve}from"./VDatePicker-_UbfQL0K.js";import{V as S}from"./VSpacer-BLion4vj.js";import{V as ye,a as he,b as be}from"./VCard-C_EOskDD.js";import{V as ke}from"./VChip-BkiHneXL.js";/* empty css              */import"./VDataTable-BW0Rty__.js";import"./VCheckboxBtn-zj9NycWb.js";import"./VSelectionControl-CgstZIWm.js";import"./VLabel-YNF6VYNN.js";import"./VTable-BUYeiApe.js";import"./filter-BdPhCt1f.js";import"./VDivider-DAcvfAJ7.js";import"./index-DyKrsRPI.js";import"./VAvatar-DO5dze8k.js";/* empty css                   */import"./VField-CkYLJqxY.js";import"./VInput-BZmnskkf.js";import"./VList-BFwTxV7r.js";import"./ssrBoot-7kARyJyG.js";import"./createSimpleFunctional-BNLeBn9G.js";import"./dialog-transition-mxOinYMm.js";import"./VMenu-B-yKHGiX.js";import"./VSheet-hEtF3JVK.js";import"./VSlideGroup-xxvn732U.js";const st=ae({__name:"List",setup(De){const i=le();a();const N=oe(),M=Z(),O=a({title:"Gestion des devis"}),R=a([{text:$("Dashboard"),disabled:!1,href:"/"},{text:$("Gestion des devis"),disabled:!0,href:"#"}]),g=a([]),U=a([]),p=Y();re(()=>{E(),Q()});const V=a(!1);a(!1),a(!1),a(!1),a(!1),a(""),a(),a(!1);const T=a(null);a(null),a(null),a(null);const y=a(!1);a();const P=a(10),v=a(2),h=a(2),C=a(0);a(!1);const F=a(!1);a(null);const w=a("");a(["primary","secondary","error","success","warning"]);const m=a([{key:"demand_date",order:"DESC"}]);a(0);const s=a({search:null,status:null,date:null,event_type:null}),f=a({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"demand_date",order:"DESC"}]}),G=a(-1),_=a({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});a({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const b=a(!1),K=a([{title:"Prénom",align:"start",key:"customer.firstname",sortable:!1},{title:"Nom",align:"start",key:"customer.lastname",sortable:!1},{title:"Email",align:"start",key:"customer.email",sortable:!1},{title:"Téléphone",align:"start",key:"customer.phone",sortable:!1},{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la demande",align:"start",key:"demand_date"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),A=k(()=>s.value.date&&s.value.date.length>0?i.format(s.value.date[0],"shortDate")+" - "+i.format(s.value.date[s.value.date.length-1],"shortDate"):null);k(()=>p.demands.data.filter(o=>o.email.toLowerCase().includes(w.value.toLowerCase())));function q(){p.deleteItem(_.value.id);const o=g.value.findIndex(e=>e.id==_.value.id);g.value.splice(o,1),b.value=!1,N.showSuccess($("Utilisateur supprimé avec succès"))}k(()=>G.value===-1?"Nouvel administrateur":"Modifier l’administrateur");const z=k(()=>s.value.date&&s.value.date.length?s.value.date.length>1?[i.format(s.value.date[0],"shortDate"),i.format(s.value.date[s.value.date.length-1],"shortDate")]:[i.format(s.value.date[0],"shortDate"),i.format(s.value.date[0],"shortDate")]:null);function E(){try{clearTimeout(T.value)}catch{}T.value=setTimeout(()=>{V.value=!0;let o="id",e="desc";console.log(m.value),m.value.length>0&&(o=m.value[0].key,e=m.value[0].order),p.fetchItems({term:w.value,paginate:P.value,current_page:v.value,direction:e,order_by:o,page:f.value.page,per_page:f.value.itemsPerPage,...s.value,date:z.value}).then(t=>{if(t.data){const{data:u,current_page:H,next_page_url:J,total:I,per_page:W,to:Pe,last_page:X}=t.data;g.value=u,h.value=X,C.value=I}}).catch(t=>{console.error(t)}).then(()=>{V.value=!1})},1e3)}function Q(){M.fetchItems({term:"",paginate:500,current_page:1,direction:"asc",order_by:"name",page:1,per_page:500}).then(o=>{if(o.data){const{data:e,current_page:t,next_page_url:u,total:H,per_page:J,to:I,last_page:W}=o.data;U.value=e}}).catch(o=>{console.error(o)}).then(()=>{V.value=!1})}return se([w,f,s],()=>{E()},{deep:!0}),ne(()=>{v.value>h.value&&(v.value=h.value)}),(o,e)=>(ue(),de(pe,null,[l(ee,{title:O.value.title,breadcrumbs:R.value},null,8,["title","breadcrumbs"]),l(B,null,{default:r(()=>[l(D,{cols:"12"},{default:r(()=>[l(ve,{class:"border rounded-md",headers:K.value,loading:V.value,items:g.value,"multi-sort":!1,"items-per-page":P.value,"onUpdate:itemsPerPage":e[10]||(e[10]=t=>P.value=t),"items-per-page-text":o.$t("Articles par page"),options:f.value,"onUpdate:options":e[11]||(e[11]=t=>f.value=t),"sort-by":m.value,"onUpdate:sortBy":e[12]||(e[12]=t=>m.value=t),page:v.value,"onUpdate:page":e[13]||(e[13]=t=>v.value=t),"items-length":C.value,"onUpdate:itemsLength":e[14]||(e[14]=t=>C.value=t),"show-select":!1,"loading-text":o.$t("Chargement des éléments"),"no-data-text":o.$t("Pas de données"),"no-results-text":o.$t("Aucun résultat"),onPageCount:e[15]||(e[15]=t=>h.value=t)},{top:r(()=>[l(fe,{class:"rounded-t-md pl-2 pr-2",flat:""},{default:r(()=>[l(B,null,{default:r(()=>[l(D,null,{default:r(()=>[l(j,{density:"compact",modelValue:s.value.search,"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.search=t),placeholder:o.$t("Rechercher prénom, nom, email, téléphone..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),l(D,null,{default:r(()=>[l(ce,{density:"compact",modelValue:s.value.event_type,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.event_type=t),placeholder:o.$t("Prestation"),items:U.value,"item-value":"name","item-title":"name",multiple:"","hide-details":"",variant:"solo"},null,8,["modelValue","placeholder","items"])]),_:1}),l(D,null,{default:r(()=>[l(L,{ref_key:"dialog",ref:F,modelValue:y.value,"onUpdate:modelValue":e[6]||(e[6]=t=>y.value=t),"return-value":s.value.date,"onUpdate:returnValue":e[7]||(e[7]=t=>s.value.date=t),persistent:"",width:"290px"},{activator:r(({props:t})=>[l(j,ie({modelValue:A.value,"onUpdate:modelValue":e[2]||(e[2]=u=>A.value=u),"prepend-inner-icon":"bx-calendar",readonly:""},t,{density:"compact",placeholder:o.$t("Date"),"hide-details":"",variant:"solo"}),null,16,["modelValue","placeholder"])]),default:r(({isActive:t})=>[l(ge,{locale:"fr"},{default:r(()=>[l(Ve,{modelValue:s.value.date,"onUpdate:modelValue":e[5]||(e[5]=u=>s.value.date=u),"hide-header":"",multiple:"range"},{actions:r(()=>[l(c,{color:"primary",onClick:e[3]||(e[3]=u=>y.value=!1)},{default:r(()=>[d(n(o.$t("Annuler")),1)]),_:1}),l(S),l(c,{variant:"elevated",color:"primary",onClick:e[4]||(e[4]=u=>y.value=!1)},{default:r(()=>[d(n(o.$t("OK")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue","return-value"])]),_:1})]),_:1}),l(L,{modelValue:b.value,"onUpdate:modelValue":e[9]||(e[9]=t=>b.value=t),"max-width":"500px"},{default:r(()=>[l(ye,null,{default:r(()=>[l(he,{class:"text-h5 text-center py-6"},{default:r(()=>[d(n(o.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),l(be,null,{default:r(()=>[l(S),l(c,{color:"error",variant:"flat",dark:"",onClick:e[8]||(e[8]=t=>b.value=!1)},{default:r(()=>[d(n(o.$t("Annuler")),1)]),_:1}),l(c,{color:"success",variant:"flat",dark:"",onClick:q},{default:r(()=>[d(n(o.$t("OK")),1)]),_:1}),l(S)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.demand_date":r(({item:t})=>[d(n(x(te)(t.demand_date)),1)]),"item.status":r(({item:t})=>[l(ke,{color:x(p).statusColor(t),size:"small",label:""},{default:r(()=>[d(n(x(p).statusText(t)),1)]),_:2},1032,["color"])]),"item.actions":r(({item:t})=>[l(c,{density:"compact",color:"primary",variant:"outlined",to:"/demands/"+t.id},{default:r(()=>[d(n(o.$t("Voir")),1)]),_:2},1032,["to"])]),"no-data":r(()=>[me("span",null,n(o.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{st as default};
