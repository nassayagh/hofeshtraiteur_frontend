import{u as re}from"./service-BPQVljwN.js";import{_ as se}from"./BaseBreadcrumb-DId732UW.js";import{r as ue}from"./validators-BPi-vT8z.js";import{a6 as ne,r,av as ie,aK as n,h as de,e as me,g as ve,q as fe,o as E,c as N,b as t,w as o,V as k,n as pe,d as i,t as d,a as O,a8 as j,a4 as ce,ac as q,X as ge}from"./index-BrNXYtcK.js";import{F as Ve,V as be}from"./vee-validate.esm-4kXXlUyw.js";import{V as T,a as z}from"./VRow-D6gdEagX.js";import{V as ke}from"./VDataTableServer-B8S_SJL2.js";import{V as Ce,a as ye}from"./VToolbar-BZVzOBgP.js";import{V as I}from"./VTextField-CIkQcWao.js";import{V as x}from"./VSpacer-grBLOAnI.js";import{V as K}from"./VDialog-DBnhfRAB.js";import{V as L,a as M,b as $e,c as R}from"./VCard-67o3jZBx.js";import{V as xe}from"./VContainer-gk3_qoLQ.js";import{V as Pe}from"./VChip-BEJFrCV7.js";import"./createSimpleFunctional-DH0-WJPK.js";import"./filter-QLSP37Os.js";import"./VField-ByTdy9Oo.js";import"./index-DkrXXV3V.js";import"./VMenu-CNxsr1ho.js";import"./VAvatar-D1vtbcd6.js";import"./VDivider-ReIzI50C.js";import"./VTable-Df11-Ve8.js";const Se={class:"text-h5"},he={key:0,class:"mt-2"},Ze=ne({__name:"List",setup(we){const F=r(),A=ie(),G=r({title:"Gestions des services"}),X=r([{text:n("Tableau de bord"),disabled:!1,href:"/"},{text:n("Services"),disabled:!0,href:"#"}]),m=r([]),P=re();de(()=>{D()});const f=r(!1),S=r(!1),U=r(null),h=r(10),c=r(2),C=r(2),w=r(0),_=r(!1),g=r(!1),y=r("");r(["primary","secondary","error","success","warning"]);const p=r([{key:"name",order:"asc"}]);r(0);const V=r({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"name",order:"desc"}]}),$=r(-1),s=r({id:null,name:"",description:"",price:0,status:null}),H=r({id:null,name:"",description:"",status:null});function J(l){return l==0?"#13DEB9":l==1?"#FA896B":l==2?"#5D87FF":"#FFAE1F"}function Q(l){return l==0?n("Started"):l=="cancel"?n("Cancelled"):l=="completed"?n("Completed"):n("Started")}const b=r(!1),W=r([{title:"Nom",align:"start",key:"name"},{title:"Prix",align:"start",key:"price"},{title:"Actions",key:"actions",sortable:!1}]);function B(l){f.value=!1,$.value=m.value.indexOf(l),s.value=Object.assign({},l),g.value=!0}function Y(l){s.value=l,b.value=!0}function Z(){g.value=!1,setTimeout(()=>{s.value=Object.assign({},H.value),$.value=-1},300)}function ee(l,{setErrors:a}){var e;(e=F.value)==null||e.validate().then(({valid:v})=>{v&&(S.value=!0,P.addItem(s.value).then(u=>{if(u.data.error){a({apiError:u.data.message});return}s.value.id!=null?Object.assign(m.value[$.value],u.data):m.value.unshift(u.data),f.value=!1,g.value=!1,s.value={changePassword:!0},A.showSuccess(n("Service sauvée avec succès"))}).catch(u=>{S.value=!1,a({apiError:u})}).then(()=>{S.value=!1,a({apiError:null})}))})}function ae(){P.deleteItem(s.value.id);const l=m.value.findIndex(a=>a.id==s.value.id);m.value.splice(l,1),b.value=!1,A.showSuccess(n("Service supprimé avec succès"))}const te=me(()=>$.value===-1?n("Nouvel service"):n("Modifier la service"));function D(){try{clearTimeout(U.value)}catch{}U.value=setTimeout(()=>{f.value=!0;let l="id",a="desc";console.log(p.value),p.value.length>0&&(l=p.value[0].key,a=p.value[0].order),P.fetchItems({term:y.value,paginate:h.value,current_page:c.value,direction:a,order_by:l,page:V.value.page,per_page:V.value.itemsPerPage}).then(e=>{if(e.data){const{data:v,current_page:u,next_page_url:Te,total:le,per_page:Ie,to:Fe,last_page:oe}=e.data;m.value=v,C.value=oe,w.value=le}}).catch(e=>{console.error(e)}).then(()=>{f.value=!1})},1e3)}return ve([y,V],()=>{D()},{deep:!0}),fe(()=>{c.value>C.value&&(c.value=C.value)}),(l,a)=>(E(),N(ge,null,[t(se,{title:G.value.title,breadcrumbs:X.value},null,8,["title","breadcrumbs"]),t(z,null,{default:o(()=>[t(T,{cols:"12"},{default:o(()=>[t(ke,{class:"border rounded-md",headers:W.value,loading:f.value,items:m.value,"multi-sort":!1,"items-per-page":h.value,"onUpdate:itemsPerPage":a[8]||(a[8]=e=>h.value=e),"items-per-page-text":l.$t("Articles par page"),options:V.value,"onUpdate:options":a[9]||(a[9]=e=>V.value=e),"sort-by":p.value,"onUpdate:sortBy":a[10]||(a[10]=e=>p.value=e),page:c.value,"onUpdate:page":a[11]||(a[11]=e=>c.value=e),"items-length":w.value,"onUpdate:itemsLength":a[12]||(a[12]=e=>w.value=e),"show-select":!1,"loading-text":l.$t("Chargement des éléments"),"no-data-text":l.$t("Pas de données"),"no-results-text":l.$t("Aucun résultat"),onPageCount:a[13]||(a[13]=e=>C.value=e)},{top:o(()=>[t(Ce,{class:"rounded-t-md",flat:""},{default:o(()=>[t(ye,null,{default:o(()=>[t(I,{density:"compact",modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=e=>y.value=e),placeholder:l.$t("Rechercher..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),t(x),t(K,{modelValue:g.value,"onUpdate:modelValue":a[5]||(a[5]=e=>g.value=e),"max-width":"350px"},{activator:o(({props:e})=>[t(k,pe({color:"primary",variant:"flat",onClick:a[1]||(a[1]=v=>B={}),dark:""},e),{default:o(()=>[i(d(l.$t("Ajouter une service")),1)]),_:2},1040)]),default:o(()=>[t(L,null,{default:o(()=>[t(M,{class:"pa-4 bg-secondary"},{default:o(()=>[O("span",Se,d(te.value),1)]),_:1}),t(j(Ve),{ref_key:"refForm",ref:F,modelValue:_.value,"onUpdate:modelValue":a[4]||(a[4]=e=>_.value=e),onSubmit:ee},{default:o(({errors:e,isSubmitting:v})=>[t($e,null,{default:o(()=>[t(xe,{class:"px-0"},{default:o(()=>[t(z,null,{default:o(()=>[t(T,{cols:"12"},{default:o(()=>[t(I,{modelValue:s.value.name,"onUpdate:modelValue":a[2]||(a[2]=u=>s.value.name=u),rules:[j(ue)],label:l.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1}),t(T,{cols:"12"},{default:o(()=>[t(I,{modelValue:s.value.price,"onUpdate:modelValue":a[3]||(a[3]=u=>s.value.price=u),label:l.$t("Prix")},null,8,["modelValue","label"])]),_:1})]),_:1}),e.apiError?(E(),N("div",he,[t(be,{color:"error"},{default:o(()=>[i(d(e.apiError),1)]),_:2},1024)])):ce("",!0)]),_:2},1024)]),_:2},1024),t(R,null,{default:o(()=>[t(x),t(k,{color:"error",variant:"flat",dark:"",onClick:Z},{default:o(()=>[i(d(l.$t("Annuler")),1)]),_:1}),t(k,{color:"success",variant:"flat",loading:f.value,type:"submit"},{default:o(()=>[i(d(l.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),t(K,{modelValue:b.value,"onUpdate:modelValue":a[7]||(a[7]=e=>b.value=e),"max-width":"500px"},{default:o(()=>[t(L,null,{default:o(()=>[t(M,{class:"text-h5 text-center py-6"},{default:o(()=>[i(d(l.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),t(R,null,{default:o(()=>[t(x),t(k,{color:"error",variant:"flat",dark:"",onClick:a[6]||(a[6]=e=>b.value=!1)},{default:o(()=>[i(d(l.$t("Annuler")),1)]),_:1}),t(k,{color:"success",variant:"flat",dark:"",onClick:ae},{default:o(()=>[i(d(l.$t("OK")),1)]),_:1}),t(x)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.status":o(({item:e})=>[t(Pe,{color:J(e.status)},{default:o(()=>[i(d(Q(e.status)),1)]),_:2},1032,["color"])]),"item.actions":o(({item:e})=>[t(q,{color:"info",size:"small",class:"me-2",onClick:v=>B(e)},{default:o(()=>[i(" mdi-pencil ")]),_:2},1032,["onClick"]),t(q,{color:"error",size:"small",onClick:v=>Y(e)},{default:o(()=>[i(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":o(()=>[O("span",null,d(l.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{Ze as default};
