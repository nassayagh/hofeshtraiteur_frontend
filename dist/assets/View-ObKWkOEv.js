import{u as q}from"./customers-CMuiMTIa.js";import{a6 as X,r,av as G,aD as v,aE as H,h as J,e as x,g as K,q as O,o as n,c as g,_ as b,a4 as Q,w as a,b as s,aF as W,a as t,d as u,t as e,a8 as c,X as k,a5 as j,V as B}from"./index-BjFWTEr_.js";import{_ as Y,V as A}from"./BaseBreadcrumb-SFhi0e60.js";import{a as C,f as Z}from"./formatters-DCCWVJxZ.js";import{u as L}from"./demands-prQxjOEx.js";import{u as M}from"./Controller-BM4W5AOG.js";import{_ as tt}from"./DemandForm.vue_vue_type_script_setup_true_lang-B-WneUaI.js";import{_ as et}from"./CustomerForm.vue_vue_type_script_setup_true_lang-BsUhze8n.js";import{V as d,a as w}from"./VRow-CeV0ez7H.js";import{a as m,d as P,V as h}from"./VCard-Ds3PvDnC.js";import{i as p,a as $}from"./VSpacer-zVSMWsYI.js";import"./VTextField-CWkQ8t64.js";import"./VAvatar-XjD8XNVT.js";import"./EditorMenubar-PVE4sB2i.js";import"./eventType-BiPypW0S.js";import"./hall-Dq7HmS3W.js";import"./validators-BPi-vT8z.js";import"./vee-validate.esm-D2e16B8d.js";import"./VDialog-suZyWcBK.js";import"./VContainer-yHGJ-PEc.js";import"./VAutocomplete-DDFPuflg.js";import"./VLocaleProvider-eWe5UfUW.js";import"./VDatePicker-Cd8bpmXq.js";import"./VSheet-CV8dKKyt.js";const st={class:"text-h6 d-flex align-center"},at={class:"text-subtitle-1 textSecondary mt-3"},lt={class:"text-subtitle-1 textSecondary mt-3"},ot={class:"text-subtitle-1 textSecondary mt-3"},rt={class:"text-subtitle-1 textSecondary mt-3"},it={class:"text-subtitle-1 textSecondary mt-3"},nt={class:"text-subtitle-1 textSecondary mt-3"},dt={class:"d-flex align-start"},ut={class:"text-h4 mt-1"},ct={class:"mt-9"},mt={class:"text-h4 font-weight-semibold mb-1"},ht={class:"d-flex align-start"},ft={class:"text-h4 mt-1"},_t={class:"mt-9"},vt={class:"text-h4 font-weight-semibold mb-1"},pt={class:"d-flex align-start"},gt={class:"text-h4 mt-1"},bt={class:"mt-9"},yt={class:"text-h4 font-weight-semibold mb-1"},xt={class:"d-flex align-start"},wt={class:"text-h4 mt-1"},$t={class:"mt-9"},Vt={class:"text-h4 font-weight-semibold mb-1"},kt={class:"text-h6 d-flex align-center"},Ct={class:"text-h6"},Pt={class:"text-h6"},St={class:"text-h6"},Dt={class:"text-h6"},Tt={class:"text-h6"},Et={style:{"max-height":"500px"},class:"overflow-y-auto"},It={class:"text-h6 font-weight-medium text-medium-emphasis"},Nt={class:"text-h6"},jt={class:"text-h6"},Bt={class:"text-h6"},At={class:"text-h6"},Lt={class:"text-h6"},Mt={class:"text-h6"},zt={class:"text-h6 font-weight-medium text-medium-emphasis"},ce=X({__name:"View",setup(Ft){r(),G();const o=r({id:null,status:0,service:"",created_at:null,customer_id:null,prestation_id:null,customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),S=r({title:v("Détails")}),D=r([{text:v("Dashboard"),disabled:!1,href:"/"},{text:v("Client"),disabled:!1,href:"/customers"},{text:o.value.event_type||"",disabled:!0,href:"#"}]);function z(){S.value={title:v("Détails du client")},D.value=[{text:v("Dashboard"),disabled:!1,href:"/"},{text:v("Clients"),disabled:!1,href:"/customers"},{text:o.value.event_type||"",disabled:!0,href:"#"}]}const T=q(),E=H();J(()=>{y()});const f=r(!1);r(!1),r(100);const I=r(2),N=r(2);r(!1),r(!1),r(null);const F=r("");r(["primary","secondary","error","success","warning"]),r([{key:"created_at",order:"DESC"}]),r(0),r({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"created_at",order:"DESC"}]});const R=r(-1);r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const V=r({id:null,customer:{}});r({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),r(!1),r([{title:"Prénom",align:"start",key:"customer.firstname",sortable:!1},{title:"Nom",align:"start",key:"customer.lastname",sortable:!1},{title:"Email",align:"start",key:"customer.email",sortable:!1},{title:"Téléphone",align:"start",key:"customer.phone",sortable:!1},{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la customere",align:"start",key:"created_at"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),x(()=>T.customers.data.filter(l=>l.email.toLowerCase().includes(F.value.toLowerCase())));const U=x(()=>E.params.id);x(()=>o.value.customer.customers?o.value.customer.customers.filter(l=>l.id!=o.value.id):[]),x(()=>R.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function y(){f.value=!0,T.fetchItem(E.params.id).then(l=>{l.data.error||(f.value=!1,o.value=l.data,z(),V.value={id:null,customer_id:o.value.id,customer:o.value})}).catch(l=>{f.value=!1}).then(()=>{f.value=!1})}return K(U,(l,_)=>{l!=_&&y()},{deep:!0}),O(()=>{I.value>N.value&&(I.value=N.value)}),(l,_)=>(n(),g(k,null,[f.value?Q("",!0):(n(),b(Y,{key:0,title:S.value.title,breadcrumbs:D.value},null,8,["title","breadcrumbs"])),f.value?(n(),b(w,{key:1,justify:"center",align:"center","align-content":"center"},{default:a(()=>[s(d,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:a(()=>[s(W,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(n(),b(w,{key:2},{default:a(()=>[s(d,{cols:"12"},{default:a(()=>[s(w,{align:"center"},{default:a(()=>[s(d,{cols:"12",md:"4"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-hidden h-100"},{default:a(()=>[s(P,{class:"py-4 px-6 text-white bg-info"},{default:a(()=>[t("h4",st,[u(e(l.$t("Identification du customereur"))+" ",1),s(p),s(et,{modelValue:o.value,"onUpdate:modelValue":_[0]||(_[0]=i=>o.value=i),onSaved:y,"button-text":l.$t("Modifier")},null,8,["modelValue","button-text"])])]),_:1}),s(h,{class:"pa-6"},{default:a(()=>[t("p",at,e(l.$t("Prénom :"))+" "+e(o.value.firstname||""),1),t("p",lt,e(l.$t("Nom :"))+" "+e(o.value.lastname||""),1),t("p",ot,e(l.$t("Email :"))+" "+e(o.value.email||""),1),t("p",rt,e(l.$t("Téléphone :"))+" "+e(o.value.phone||""),1),t("p",it,e(l.$t("Date d'enregistrement :"))+" "+e(c(C)(o.value.created_at)||""),1),t("p",nt,[u(e(l.$t("Type :"))+" ",1),o.value&&o.value.is_customer?(n(),b($,{key:0,color:"success"},{default:a(()=>[u(e(l.$t("Client")),1)]),_:1})):(n(),b($,{key:1,color:"error"},{default:a(()=>[u(e(l.$t("Prospect")),1)]),_:1}))])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"8"},{default:a(()=>[s(w,null,{default:a(()=>[s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-primary h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",dt,[t("h2",ut,e(l.$t("Devis")),1),s(p)]),t("div",ct,[t("h2",mt,e(o.value.demands?o.value.demands.length:0),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-info h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",ht,[t("h2",ft,e(l.$t("Prestations")),1),s(p)]),t("div",_t,[t("h2",vt,e(o.value.prestations?o.value.prestations.length:0),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-primary h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",pt,[t("h2",gt,e(l.$t("Paiements")),1),s(p)]),t("div",bt,[t("h2",yt,e(c(Z)(o.value.payments_sum_amount||0)),1)])]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",md:"3"},{default:a(()=>[s(m,{elevation:"10",class:"bg-success h-100"},{default:a(()=>[s(h,null,{default:a(()=>[t("div",xt,[t("h2",wt,e(l.$t("Prestations Clôturées")),1),s(p)]),t("div",$t,[t("h2",Vt,e(o.value.prestations_count||0),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",lg:"6"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-x-hidden h-100"},{default:a(()=>[s(P,{class:"py-4 px-6 text-white bg-info"},{default:a(()=>[t("h4",kt,[u(e(l.$t("Les devis de"))+" "+e(o.value.firstname||"")+" "+e(o.value.lastname||"")+" ",1),s(p),s(tt,{modelValue:V.value,"onUpdate:modelValue":_[1]||(_[1]=i=>V.value=i),onSaved:y,"show-customer":!1},null,8,["modelValue"])])]),_:1}),s(h,{class:"pa-6 overflow-y-auto",style:{"max-height":"500px"}},{default:a(()=>[s(A,{class:"month-table"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",Ct,e(l.$t("ID")),1),t("th",Pt,e(l.$t("Prestation")),1),t("th",St,e(l.$t("Date")),1),t("th",Dt,e(l.$t("Status")),1),t("th",Tt,e(l.$t("Action")),1)])]),t("tbody",Et,[(n(!0),g(k,null,j(o.value.demands||[],i=>(n(),g("tr",{key:i.id,class:"month-item"},[t("td",null,e(i.id),1),t("td",null,[t("h6",It,e(i.event_type),1)]),t("td",null,e(c(C)(i.demand_date)),1),t("td",null,[s($,{rounded:"md",class:"font-weight-bold",color:c(L)().statusColor(i.status),size:"small",label:""},{default:a(()=>[u(e(c(L)().statusText(i.status)),1)]),_:2},1032,["color"])]),t("td",null,[s(B,{variant:"outlined",density:"compact",color:"info",to:"/demands/"+i.id},{default:a(()=>[u(e(l.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),s(d,{cols:"12",lg:"6"},{default:a(()=>[s(m,{elevation:"10",class:"overflow-x-hidden h-100"},{default:a(()=>[s(P,{class:"py-4 px-6 text-white bg-info"},{default:a(()=>[t("h4",Nt,e(l.$t("Prestations de devis de"))+" "+e(o.value.firstname||"")+" "+e(o.value.lastname||""),1)]),_:1}),s(h,{class:"pa-6 overflow-y-auto",style:{"max-height":"500px"}},{default:a(()=>[s(A,{class:"month-table"},{default:a(()=>[t("thead",null,[t("tr",null,[t("th",jt,e(l.$t("ID")),1),t("th",Bt,e(l.$t("Prestation")),1),t("th",At,e(l.$t("Date")),1),t("th",Lt,e(l.$t("Status")),1),t("th",Mt,e(l.$t("Action")),1)])]),t("tbody",null,[(n(!0),g(k,null,j(o.value.prestations||[],i=>(n(),g("tr",{key:i.id,class:"month-item"},[t("td",null,e(i.id),1),t("td",null,[t("h6",zt,e(i.event_type),1)]),t("td",null,e(c(C)(i.demand_date)),1),t("td",null,[s($,{rounded:"md",class:"font-weight-bold",color:c(M)().statusColor(i.status),size:"small",label:""},{default:a(()=>[u(e(c(M)().statusText(i.status)),1)]),_:2},1032,["color"])]),t("td",null,[s(B,{variant:"outlined",density:"compact",color:"info",to:"/prestations/"+i.id},{default:a(()=>[u(e(l.$t("Voir")),1)]),_:2},1032,["to"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))],64))}});export{ce as default};
