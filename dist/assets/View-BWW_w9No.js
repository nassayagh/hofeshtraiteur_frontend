import{u as L}from"./Controller-CwQMb1V7.js";import{a6 as B,av as R,e as I,r as d,aK as M,o as c,_ as S,w as t,b as e,d as _,t as a,n as z,V as j,a8 as C,a4 as U,a as n,c as O,h as Z,Z as J,aL as ie,g as me,aM as ce,X as ee,a5 as oe}from"./index-I0UitVw9.js";import{_ as ve}from"./BaseBreadcrumb-Bvki5orj.js";import{f as q,a as K}from"./formatters-Dv1Ro_l4.js";import{a as H,b as D,c as G,V as E,d as X}from"./VCard-B1LBfBUi.js";import{f as F}from"./VMenu-CKbNcpd5.js";import{a as N,V as x}from"./VRow-CPynRsRN.js";import{V as le}from"./VTextarea-CprxU14o.js";import{V as T}from"./VSpacer-wP9sIqQA.js";import{c as Q,b as fe}from"./VDialog-vfc6W1j9.js";import{V as te}from"./VChip-CnA1weES.js";import{u as pe}from"./service-BjeLq3Nf.js";import{V as re}from"./VAutocomplete-CoeN2Vh-.js";import{V as ae}from"./VTextField-C34nEPQ_.js";import{u as he}from"./paymentMethod-CPJUnPuL.js";import{u as _e}from"./hall-C5Qu2R5X.js";import{V as Ve}from"./VAlert-YuPZvIpD.js";import{V as ue}from"./VTable-CbLis7vm.js";import{V as $e}from"./VTooltip-Dz5wcFlS.js";import"./VAvatar-7ZdQt64J.js";import"./index-5VT2wLJK.js";import"./filter-D69XZO7B.js";const ge=B({__name:"CancelPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const v=L(),w=R(),V=P,r=l,i=I({get:()=>V.modelValue,set:o=>r("update:modelValue",o)}),s=d(!1),f=d(!1),$=d("");I(()=>`${M("Annuler la prestation")}`);function h(){f.value=!0,v.cancelItem(i.value.id,$.value).then(o=>{i.value=o.data,s.value=!1,w.showSuccess(M("Prestation annulée avec succès"))}).catch(o=>{f.value=!1,w.showError(o.message)}).then(()=>{f.value=!1})}return(o,p)=>(c(),S(Q,{modelValue:s.value,"onUpdate:modelValue":p[3]||(p[3]=u=>s.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(j,z({class:"ml-2",dark:""},u,{variant:"outlined",color:"primary",onClick:p[0]||(p[0]=g=>f.value=!1)}),{default:t(()=>[_(a(o.$t("Annuler la prestation")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(o.$t("Annuler la prestation")),1)]),_:1}),e(F),e(D,null,{default:t(()=>[e(N,null,{default:t(()=>[e(x,{cols:"12",class:"text-center"},{default:t(()=>[_(a(o.$t("Êtes-vous sûr de vouloir Annuler la prestation?")),1)]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(le,{modelValue:$.value,"onUpdate:modelValue":p[1]||(p[1]=u=>$.value=u),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(F),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:p[2]||(p[2]=u=>s.value=!1)},{default:t(()=>[_(a(o.$t("Non")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:h},{default:t(()=>[_(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ye=B({__name:"ValidatePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const v=L(),w=R(),V=P,r=l,i=I({get:()=>V.modelValue,set:o=>r("update:modelValue",o)}),s=d(!1),f=d(!1),$=d("");I(()=>`${M("Valider la prestation")}`);function h(){f.value=!0,v.validateItem(i.value.id,$.value).then(o=>{i.value=o.data,s.value=!1,w.showSuccess(M("Prestation validée avec succès"))}).catch(o=>{f.value=!1,w.showError(o.message)}).then(()=>{f.value=!1})}return(o,p)=>(c(),S(Q,{modelValue:s.value,"onUpdate:modelValue":p[3]||(p[3]=u=>s.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(j,z({dark:""},u,{variant:"elevated",color:"primary",onClick:p[0]||(p[0]=g=>f.value=!1)}),{default:t(()=>[_(a(i.value.status==C(v).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(i.value.status==C(v).statuses.cancelled?o.$t("Rouvrir la prestation"):o.$t("Valider la prestation")),1)]),_:1}),e(F),e(D,null,{default:t(()=>[e(N,null,{default:t(()=>[e(x,{cols:"12",class:"text-center"},{default:t(()=>[_(a(i.value.status==C(v).statuses.cancelled?o.$t("Êtes-vous sûr de vouloir Rouvrir la prestation"):o.$t("Êtes-vous sûr de vouloir Valider la prestation?")),1)]),_:1}),i.value.status==C(v).statuses.cancelled?(c(),S(x,{key:0,cols:"12"},{default:t(()=>[e(le,{modelValue:$.value,"onUpdate:modelValue":p[1]||(p[1]=u=>$.value=u),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})):U("",!0)]),_:1})]),_:1}),e(F),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:p[2]||(p[2]=u=>s.value=!1)},{default:t(()=>[_(a(o.$t("Non")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:h},{default:t(()=>[_(a(o.$t("Oui")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),be={class:"text-h6"},ke={class:"text-subtitle-1 textSecondary mt-3"},Ce={class:"text-subtitle-1 textSecondary mt-3"},Se={class:"text-subtitle-1 textSecondary mt-3"},we={class:"text-subtitle-1 textSecondary mt-3"},xe={class:"text-subtitle-1 textSecondary mt-3"},je={class:"text-subtitle-1 textSecondary mt-3"},Pe={class:"text-subtitle-1 textSecondary mt-3"},Ae={class:"text-subtitle-1 textSecondary mt-3"},Ue={key:0,class:"text-subtitle-1 textSecondary mt-3"},Ie={key:1,class:"text-subtitle-1 textSecondary mt-3"},Me=B({__name:"CustomerWidget",props:{modelValue:Object,showDemandInfo:Boolean},emits:["update:modelValue"],setup(P,{emit:l}){const v=L(),w=P,V=l,r=I({get:()=>w.modelValue,set:i=>V("update:modelValue",i)});return(i,s)=>(c(),S(E,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(X,{class:"py-4 px-6 text-white bg-primary"},{default:t(()=>[n("h4",be,a(i.$t("Identification du demandeur")),1)]),_:1}),e(D,{class:"pl-6 pr-6"},{default:t(()=>[n("p",ke,a(i.$t("Prénom :"))+" "+a(r.value.customer.firstname||""),1),n("p",Ce,a(i.$t("Nom :"))+" "+a(r.value.customer.lastname||""),1),n("p",Se,a(i.$t("Email :"))+" "+a(r.value.customer.email||""),1),n("p",we,a(i.$t("Téléphone :"))+" "+a(r.value.customer.phone||""),1),n("p",xe,a(i.$t("Date d'enregistrement :"))+" "+a(C(q)(r.value.customer.created_at)||""),1),n("p",je,[_(a(i.$t("Type :"))+" ",1),r.value.customer&&r.value.customer.is_customer?(c(),S(te,{key:0,color:"success"},{default:t(()=>[_(a(i.$t("Client")),1)]),_:1})):(c(),S(te,{key:1,color:"error"},{default:t(()=>[_(a(i.$t("Prospect")),1)]),_:1}))])]),_:1}),P.showDemandInfo?(c(),S(D,{key:0,class:"pt-0 pb-0"},{default:t(()=>[e(F)]),_:1})):U("",!0),P.showDemandInfo?(c(),S(D,{key:1,class:"pl-6 pr-6"},{default:t(()=>[n("p",Pe,a(i.$t("Date de la demande :"))+" "+a(C(q)(r.value.demand_date)||""),1),n("p",Ae,a(i.$t("Date création de la prestation :"))+" "+a(C(q)(r.value.created_at)||""),1),r.value.status>=C(v).statuses.processing?(c(),O("p",Ue,a(i.$t("Date lancement de la prestation :"))+" "+a(C(q)(r.value.start_date)||""),1)):U("",!0),r.value.status>=C(v).statuses.closed?(c(),O("p",Ie,a(i.$t("Date clôture de la prestation :"))+" "+a(C(q)(r.value.closed_date)||""),1)):U("",!0)]),_:1})):U("",!0)]),_:1}))}}),Te={key:1},ne=B({__name:"ServiceForm",props:{modelValue:Object,prestation:Object,title:M("Service"),buttonText:M("Ajouter un service")},emits:["update:modelValue","update:item"],setup(P,{emit:l}){const v=L(),w=R(),V=pe(),r=P,i=l,s=I({get:()=>r.modelValue,set:u=>i("update:modelValue",u)}),f=d(!1),$=d(!1),h=d([]);Z(()=>{V.fetchItems({per_page:500}).then(u=>{h.value=u.data.data,console.log(h.value)})});function o(){$.value=!0,v.saveService(r.prestation.id,s.value).then(u=>{f.value=!1,i("update:item",u.data),s.value={},s.value={},w.showSuccess(M("Service enregistré avec succès"))}).catch(u=>{$.value=!1,w.showError(u.message)}).then(()=>{$.value=!1})}function p(u){if(u){const g=h.value.find(y=>y.name==u);g&&(s.value.quantity=s.value.quantity||1,s.value.service_id=g.id||null,s.value.price=g.price||0,s.value.total=(s.value.quantity||1)*(g.price||0))}}return(u,g)=>{const y=J("EditIcon");return c(),S(Q,{modelValue:f.value,"onUpdate:modelValue":g[5]||(g[5]=b=>f.value=b),"max-width":"500px"},{activator:t(({props:b})=>[e(j,z({dark:""},b,{icon:s.value.id!=null,flat:s.value.id!=null,variant:"elevated",color:s.value.id!=null?null:"primary",onClick:g[0]||(g[0]=m=>$.value=!1)}),{default:t(()=>[s.value.id?(c(),S(y,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(c(),O("span",Te,a(P.buttonText),1))]),_:2},1040,["icon","flat","color"])]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(P.title),1)]),_:1}),e(F),e(D,null,{default:t(()=>[e(N,null,{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(re,{modelValue:s.value.name,"onUpdate:modelValue":[g[1]||(g[1]=b=>s.value.name=b),p],label:u.$t("Service"),clearable:"",items:h.value,"item-title":"name","item-value":"name",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(x,{cols:"12",md:"6"},{default:t(()=>[e(ae,{min:1,modelValue:s.value.quantity,"onUpdate:modelValue":g[2]||(g[2]=b=>s.value.quantity=b),type:"number",label:u.$t("Quantité")},null,8,["modelValue","label"])]),_:1}),e(x,{cols:"12",md:"6"},{default:t(()=>[e(ae,{min:0,modelValue:s.value.price,"onUpdate:modelValue":g[3]||(g[3]=b=>s.value.price=b),type:"number",label:u.$t("Prix")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:g[4]||(g[4]=b=>f.value=!1)},{default:t(()=>[_(a(u.$t("Annuler")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:$.value,dark:"",onClick:o},{default:t(()=>[_(a(u.$t("Ajouter")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),De=B({__name:"DeleteService",props:{modelValue:Object,service:Object},emits:["update:modelValue"],setup(P,{emit:l}){const v=L(),w=R(),V=P,r=l,i=I({get:()=>V.modelValue,set:h=>r("update:modelValue",h)}),s=d(!1),f=d(!1);function $(){f.value=!0,v.deleteService(i.value.id,V.service.id).then(h=>{i.value=h.data,s.value=!1,w.showSuccess(M("Service supprimé avec succès"))}).then(()=>{s.value=!1,f.value=!1})}return(h,o)=>{const p=J("TrashIcon");return c(),S(Q,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=u=>s.value=u),"max-width":"350px"},{activator:t(({props:u})=>[e(j,z({icon:"",flat:"",class:"ml-3",dark:""},u,{onClick:o[0]||(o[0]=g=>f.value=!1)}),{default:t(()=>[e(p,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(h.$t("Êtes-vous sûr de vouloir supprimer le service?")),1)]),_:1}),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=u=>s.value=!1)},{default:t(()=>[_(a(h.$t("Non")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:$},{default:t(()=>[_(a(h.$t("Oui")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Oe={key:1},Ee=B({__name:"PaymentForm",props:{modelValue:Object,prestation:Object,title:M("PaymentMethod"),buttonText:M("Ajouter un paymentMethod")},emits:["update:modelValue","update:item"],setup(P,{emit:l}){const v=L(),w=R(),V=he(),r=P,i=l,s=I({get:()=>r.modelValue,set:y=>i("update:modelValue",y)}),f=d(!1),$=d(!1),h=d([]);Z(()=>{V.fetchItems({per_page:500}).then(y=>{h.value=y.data.data,console.log(h.value)}),s.value.amount=p.value});const o=I(()=>r.prestation.services?r.prestation.services.reduce((y,b)=>(console.log(b.total,y),parseFloat(b.total)+parseFloat(y)),0):0),p=I(()=>r.prestation.payments&&r.prestation.payments.length?o.value-r.prestation.payments.reduce((y,b)=>parseFloat(b.amount)+parseFloat(y),0):o.value);function u(){$.value=!0,v.savePayment(r.prestation.id,s.value).then(y=>{f.value=!1,i("update:item",y.data),s.value={},s.value={},w.showSuccess(M("PaymentMethod enregistré avec succès"))}).catch(y=>{$.value=!1,w.showError(y.message)}).then(()=>{$.value=!1})}function g(y){if(console.log(p.value),y){const b=h.value.find(m=>m.id==y);b&&(s.value.payment_method=b.name||null,s.value.amount=p.value)}}return(y,b)=>{const m=J("EditIcon");return c(),S(Q,{modelValue:f.value,"onUpdate:modelValue":b[4]||(b[4]=k=>f.value=k),"max-width":"500px"},{activator:t(({props:k})=>[p.value>0?(c(),S(j,z({key:0,dark:""},k,{icon:s.value.id!=null,flat:s.value.id!=null,variant:"elevated",color:s.value.id!=null?null:"primary",onClick:b[0]||(b[0]=Y=>$.value=!1)}),{default:t(()=>[s.value.id?(c(),S(m,{key:0,"stroke-width":"1.5",size:"20",class:"text-primary"})):(c(),O("span",Oe,a(P.buttonText),1))]),_:2},1040,["icon","flat","color"])):U("",!0)]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(P.title),1)]),_:1}),e(F),e(D,null,{default:t(()=>[e(N,null,{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(re,{modelValue:s.value.payment_method_id,"onUpdate:modelValue":[b[1]||(b[1]=k=>s.value.payment_method_id=k),g],label:y.$t("PaymentMethod"),clearable:"",items:h.value,"item-title":"name","item-value":"id",filled:!1,variant:"outlined"},null,8,["modelValue","label","items"])]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(ae,{min:0,modelValue:s.value.amount,"onUpdate:modelValue":b[2]||(b[2]=k=>s.value.amount=k),type:"number",label:y.$t("Montant")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:b[3]||(b[3]=k=>f.value=!1)},{default:t(()=>[_(a(y.$t("Annuler")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:$.value,dark:"",onClick:u},{default:t(()=>[_(a(y.$t("Ajouter")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),Fe=B({__name:"ClosePrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const v=L(),w=R(),V=P,r=l,i=I({get:()=>V.modelValue,set:h=>r("update:modelValue",h)}),s=d(!1),f=d(!1);d(""),I(()=>`${M("Terminer la prestation")}`);function $(){f.value=!0,v.closeItem(i.value.id).then(h=>{i.value=h.data,s.value=!1,w.showSuccess(M("Prestation clôturée avec succès"))}).catch(h=>{f.value=!1,w.showError(h.message)}).then(()=>{f.value=!1})}return(h,o)=>(c(),S(Q,{modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=p=>s.value=p),"max-width":"500px"},{activator:t(({props:p})=>[e(j,z({dark:""},p,{variant:"elevated",color:"primary",onClick:o[0]||(o[0]=u=>f.value=!1)}),{default:t(()=>[_(a(h.$t("Terminer la prestation")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(h.$t("Terminer la prestation")),1)]),_:1}),e(F),e(D,null,{default:t(()=>[e(N,null,{default:t(()=>[e(x,{cols:"12",class:"text-center"},{default:t(()=>[_(a(h.$t("Êtes-vous sûr de vouloir terminer la prestation?")),1)]),_:1})]),_:1})]),_:1}),e(F),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:o[1]||(o[1]=p=>s.value=!1)},{default:t(()=>[_(a(h.$t("Non")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:$},{default:t(()=>[_(a(h.$t("Oui")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Ne=B({__name:"CommentPrestation",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const v=L(),w=R(),V=P,r=l,i=I({get:()=>V.modelValue,set:o=>r("update:modelValue",o)}),s=d(!1),f=d(!1),$=d(i.value.commentaire||"");I(()=>`${M("Commentaire")}`);function h(){f.value=!0,v.addComment(i.value.id,$.value).then(o=>{i.value=o.data,s.value=!1,w.showSuccess(M("Commentaire ajouté avec succès"))}).catch(o=>{f.value=!1,w.showError(o.message)}).then(()=>{f.value=!1})}return(o,p)=>(c(),S(Q,{modelValue:s.value,"onUpdate:modelValue":p[3]||(p[3]=u=>s.value=u),"max-width":"500px"},{activator:t(({props:u})=>[e(j,z({density:"compact",dark:""},u,{variant:"outlined",color:"primary",onClick:p[0]||(p[0]=g=>f.value=!1)}),{default:t(()=>[_(a(!i.value.commentaire||i.value.commentaire.length==0?o.$t("Ajouter"):o.$t("Modifier")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(!i.value.commentaire||i.value.commentaire.length==0?o.$t("Ajouter un commentaire"):o.$t("Modifier le commentaire")),1)]),_:1}),e(F),e(D,null,{default:t(()=>[e(N,null,{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(le,{modelValue:$.value,"onUpdate:modelValue":p[1]||(p[1]=u=>$.value=u),placeholder:o.$t("Commentaire"),label:o.$t("Commentaire")},null,8,["modelValue","placeholder","label"])]),_:1})]),_:1})]),_:1}),e(F),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:p[2]||(p[2]=u=>s.value=!1)},{default:t(()=>[_(a(o.$t("Annuler")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:f.value,dark:"",onClick:h},{default:t(()=>[_(a(o.$t("Enregistrer")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Le=B({__name:"ChangeHall",props:{modelValue:Object},emits:["update:modelValue"],setup(P,{emit:l}){const v=L(),w=R(),V=_e(),r=P,i=l,s=I({get:()=>r.modelValue,set:u=>i("update:modelValue",u)}),f=d(!1),$=d(!1);d("");const h=d(s.value.hall_id||null),o=d([]);I(()=>`${M("Modifier la salle")}`);function p(){$.value=!0,v.changeHall(s.value.id,h.value).then(u=>{s.value=u.data,f.value=!1,w.showSuccess(M("Salle changée avec succès")),i("refresh",u.data)}).catch(u=>{$.value=!1,w.showError(u.message)}).then(()=>{$.value=!1})}return Z(()=>{V.fetchItems({per_page:1e3}).then(u=>{o.value=u.data.data})}),(u,g)=>(c(),S(Q,{modelValue:f.value,"onUpdate:modelValue":g[3]||(g[3]=y=>f.value=y),"max-width":"500px"},{activator:t(({props:y})=>[e(j,z({dark:""},y,{variant:"tonal",density:"compact",onClick:g[0]||(g[0]=b=>$.value=!1)}),{default:t(()=>[_(a(u.$t("Modifier")),1)]),_:2},1040)]),default:t(()=>[e(E,null,{default:t(()=>[e(H,{class:"text-h5 text-center py-6"},{default:t(()=>[_(a(u.$t("Modifier la salle")),1)]),_:1}),e(F),e(D,null,{default:t(()=>[e(N,null,{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(fe,{modelValue:h.value,"onUpdate:modelValue":g[1]||(g[1]=y=>h.value=y),items:o.value,"item-value":"id","item-title":"name",label:u.$t("Salle liée")},null,8,["modelValue","items","label"])]),_:1})]),_:1})]),_:1})]),_:1}),e(F),e(G,null,{default:t(()=>[e(T),e(j,{color:"error",variant:"flat",dark:"",onClick:g[2]||(g[2]=y=>f.value=!1)},{default:t(()=>[_(a(u.$t("Annuller")),1)]),_:1}),e(j,{color:"success",variant:"flat",loading:$.value,dark:"",onClick:p},{default:t(()=>[_(a(u.$t("Enregistrer")),1)]),_:1},8,["loading"]),e(T)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Be={class:"text-h6 d-flex align-content-center align-center"},qe={class:"text-subtitle-1 textSecondary mt-3"},Re={class:"text-subtitle-1 textSecondary mt-3"},ze={class:"text-subtitle-1 textSecondary mt-3"},He={class:"text-subtitle-1 textSecondary mt-3"},Ge={key:0,class:"text-subtitle-1 textSecondary mt-3"},Qe={key:1,class:"text-subtitle-1 textSecondary mt-3"},We={key:2,class:"text-subtitle-1 textSecondary mt-3"},Ke={key:3,class:"text-subtitle-1 textSecondary mt-3"},Xe={key:4,class:"text-subtitle-1 textSecondary mt-3"},Ze={key:5,class:"text-subtitle-1 textSecondary mt-3"},Je={class:"text-subtitle-1 textSecondary mt-3"},Ye=["innerHTML"],et=B({__name:"HallWidget",props:{modelValue:Object,showDemandInfo:Boolean},emits:["update:modelValue"],setup(P,{emit:l}){L();const v=P,w=l,V=I({get:()=>v.modelValue,set:r=>w("update:modelValue",r)});return(r,i)=>(c(),S(E,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(X,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[n("h4",Be,[_(a(r.$t("Information de la salle"))+" ",1),e(T),e(Le,{modelValue:V.value,"onUpdate:modelValue":i[0]||(i[0]=s=>V.value=s)},null,8,["modelValue"])])]),_:1}),V.value.hall?(c(),S(D,{key:1,class:"pl-6 pr-6"},{default:t(()=>[n("p",qe,a(r.$t("Nom :"))+" "+a(V.value.hall.name||""),1),n("p",Re,a(r.$t("Adresse :"))+" "+a(V.value.hall.address||""),1),n("p",ze,a(r.$t("Nom du régisseur :"))+" "+a(V.value.hall.manager_name||""),1),n("p",He,a(r.$t("Téléphone du régisseur :"))+" "+a(V.value.hall.manager_phone||""),1),V.value.hall.packing?(c(),O("p",Ge,a(r.$t("Parking :"))+" "+a("Oui"),1)):U("",!0),V.value.hall.kitchen?(c(),O("p",Qe,a(r.$t("Cuisine :"))+" "+a("Oui"),1)):U("",!0),V.value.hall.cold_rooom?(c(),O("p",We,a(r.$t("Chambre froidre :"))+" "+a("Oui"),1)):U("",!0),V.value.hall.ladder?(c(),O("p",Ke,a(r.$t("Escalier pour déchargement :"))+" "+a("Oui"),1)):U("",!0),V.value.hall.transportation_fee?(c(),O("p",Xe,a(r.$t("Frais de déplacement à prévoir :"))+" "+a("Oui"),1)):U("",!0),V.value.hall.table?(c(),O("p",Ze,a(r.$t("Table de buffet :"))+" "+a("Oui"),1)):U("",!0),n("p",Je,a(r.$t("Bac de poubelle :"))+" "+a(V.value.hall.bin=="salle"?r.$t("Géré par la salle"):r.$t("Géré par le client")),1),n("p",{class:"text-subtitle-1 textSecondary mt-3",innerHTML:V.value.hall.comment?V.value.hall.comment:""},null,8,Ye)]),_:1})):(c(),S(D,{key:0,class:"pl-6 pr-6"},{default:t(()=>[e(Ve,{type:"info"},{default:t(()=>[_(a(r.$t("Aucune salle n'a été attribuée. Veuillez attribuer une salle.")),1)]),_:1})]),_:1}))]),_:1}))}}),tt={key:0,class:"ml-2"},at={class:"d-flex align-start"},lt={class:"text-h4 mt-1"},st={class:"ml-auto"},ot={class:"mt-9"},ut={class:"text-h4 font-weight-semibold mb-1"},nt={class:"d-flex align-start"},rt={class:"text-h4 mt-1"},dt={class:"ml-auto"},it={class:"mt-9"},mt={class:"text-h4 font-weight-semibold mb-1"},ct={class:"d-flex align-start"},vt={class:"text-h4 mt-1"},ft={class:"mt-4"},pt={class:"mb-1"},ht={class:"d-flex align-start"},_t={class:"text-h4 mt-1"},Vt={class:"mt-4"},$t={class:"mb-1"},gt={class:"d-flex align-start"},yt={class:"text-h4 mt-1"},bt={class:"mt-4"},kt={class:"mb-1"},Ct={class:"text-h6 d-flex align-center"},St={class:"text-h6"},wt={class:"text-h6"},xt={class:"text-h6"},jt={class:"text-h6"},Pt={class:"text-h6"},At={key:0,class:"d-flex align-center"},Ut={class:"text-h6 d-flex align-center"},It={class:"text-h6"},Mt={class:"text-h6"},Tt={class:"text-h6"},la=B({__name:"View",setup(P){d(),R();const l=d({id:null,status:0,service:"",demand_date:null,customer_id:null,demand_id:null,payments:[],services:[],customer:{id:null,firstname:"",lastname:"",email:"",phone:"",is_customer:!1,created_at:null,demands:[],prestations:[]}}),v=L(),w=ie(),V=d({title:M("Détails du devis")+" "+(l.value.event_type||"")+" "+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(q(l.value.demand_date)||"")}),r=d([{text:M("Dashboard"),disabled:!1,href:"/"},{text:v.pageTitle(l.value.status),disabled:!1,href:v.pageLink(l.value.status)},{text:l.value.event_type||"",disabled:!0,href:"#"}]);function i(){V.value={title:M("Prestation")+" "+(l.value.demand.event_type||"")+" ("+(l.value.customer||{firstname:""}).firstname+" "+(l.value.customer||{lastname:""}).lastname+" "+(q(l.value.demand_date)||"")+")"},r.value=[{text:M("Dashboard"),disabled:!1,href:"/"},{text:v.pageTitle(l.value.status),disabled:!1,href:v.pageLink(l.value.status)},{text:V.value.title,disabled:!0,href:"#"}]}Z(()=>{y()});const s=d(!1);d(!1),d(!1),d(!1),d(!1),d(!1),d(!1),d({}),d({}),d(!1),d(10),d(2),d(2),d(!1),d(!1),d(null);const f=d("");d(["primary","secondary","error","success","warning"]),d([{key:"demand_date",order:"DESC"}]),d(0),d({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"demand_date",order:"DESC"}]});const $=d(-1);d({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""});const h=d({id:null,service_id:null,name:"",price:0,total:0,quantity:0}),o=d({id:null,prestation_id:null,amount:0});d({id:null,avatar:"1.jpg",name:"",email:"",password:"",changePassword:!0,jdate:"",role:"",rolestatus:""}),d(!1),d([{title:"Prestation",align:"start",key:"event_type"},{title:"Date de la prestation",align:"start",key:"demand_date"},{title:"Status",align:"start",key:"status"},{title:"Actions",key:"actions",sortable:!1}]),I(()=>v.prestations.data.filter(m=>m.email.toLowerCase().includes(f.value.toLowerCase())));const p=I(()=>w.params.id);I(()=>l.value.customer.prestations?l.value.customer.prestations.filter(m=>m.id!=l.value.id):[]);const u=I(()=>l.value.services&&l.value.services.length?l.value.services.reduce((m,k)=>(console.log(k.total,m),parseFloat(k.total)+parseFloat(m)),0):0),g=I(()=>l.value.payments&&l.value.payments.length?u.value-l.value.payments.reduce((m,k)=>parseFloat(k.amount)+parseFloat(m),0):u.value);I(()=>$.value===-1?"Nouvel administrateur":"Modifier l’administrateur");function y(){s.value=!0,v.fetchItem(w.params.id).then(m=>{m.data.error||(s.value=!1,l.value=m.data,i())}).catch(m=>{s.value=!1}).then(()=>{s.value=!1})}function b(m){l.value=m}return me(p,(m,k)=>{m!=k&&y()},{deep:!0}),(m,k)=>{const Y=J("CurrencyEuroIcon");return c(),O(ee,null,[s.value?U("",!0):(c(),S(ve,{key:0,title:V.value.title,breadcrumbs:r.value},null,8,["title","breadcrumbs"])),s.value?(c(),S(N,{key:1,justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(x,{cols:"12",justify:"center",align:"center","align-content":"center"},{default:t(()=>[e(ce,{indeterminate:"",color:"primary",size:"150"})]),_:1})]),_:1})):(c(),S(N,{key:2},{default:t(()=>[e(x,{cols:"12",md:"4"},{default:t(()=>[_(a(m.$t("Status :"))+" ",1),e(te,{rounded:"md",class:"font-weight-bold",color:C(v).statusColor(l.value.status),size:"small",label:""},{default:t(()=>[_(a(C(v).statusText(l.value.status)),1)]),_:1},8,["color"]),l.value.status==C(v).statuses.cancelled?(c(),O("span",tt,a(m.$t("Le"))+" "+a(C(q)(l.value.cancelled_date)||""),1)):U("",!0)]),_:1}),e(x,{cols:"12",md:"8",justify:"end","align-content":"end",align:"end"},{default:t(()=>[l.value.status==C(v).statuses.started||l.value.status==C(v).statuses.cancelled?(c(),S(ye,{key:0,modelValue:l.value,"onUpdate:modelValue":k[0]||(k[0]=A=>l.value=A)},null,8,["modelValue"])):U("",!0),l.value.status==C(v).statuses.validated?(c(),S(Fe,{key:1,modelValue:l.value,"onUpdate:modelValue":k[1]||(k[1]=A=>l.value=A)},null,8,["modelValue"])):U("",!0),l.value.status!=C(v).statuses.cancelled?(c(),S(ge,{key:2,modelValue:l.value,"onUpdate:modelValue":k[2]||(k[2]=A=>l.value=A)},null,8,["modelValue"])):U("",!0),e(F,{vertical:""}),e(j,{variant:"elevated",color:"success",class:"ml-2",to:"/customers/"+l.value.customer_id},{default:t(()=>[_(a(m.$t("Voir le Client")),1)]),_:1},8,["to"]),e(j,{variant:"elevated",color:"info",class:"ml-2",to:"/demands/"+l.value.demand_id},{default:t(()=>[_(a(m.$t("Voir la demande associée")),1)]),_:1},8,["to"])]),_:1}),e(x,{cols:"12",md:"3"},{default:t(()=>[e(Me,{modelValue:l.value,"onUpdate:modelValue":k[3]||(k[3]=A=>l.value=A),"show-demand-info":""},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"3"},{default:t(()=>[e(et,{modelValue:l.value,"onUpdate:modelValue":k[4]||(k[4]=A=>l.value=A),"show-demand-info":""},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"6",class:"justify-end align-end"},{default:t(()=>[e(N,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[e(x,{cols:"12",class:"h-50 align-end justify-end align-content-end"},{default:t(()=>[e(N,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[l.value.status>=C(v).statuses.validated?(c(),S(x,{key:0,cols:"12",md:"6",class:"h-100"},{default:t(()=>[e(E,{elevation:"10"},{default:t(()=>[e(D,null,{default:t(()=>[n("div",at,[n("h2",lt,a(m.$t("Reste à payer")),1),e(T),n("div",st,[e(j,{color:"primary",icon:"",flat:""},{default:t(()=>[e(Y)]),_:1})])]),n("div",ot,[n("h2",ut,a(C(K)(g.value)),1)])]),_:1})]),_:1})]),_:1})):U("",!0),e(x,{class:"h-100",cols:"12",md:"6"},{default:t(()=>[e(E,{elevation:"10"},{default:t(()=>[e(D,null,{default:t(()=>[n("div",nt,[n("h2",rt,a(m.$t("Montant total")),1),e(T),n("div",dt,[e(j,{color:"primary",icon:"",flat:""},{default:t(()=>[e(Y)]),_:1})])]),n("div",it,[n("h2",mt,a(C(K)(u.value||0)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",class:"h-50 align-end justify-end align-content-end"},{default:t(()=>[e(N,{class:"h-100 align-end justify-end align-content-end"},{default:t(()=>[l.value.status==C(v).statuses.cancelled?(c(),S(x,{key:0,class:"h-100",cols:"12",md:"6"},{default:t(()=>[e(E,{elevation:"10",class:"h-100"},{default:t(()=>[e(D,null,{default:t(()=>[n("div",ct,[n("h2",vt,a(m.$t("Raison de l'annulation")),1)]),n("div",ft,[n("p",pt,a(l.value.cancel_comment||m.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1})):U("",!0),e(x,{class:"h-100",cols:"12",md:l.value.status==C(v).statuses.cancelled?"6":"12"},{default:t(()=>[e(N,{class:"h-100"},{default:t(()=>[e(x,{cols:"12",md:"6",class:"h-100"},{default:t(()=>[e(E,{elevation:"10",class:"h-100"},{default:t(()=>[e(D,null,{default:t(()=>[n("div",ht,[n("h2",_t,a(m.$t("Note liée à la prestation")),1)]),n("div",Vt,[n("p",$t,a(l.value.comment||m.$t("Aucun note")),1)])]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",md:"6",class:"h-100"},{default:t(()=>[e(E,{elevation:"10",class:"h-100"},{default:t(()=>[e(D,null,{default:t(()=>[n("div",gt,[n("h2",yt,a(m.$t("Commentaire")),1),e(Ne,{modelValue:l.value,"onUpdate:modelValue":k[5]||(k[5]=A=>l.value=A)},null,8,["modelValue"])]),n("div",bt,[n("p",kt,a(l.value.commentaire||m.$t("Aucun commentaire")),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["md"])]),_:1})]),_:1})]),_:1})]),_:1}),e(x,{cols:"12",lg:l.value.status>C(v).statuses.started?"6":"12"},{default:t(()=>[e(E,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(X,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[n("h4",Ct,[n("span",null,a(m.$t("Désignation des services attendus")),1),e(T),l.value.status<C(v).statuses.processing?(c(),S(ne,{key:0,modelValue:h.value,"onUpdate:modelValue":k[6]||(k[6]=A=>h.value=A),prestation:l.value,"onUpdate:item":b,"button-text":m.$t("Ajouter un service"),title:m.$t("Ajouter un service")},null,8,["modelValue","prestation","button-text","title"])):U("",!0)])]),_:1}),e(D,{class:"pa-6"},{default:t(()=>[e(ue,{class:"month-table"},{default:t(()=>[n("thead",null,[n("tr",null,[n("th",St,a(m.$t("Désignation")),1),n("th",wt,a(m.$t("Quantité")),1),n("th",xt,a(m.$t("Prix unitaire")),1),n("th",jt,a(m.$t("Prix total")),1),n("th",Pt,a(m.$t("Actions")),1)])]),n("tbody",null,[(c(!0),O(ee,null,oe(l.value.services,(A,W)=>(c(),O("tr",{key:A.id,class:"month-item"},[n("td",null,a(A.name),1),n("td",null,a(A.quantity),1),n("td",null,a(C(K)(A.price)),1),n("td",null,a(C(K)(A.total)),1),n("td",null,[l.value.status<C(v).statuses.processing?(c(),O("div",At,[e($e,{text:m.$t("Modifier")},{activator:t(({props:se})=>[e(ne,{modelValue:l.value.services[W],"onUpdate:modelValue":de=>l.value.services[W]=de,prestation:l.value,"onUpdate:item":b,"button-text":m.$t("Modifier le service"),title:m.$t("Modifier le service")},null,8,["modelValue","onUpdate:modelValue","prestation","button-text","title"])]),_:2},1032,["text"]),e(De,{modelValue:l.value,"onUpdate:modelValue":k[7]||(k[7]=se=>l.value=se),service:l.value.services[W]},null,8,["modelValue","service"])])):U("",!0)])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"]),l.value.status>C(v).statuses.started?(c(),S(x,{key:0,cols:"12",lg:l.value.status>C(v).statuses.started?"6":"12"},{default:t(()=>[e(E,{elevation:"10",class:"overflow-hidden h-100"},{default:t(()=>[e(X,{class:"py-4 px-6 text-white bg-info"},{default:t(()=>[n("h4",Ut,[n("span",null,a(m.$t("Paiements")),1),e(T),l.value.status<C(v).statuses.closed?(c(),S(Ee,{key:0,modelValue:o.value,"onUpdate:modelValue":k[8]||(k[8]=A=>o.value=A),prestation:l.value,"onUpdate:item":b,"button-text":m.$t("Ajouter un paiement"),title:m.$t("Ajouter un paiement")},null,8,["modelValue","prestation","button-text","title"])):U("",!0)])]),_:1}),e(D,{class:"pa-6"},{default:t(()=>[e(ue,{class:"month-table"},{default:t(()=>[n("thead",null,[n("tr",null,[n("th",It,a(m.$t("Mode de paiement")),1),n("th",Mt,a(m.$t("Montant payé")),1),n("th",Tt,a(m.$t("Date du paiement")),1)])]),n("tbody",null,[(c(!0),O(ee,null,oe(l.value.payments,(A,W)=>(c(),O("tr",{key:A.id},[n("td",null,a(A.payment_method),1),n("td",null,a(A.amount),1),n("td",null,a(C(q)(A.created_at)),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1},8,["lg"])):U("",!0)]),_:1}))],64)}}});export{la as default};
