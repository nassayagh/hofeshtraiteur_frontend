import{u as ie}from"./hall-nTq0h74K.js";import{_ as de}from"./BaseBreadcrumb-Bd5V6rJ-.js";import{r as me}from"./validators-BPi-vT8z.js";import{a6 as ve,r as u,av as pe,aM as s,h as fe,e as ge,g as be,q as Ve,o as q,c as L,b as l,w as t,V as T,n as ce,d,t as i,a as V,a8 as H,a4 as ke,ae as _,af as O,ac as K,X as $e}from"./index-V7uEaUZU.js";import{F as ye}from"./vee-validate.esm-D1Xz223v.js";import{V as v,a as X}from"./VRow-Br7W0t3Z.js";import{V as Ce}from"./VDataTableServer-Do0RTBrf.js";import{V as Ue,a as Pe}from"./VToolbar-DNv7qWLg.js";import{V as c}from"./VTextField-B2FBaRjP.js";import{a as A}from"./VSpacer-B7D1SjI6.js";import{V as J}from"./VDialog-DfzC34LR.js";import{a as Q,b as W,V as Te,c as Y}from"./VCard--aoCl2hm.js";import{V as Ne}from"./VContainer-DMu04o3F.js";import{b as f}from"./VSelect-CNPufMkU.js";import{V as Se}from"./VTextarea-CLEdwDVo.js";import{V as we}from"./VAlert-BfRLhipQ.js";import{V as h}from"./VTooltip-CY89cnTz.js";import"./filter-4gqOiRMm.js";import"./VMenu-D3b5pAl3.js";import"./VAvatar-CfvEg0QO.js";const Ie={class:"text-h5"},_e={key:0,class:"mt-2"},ll=ve({__name:"List",setup(Oe){const F=u(),D=pe(),Z=u({title:"Gestions des salles"}),x=u([{text:s("Tableau de bord"),disabled:!1,href:"/"},{text:s("Salles"),disabled:!0,href:"#"}]),p=u([]),B=ie();fe(()=>{R()});const k=u(!1),$=u(!1),M=u(null),E=u(100),y=u(2),N=u(2),S=u(0),j=u(!1),C=u(!1),w=u("");u(["primary","secondary","error","success","warning"]);const g=u([{key:"id",order:"DESC"}]);u(0);const U=u({itemsPerPage:100,rowsPerPage:100,page:1,sortDesc:[!0],sortBy:[{key:"id",order:"desc"}]}),b=u([{id:0,label:s("Non")},{id:1,label:s("Oui")}]),ee=u([{id:"salle",label:s("Géré par la salle")},{id:"client",label:s("Géré par le client")}]),I=u(-1),n=u({id:null,name:"",description:"",price:0,status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),z=u({id:null,name:"",description:"",status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),P=u(!1),le=u([{title:"ID",align:"start",key:"id"},{title:s("Nom"),align:"start",key:"name"},{title:s("Adrse"),align:"start",key:"address"},{title:s("Nom.régis"),align:"start",key:"manager_name"},{title:s("Tél.rég"),align:"start",key:"manager_phone"},{title:s("Mail.rég"),align:"start",key:"manager_email"},{title:s("Parking"),align:"start",key:"packing"},{title:s("Cuisine"),align:"start",key:"kitchen"},{title:s("Chambre"),align:"start",key:"cold_room"},{title:s("Escalier"),align:"start",key:"ladder"},{title:s("Bac"),align:"start",key:"bin"},{title:s("Frais"),align:"start",key:"transportation_fee"},{title:s("Table"),align:"start",key:"transportation_fee"},{title:s("Cmt"),align:"start",key:"comment"},{title:"Actions",key:"actions",sortable:!1}]);function G(o){k.value=!1,I.value=p.value.indexOf(o),n.value=Object.assign({},o),C.value=!0}function ae(o){n.value=o,P.value=!0}function te(){C.value=!1,setTimeout(()=>{n.value=Object.assign({},z.value),I.value=-1},300)}function oe(o,{setErrors:a}){var e;(e=F.value)==null||e.validate().then(({valid:m})=>{m&&($.value=!0,B.addItem(n.value).then(r=>{if(r.data.error){a({apiError:r.data.message});return}n.value.id!=null?Object.assign(p.value[I.value],r.data):p.value.unshift(r.data),$.value=!1,k.value=!1,C.value=!1,n.value={changePassword:!0},D.showSuccess(s("Salle sauvée avec succès"))}).catch(r=>{$.value=!1,a({apiError:r})}).then(()=>{$.value=!1,a({apiError:null})}))})}function ne(){B.deleteItem(n.value.id);const o=p.value.findIndex(a=>a.id==n.value.id);p.value.splice(o,1),P.value=!1,D.showSuccess(s("Salle supprimé avec succès"))}const re=ge(()=>I.value===-1?s("Nouvel salle"):s("Modifier la salle"));function R(){try{clearTimeout(M.value)}catch{}M.value=setTimeout(()=>{k.value=!0;let o="id",a="desc";console.log(g.value),g.value.length>0&&(o=g.value[0].key,a=g.value[0].order),B.fetchItems({term:w.value,paginate:E.value,current_page:y.value,direction:a,order_by:o,page:U.value.page,per_page:U.value.itemsPerPage}).then(e=>{if(e.data){const{data:m,current_page:r,next_page_url:Ae,total:ue,per_page:he,to:Be,last_page:se}=e.data;p.value=m,N.value=se,S.value=ue}}).catch(e=>{console.error(e)}).then(()=>{k.value=!1})},1e3)}return be([w,U],()=>{R()},{deep:!0}),Ve(()=>{y.value>N.value&&(y.value=N.value)}),(o,a)=>(q(),L($e,null,[l(de,{title:`${Z.value.title}(${S.value})`,breadcrumbs:x.value},null,8,["title","breadcrumbs"]),l(X,null,{default:t(()=>[l(v,{cols:"12"},{default:t(()=>[l(Ce,{class:"border rounded-md",headers:le.value,loading:k.value,items:p.value,"multi-sort":!1,"items-per-page":E.value,"onUpdate:itemsPerPage":a[19]||(a[19]=e=>E.value=e),"items-per-page-text":o.$t("Articles par page"),options:U.value,"onUpdate:options":a[20]||(a[20]=e=>U.value=e),"sort-by":g.value,"onUpdate:sortBy":a[21]||(a[21]=e=>g.value=e),page:y.value,"onUpdate:page":a[22]||(a[22]=e=>y.value=e),"items-length":S.value,"onUpdate:itemsLength":a[23]||(a[23]=e=>S.value=e),"show-select":!1,"loading-text":o.$t("Chargement des éléments"),"no-data-text":o.$t("Pas de données"),"no-results-text":o.$t("Aucun résultat"),onPageCount:a[24]||(a[24]=e=>N.value=e)},{top:t(()=>[l(Ue,{class:"rounded-t-md",flat:""},{default:t(()=>[l(Pe,null,{default:t(()=>[l(c,{density:"compact",modelValue:w.value,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value=e),placeholder:o.$t("Rechercher..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),l(A),l(J,{modelValue:C.value,"onUpdate:modelValue":a[16]||(a[16]=e=>C.value=e),"max-width":"750px"},{activator:t(({props:e})=>[l(T,ce({color:"primary",variant:"flat",onClick:a[1]||(a[1]=m=>G=z.value),dark:""},e),{default:t(()=>[d(i(o.$t("Ajouter une salle")),1)]),_:2},1040)]),default:t(()=>[l(Q,null,{default:t(()=>[l(W,{class:"pa-4 bg-secondary"},{default:t(()=>[V("span",Ie,i(re.value),1)]),_:1}),l(H(ye),{ref_key:"refForm",ref:F,modelValue:j.value,"onUpdate:modelValue":a[15]||(a[15]=e=>j.value=e),onSubmit:oe},{default:t(({errors:e,isSubmitting:m})=>[l(Te,null,{default:t(()=>[l(Ne,{class:"px-0"},{default:t(()=>[l(X,null,{default:t(()=>[l(v,{cols:"12",md:"6"},{default:t(()=>[l(c,{modelValue:n.value.name,"onUpdate:modelValue":a[2]||(a[2]=r=>n.value.name=r),rules:[H(me)],label:o.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1}),l(v,{cols:"12",md:"6"},{default:t(()=>[l(c,{modelValue:n.value.address,"onUpdate:modelValue":a[3]||(a[3]=r=>n.value.address=r),label:o.$t("Adresse de la salle")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(c,{modelValue:n.value.manager_name,"onUpdate:modelValue":a[4]||(a[4]=r=>n.value.manager_name=r),label:o.$t("Nom du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(c,{modelValue:n.value.manager_phone,"onUpdate:modelValue":a[5]||(a[5]=r=>n.value.manager_phone=r),label:o.$t("Téléphone du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(c,{modelValue:n.value.manager_email,"onUpdate:modelValue":a[6]||(a[6]=r=>n.value.manager_email=r),label:o.$t("Mail du régisseur")},null,8,["modelValue","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.packing,"onUpdate:modelValue":a[7]||(a[7]=r=>n.value.packing=r),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Parking"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.kitchen,"onUpdate:modelValue":a[8]||(a[8]=r=>n.value.kitchen=r),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Cuisine"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.cold_room,"onUpdate:modelValue":a[9]||(a[9]=r=>n.value.cold_room=r),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Chambre froidre"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"3"},{default:t(()=>[l(f,{modelValue:n.value.ladder,"onUpdate:modelValue":a[10]||(a[10]=r=>n.value.ladder=r),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Escalier pour déchargement"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(f,{modelValue:n.value.bin,"onUpdate:modelValue":a[11]||(a[11]=r=>n.value.bin=r),items:ee.value,"item-title":"label","item-value":"id",label:o.$t("Bac de poubelle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(f,{modelValue:n.value.transportation_fee,"onUpdate:modelValue":a[12]||(a[12]=r=>n.value.transportation_fee=r),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Frais de déplacement à prévoir"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12",md:"4"},{default:t(()=>[l(f,{modelValue:n.value.table,"onUpdate:modelValue":a[13]||(a[13]=r=>n.value.table=r),items:b.value,"item-title":"label","item-value":"id",label:o.$t("Table de buffet présent dans la salle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(v,{cols:"12"},{default:t(()=>[l(Se,{modelValue:n.value.comment,"onUpdate:modelValue":a[14]||(a[14]=r=>n.value.comment=r),label:o.$t("Commentaire")},null,8,["modelValue","label"])]),_:1})]),_:1}),e.apiError?(q(),L("div",_e,[l(we,{color:"error"},{default:t(()=>[d(i(e.apiError),1)]),_:2},1024)])):ke("",!0)]),_:2},1024)]),_:2},1024),l(Y,null,{default:t(()=>[l(A),l(T,{color:"error",variant:"flat",dark:"",onClick:te},{default:t(()=>[d(i(o.$t("Annuler")),1)]),_:1}),l(T,{color:"success",variant:"flat",loading:$.value,type:"submit"},{default:t(()=>[d(i(o.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(J,{modelValue:P.value,"onUpdate:modelValue":a[18]||(a[18]=e=>P.value=e),"max-width":"500px"},{default:t(()=>[l(Q,null,{default:t(()=>[l(W,{class:"text-h5 text-center py-6"},{default:t(()=>[d(i(o.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),l(Y,null,{default:t(()=>[l(A),l(T,{color:"error",variant:"flat",dark:"",onClick:a[17]||(a[17]=e=>P.value=!1)},{default:t(()=>[d(i(o.$t("Annuler")),1)]),_:1}),l(T,{color:"success",variant:"flat",dark:"",onClick:ne},{default:t(()=>[d(i(o.$t("OK")),1)]),_:1}),l(A)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.address":t(({item:e})=>[l(h,{text:e.address},{activator:t(({props:m})=>[V("span",_(O(m)),i(!e.address||e.address.length<10?e.address:`${e.address.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.manager_email":t(({item:e})=>[l(h,{text:e.manager_email},{activator:t(({props:m})=>[V("span",_(O(m)),i(!e.manager_email||e.manager_email.length<10?e.manager_email:`${e.manager_email.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.manager_name":t(({item:e})=>[l(h,{text:e.manager_name},{activator:t(({props:m})=>[V("span",_(O(m)),i(!e.manager_name||e.manager_name.length<10?e.manager_name:`${e.manager_name.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.packing":t(({item:e})=>[d(i(e.packing?o.$t("Oui"):o.$t("Non")),1)]),"item.kitchen":t(({item:e})=>[d(i(e.kitchen?o.$t("Oui"):o.$t("Non")),1)]),"item.cold_room":t(({item:e})=>[d(i(e.cold_room?o.$t("Oui"):o.$t("Non")),1)]),"item.ladder":t(({item:e})=>[d(i(e.ladder?o.$t("Oui"):o.$t("Non")),1)]),"item.table":t(({item:e})=>[d(i(e.table?o.$t("Oui"):o.$t("Non")),1)]),"item.transportation_fee":t(({item:e})=>[d(i(e.transportation_fee?o.$t("Oui"):o.$t("Non")),1)]),"item.bin":t(({item:e})=>[d(i(e.bin=="salle"?o.$t("Salle"):o.$t("Client")),1)]),"item.comment":t(({item:e})=>[l(h,{text:e.comment},{activator:t(({props:m})=>[V("span",_(O(m)),i(!e.comment||e.comment.length<10?e.comment:`${e.comment.slice(0,9)}...`),17)]),_:2},1032,["text"])]),"item.actions":t(({item:e})=>[l(K,{color:"info",size:"small",class:"me-2",onClick:m=>G(e)},{default:t(()=>[d(" mdi-pencil ")]),_:2},1032,["onClick"]),l(K,{color:"error",size:"small",onClick:m=>ae(e)},{default:t(()=>[d(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":t(()=>[V("span",null,i(o.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{ll as default};
