import{a6 as T,av as U,e as k,r,aK as $,h as _,Z as A,o as g,_ as S,w as t,V as v,n as j,d,t as u,b as e,a4 as z}from"./index-1gY6uGV-.js";import{u as E}from"./demands-CHk8tW34.js";import{u as H}from"./hall-DX5Dvy8F.js";import{f as K}from"./formatters-DFmKRZND.js";import{b as M,V as O,c as P,a as R}from"./VCard-BB6Js1Oe.js";import{f as Z}from"./VMenu-BgdHDmje.js";import{a as q,V as p}from"./VRow-DR6SNGE0.js";import{V as F}from"./VTextarea-B_seqABQ.js";import{b as G}from"./VSelect-ph4-yU08.js";import{a as b}from"./VSpacer-D92K55La.js";import{V as J}from"./VDialog-C5FspTwe.js";const re=T({__name:"ValidateDemand",props:{modelValue:Object,density:{type:String,default:"default"},icon:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{emit:h}){const y=E(),V=U(),w=H(),D=i,I=h,s=k({get:()=>D.modelValue,set:a=>I("update:modelValue",a)}),m=r(!1),n=r(!1),f=r(""),c=r(s.value.hall_id),C=r([]),x=k(()=>`${$("Validation de la demande de ")} ${(s.value.customer||{firstname:""}).firstname} ${(s.value.customer||{lastname:""}).lastname} ${K(s.value.demand_date)||""}`);function B(){n.value=!0,y.validateItem(s.value.id,{comment:f.value,hall:c.value}).then(a=>{s.value=a.data,m.value=!1,V.showSuccess($("Devis validé avec succès"))}).catch(a=>{n.value=!1,V.showError(a.message)}).then(()=>{n.value=!1})}return _(()=>{w.fetchItems({per_page:1e3}).then(a=>{C.value=a.data.data})}),(a,l)=>{const N=A("CheckIcon");return g(),S(J,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=o=>m.value=o),"max-width":"500px"},{activator:t(({props:o})=>[s.value.prestation?z("",!0):(g(),S(v,j({key:0,dark:""},o,{flat:"",variant:"elevated",density:i.density,color:"primary",icon:i.icon,onClick:l[0]||(l[0]=L=>n.value=!1)}),{default:t(()=>[d(u(i.icon?"":a.$t("Valider en prestation"))+" ",1),e(N,{"stroke-width":"1.5",size:"20"})]),_:2},1040,["density","icon"]))]),default:t(()=>[e(R,null,{default:t(()=>[e(M,{class:"text-h5 text-center py-6"},{default:t(()=>[d(u(a.$t("Êtes-vous sûr de vouloir Valider en prestation?")),1)]),_:1}),e(Z),e(O,null,{default:t(()=>[e(q,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[d(u(x.value),1)]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(F,{modelValue:f.value,"onUpdate:modelValue":l[1]||(l[1]=o=>f.value=o),label:a.$t("Note de liée")},null,8,["modelValue","label"])]),_:1}),e(p,{cols:"12"},{default:t(()=>[e(G,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=o=>c.value=o),items:C.value,"item-value":"id","item-title":"name",label:a.$t("Salle liée")},null,8,["modelValue","items","label"])]),_:1})]),_:1})]),_:1}),e(P,null,{default:t(()=>[e(b),e(v,{color:"error",variant:"flat",dark:"",onClick:l[3]||(l[3]=o=>m.value=!1)},{default:t(()=>[d(u(a.$t("Annuler")),1)]),_:1}),e(v,{color:"success",variant:"flat",loading:n.value,dark:"",onClick:B},{default:t(()=>[d(u(a.$t("Créer la prestation")),1)]),_:1},8,["loading"]),e(b)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}});export{re as _};
