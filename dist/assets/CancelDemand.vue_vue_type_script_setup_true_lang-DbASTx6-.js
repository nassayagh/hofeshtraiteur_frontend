import{u as z,S as L,_ as P,E as R}from"./EditorMenubar-3SRW0kuc.js";import{a6 as B,av as A,e as w,r as p,aD as x,h as Z,Z as q,o as k,_ as C,w as a,V,n as E,d as r,t as n,a4 as I,b as e,a as F,a8 as b}from"./index-Dc7Ike8u.js";import{u as N}from"./demands-Cf0bF_Ug.js";import{u as G}from"./hall-PzlQrTNG.js";import{a as J}from"./formatters-DCCWVJxZ.js";import{b as T,V as Q,c as O,a as U}from"./VCard-CFb_XnfA.js";import{g as W,i as S}from"./VSpacer-PDeYi6bK.js";import{a as X,V as D}from"./VRow-tWFirzHC.js";import{a as Y}from"./BaseBreadcrumb-Dl6T1RHu.js";import{V as j}from"./VDialog-DO3ARWLC.js";const me=B({__name:"ValidateDemand",props:{modelValue:Object,density:{type:String,default:"default"},comment:{type:String,default:""},icon:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{emit:h}){const y=N(),g=A(),_=G(),$=i,f=h,t=w({get:()=>$.modelValue,set:o=>f("update:modelValue",o)}),u=p(!1),m=p(!1),l=z({extensions:[L],content:t.value.commentaire}),d=p(t.value.hall_id),c=p([]),H=w(()=>`${x("Validation de la demande de ")} ${(t.value.customer||{firstname:""}).firstname} ${(t.value.customer||{lastname:""}).lastname} ${J(t.value.demand_date)||""}`);function K(){var o;m.value=!0,y.validateItem(t.value.id,{comment:(o=l.value)==null?void 0:o.getHTML(),hall:d.value}).then(s=>{t.value=s.data,u.value=!1,g.showSuccess(x("Devis validé avec succès")),f("saved",s.data)}).catch(s=>{m.value=!1,g.showError(s.message)}).then(()=>{m.value=!1})}return Z(()=>{_.fetchItems({per_page:1e3}).then(o=>{c.value=o.data.data})}),(o,s)=>{const M=q("CheckIcon");return k(),C(j,{modelValue:u.value,"onUpdate:modelValue":s[3]||(s[3]=v=>u.value=v),"max-width":"1000px"},{activator:a(({props:v})=>[t.value.prestation?I("",!0):(k(),C(V,E({key:0,dark:""},v,{flat:"",variant:"elevated",density:i.density,color:"primary",icon:i.icon,class:"mx-2",onClick:s[0]||(s[0]=ee=>m.value=!1)}),{default:a(()=>[r(n(i.icon?"":o.$t("Valider en prestation"))+" ",1),i.icon?(k(),C(M,{key:0,"stroke-width":"1.5",size:"20"})):I("",!0)]),_:2},1040,["density","icon"]))]),default:a(()=>[e(U,null,{default:a(()=>[e(T,{class:"text-h5 text-center py-6"},{default:a(()=>[r(n(o.$t("Êtes-vous sûr de vouloir Valider en prestation?")),1)]),_:1}),e(W),e(Q,null,{default:a(()=>[e(X,null,{default:a(()=>[e(D,{cols:"12"},{default:a(()=>[r(n(H.value),1)]),_:1}),e(D,{cols:"12"},{default:a(()=>[F("label",null,n(o.$t("Commentaire")),1),e(P,{editor:b(l)},null,8,["editor"]),e(b(R),{editor:b(l)},null,8,["editor"])]),_:1}),e(D,{cols:"12"},{default:a(()=>[e(Y,{modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=v=>d.value=v),items:c.value,"item-value":"id","item-title":"name",label:o.$t("Salle liée")},null,8,["modelValue","items","label"])]),_:1})]),_:1})]),_:1}),e(O,null,{default:a(()=>[e(S),e(V,{color:"error",variant:"flat",dark:"",onClick:s[2]||(s[2]=v=>u.value=!1)},{default:a(()=>[r(n(o.$t("Annuler")),1)]),_:1}),e(V,{color:"success",variant:"flat",loading:m.value,dark:"",onClick:K},{default:a(()=>[r(n(o.$t("Créer la prestation")),1)]),_:1},8,["loading"]),e(S)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),ce=B({__name:"CancelDemand",props:{modelValue:Object},emits:["update:modelValue"],setup(i,{emit:h}){const y=N(),g=A(),_=i,$=h,f=w({get:()=>_.modelValue,set:l=>$("update:modelValue",l)}),t=p(!1),u=p(!1);function m(){u.value=!0,y.cancelItem(f.value.id).then(l=>{f.value=l.data,t.value=!1,g.showSuccess(x("Devis annulé avec succès")),$("saved",l.data)}).then(()=>{u.value=!1})}return(l,d)=>(k(),C(j,{modelValue:t.value,"onUpdate:modelValue":d[1]||(d[1]=c=>t.value=c),"max-width":"550px"},{activator:a(({props:c})=>[f.value.status==0?(k(),C(V,E({key:0,color:"error",class:"mx-3",variant:"outlined",dark:""},c),{default:a(()=>[r(n(l.$t("Annuler la demande")),1)]),_:2},1040)):I("",!0)]),default:a(()=>[e(U,null,{default:a(()=>[e(T,{class:"text-h5 text-center py-6"},{default:a(()=>[r(n(l.$t("Êtes-vous sûr de vouloir annuller la demande?")),1)]),_:1}),e(O,null,{default:a(()=>[e(S),e(V,{color:"error",variant:"flat",dark:"",onClick:d[0]||(d[0]=c=>t.value=!1)},{default:a(()=>[r(n(l.$t("Annuler")),1)]),_:1}),e(V,{color:"success",variant:"flat",loading:u.value,dark:"",onClick:m},{default:a(()=>[r(n(l.$t("OK")),1)]),_:1},8,["loading"]),e(S)]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});export{me as _,ce as a};
