import{u as ne}from"./hall-C5Qu2R5X.js";import{_ as se}from"./BaseBreadcrumb-Bvki5orj.js";import{r as re}from"./validators-BPi-vT8z.js";import{a6 as ie,r as s,av as de,aK as m,h as me,e as ve,g as pe,q as fe,o as q,c as z,b as l,w as o,V as U,n as be,d as r,t as i,a as K,a8 as L,a4 as ge,ac as M,X as Ve}from"./index-I0UitVw9.js";import{F as ce}from"./vee-validate.esm-DMeBf7M5.js";import{V as d,a as R}from"./VRow-CPynRsRN.js";import{V as ke}from"./VDataTableServer-3ph_ZDS5.js";import{V as $e,a as ye}from"./VToolbar-BFM1_PhX.js";import{V as P}from"./VTextField-C34nEPQ_.js";import{V as w}from"./VSpacer-wP9sIqQA.js";import{c as H,b as f}from"./VDialog-vfc6W1j9.js";import{V as X,a as J,b as Ce,c as Q}from"./VCard-B1LBfBUi.js";import{V as Ue}from"./VContainer-BCgfmhns.js";import{V as Pe}from"./VTextarea-CprxU14o.js";import{V as Te}from"./VAlert-YuPZvIpD.js";import"./VTable-CbLis7vm.js";import"./filter-D69XZO7B.js";import"./VMenu-CKbNcpd5.js";import"./index-5VT2wLJK.js";import"./VAvatar-7ZdQt64J.js";import"./VChip-CnA1weES.js";const Ne={class:"text-h5"},Se={key:0,class:"mt-2"},xe=ie({__name:"List",setup(we){const h=s(),B=de(),W=s({title:"Gestions des salles"}),Y=s([{text:m("Tableau de bord"),disabled:!1,href:"/"},{text:m("Salles"),disabled:!0,href:"#"}]),v=s([]),I=ne();me(()=>{G()});const V=s(!1),c=s(!1),E=s(null),O=s(10),k=s(2),T=s(2),A=s(0),F=s(!1),$=s(!1),N=s("");s(["primary","secondary","error","success","warning"]);const b=s([{key:"id",order:"DESC"}]);s(0);const y=s({itemsPerPage:10,rowsPerPage:10,page:1,sortDesc:[!0],sortBy:[{key:"id",order:"desc"}]}),g=s([{id:0,label:m("Non")},{id:1,label:m("Oui")}]),Z=s([{id:"salle",label:m("Géré par la salle")},{id:"client",label:m("Géré par le client")}]),S=s(-1),u=s({id:null,name:"",description:"",price:0,status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),D=s({id:null,name:"",description:"",status:null,packing:null,kitchen:null,cold_room:null,ladder:null,table:null,transportation_fee:null,bin:null}),C=s(!1),_=s([{title:"ID",align:"start",key:"id"},{title:"Nom",align:"start",key:"name"},{title:"Adresse de la salle",align:"start",key:"address"},{title:"Nom du régisseur",align:"start",key:"manager_name"},{title:"Téléphone du régisseur",align:"start",key:"manager_phone"},{title:"Parking",align:"start",key:"packing"},{title:"Cuisine",align:"start",key:"kitchen"},{title:"Chambre froidre",align:"start",key:"cold_room"},{title:"Escalier",align:"start",key:"ladder"},{title:"Bac de poubelle",align:"start",key:"bin"},{title:"Frais de déplacement",align:"start",key:"transportation_fee"},{title:"Table de buffet",align:"start",key:"transportation_fee"},{title:"Commentaire",align:"start",key:"comment"},{title:"Actions",key:"actions",sortable:!1}]);function j(a){V.value=!1,S.value=v.value.indexOf(a),u.value=Object.assign({},a),$.value=!0}function x(a){u.value=a,C.value=!0}function ee(){$.value=!1,setTimeout(()=>{u.value=Object.assign({},D.value),S.value=-1},300)}function le(a,{setErrors:e}){var t;(t=h.value)==null||t.validate().then(({valid:p})=>{p&&(c.value=!0,I.addItem(u.value).then(n=>{if(n.data.error){e({apiError:n.data.message});return}u.value.id!=null?Object.assign(v.value[S.value],n.data):v.value.unshift(n.data),c.value=!1,V.value=!1,$.value=!1,u.value={changePassword:!0},B.showSuccess(m("Salle sauvée avec succès"))}).catch(n=>{c.value=!1,e({apiError:n})}).then(()=>{c.value=!1,e({apiError:null})}))})}function ae(){I.deleteItem(u.value.id);const a=v.value.findIndex(e=>e.id==u.value.id);v.value.splice(a,1),C.value=!1,B.showSuccess(m("Salle supprimé avec succès"))}const te=ve(()=>S.value===-1?m("Nouvel salle"):m("Modifier la salle"));function G(){try{clearTimeout(E.value)}catch{}E.value=setTimeout(()=>{V.value=!0;let a="id",e="desc";console.log(b.value),b.value.length>0&&(a=b.value[0].key,e=b.value[0].order),I.fetchItems({term:N.value,paginate:O.value,current_page:k.value,direction:e,order_by:a,page:y.value.page,per_page:y.value.itemsPerPage}).then(t=>{if(t.data){const{data:p,current_page:n,next_page_url:Ie,total:oe,per_page:Oe,to:Ae,last_page:ue}=t.data;v.value=p,T.value=ue,A.value=oe}}).catch(t=>{console.error(t)}).then(()=>{V.value=!1})},1e3)}return pe([N,y],()=>{G()},{deep:!0}),fe(()=>{k.value>T.value&&(k.value=T.value)}),(a,e)=>(q(),z(Ve,null,[l(se,{title:W.value.title,breadcrumbs:Y.value},null,8,["title","breadcrumbs"]),l(R,null,{default:o(()=>[l(d,{cols:"12"},{default:o(()=>[l(ke,{class:"border rounded-md",headers:_.value,loading:V.value,items:v.value,"multi-sort":!1,"items-per-page":O.value,"onUpdate:itemsPerPage":e[18]||(e[18]=t=>O.value=t),"items-per-page-text":a.$t("Articles par page"),options:y.value,"onUpdate:options":e[19]||(e[19]=t=>y.value=t),"sort-by":b.value,"onUpdate:sortBy":e[20]||(e[20]=t=>b.value=t),page:k.value,"onUpdate:page":e[21]||(e[21]=t=>k.value=t),"items-length":A.value,"onUpdate:itemsLength":e[22]||(e[22]=t=>A.value=t),"show-select":!1,"loading-text":a.$t("Chargement des éléments"),"no-data-text":a.$t("Pas de données"),"no-results-text":a.$t("Aucun résultat"),onPageCount:e[23]||(e[23]=t=>T.value=t)},{top:o(()=>[l($e,{class:"rounded-t-md",flat:""},{default:o(()=>[l(ye,null,{default:o(()=>[l(P,{density:"compact",modelValue:N.value,"onUpdate:modelValue":e[0]||(e[0]=t=>N.value=t),placeholder:a.$t("Rechercher..."),"hide-details":"",variant:"solo"},null,8,["modelValue","placeholder"])]),_:1}),l(w),l(H,{modelValue:$.value,"onUpdate:modelValue":e[15]||(e[15]=t=>$.value=t),"max-width":"750px"},{activator:o(({props:t})=>[l(U,be({color:"primary",variant:"flat",onClick:e[1]||(e[1]=p=>j=D.value),dark:""},t),{default:o(()=>[r(i(a.$t("Ajouter une salle")),1)]),_:2},1040)]),default:o(()=>[l(X,null,{default:o(()=>[l(J,{class:"pa-4 bg-secondary"},{default:o(()=>[K("span",Ne,i(te.value),1)]),_:1}),l(L(ce),{ref_key:"refForm",ref:h,modelValue:F.value,"onUpdate:modelValue":e[14]||(e[14]=t=>F.value=t),onSubmit:le},{default:o(({errors:t,isSubmitting:p})=>[l(Ce,null,{default:o(()=>[l(Ue,{class:"px-0"},{default:o(()=>[l(R,null,{default:o(()=>[l(d,{cols:"12",md:"6"},{default:o(()=>[l(P,{modelValue:u.value.name,"onUpdate:modelValue":e[2]||(e[2]=n=>u.value.name=n),rules:[L(re)],label:a.$t("Nom")},null,8,["modelValue","rules","label"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(P,{modelValue:u.value.address,"onUpdate:modelValue":e[3]||(e[3]=n=>u.value.address=n),label:a.$t("Adresse de la salle")},null,8,["modelValue","label"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(P,{modelValue:u.value.manager_name,"onUpdate:modelValue":e[4]||(e[4]=n=>u.value.manager_name=n),label:a.$t("Nom du régisseur")},null,8,["modelValue","label"])]),_:1}),l(d,{cols:"12",md:"6"},{default:o(()=>[l(P,{modelValue:u.value.manager_phone,"onUpdate:modelValue":e[5]||(e[5]=n=>u.value.manager_phone=n),label:a.$t("Téléphone du régisseur")},null,8,["modelValue","label"])]),_:1}),l(d,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.packing,"onUpdate:modelValue":e[6]||(e[6]=n=>u.value.packing=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Packing"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.kitchen,"onUpdate:modelValue":e[7]||(e[7]=n=>u.value.kitchen=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Cuisine"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.cold_room,"onUpdate:modelValue":e[8]||(e[8]=n=>u.value.cold_room=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Chambre froidre"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"3"},{default:o(()=>[l(f,{modelValue:u.value.ladder,"onUpdate:modelValue":e[9]||(e[9]=n=>u.value.ladder=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Escalier pour déchargement"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"4"},{default:o(()=>[l(f,{modelValue:u.value.bin,"onUpdate:modelValue":e[10]||(e[10]=n=>u.value.bin=n),items:Z.value,"item-title":"label","item-value":"id",label:a.$t("Bac de poubelle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"4"},{default:o(()=>[l(f,{modelValue:u.value.transportation_fee,"onUpdate:modelValue":e[11]||(e[11]=n=>u.value.transportation_fee=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Frais de déplacement à prévoir"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12",md:"4"},{default:o(()=>[l(f,{modelValue:u.value.table,"onUpdate:modelValue":e[12]||(e[12]=n=>u.value.table=n),items:g.value,"item-title":"label","item-value":"id",label:a.$t("Table de buffet présent dans la salle"),clearable:""},null,8,["modelValue","items","label"])]),_:1}),l(d,{cols:"12"},{default:o(()=>[l(Pe,{modelValue:u.value.comment,"onUpdate:modelValue":e[13]||(e[13]=n=>u.value.comment=n),label:a.$t("Commentaire")},null,8,["modelValue","label"])]),_:1})]),_:1}),t.apiError?(q(),z("div",Se,[l(Te,{color:"error"},{default:o(()=>[r(i(t.apiError),1)]),_:2},1024)])):ge("",!0)]),_:2},1024)]),_:2},1024),l(Q,null,{default:o(()=>[l(w),l(U,{color:"error",variant:"flat",dark:"",onClick:ee},{default:o(()=>[r(i(a.$t("Annuler")),1)]),_:1}),l(U,{color:"success",variant:"flat",loading:c.value,type:"submit"},{default:o(()=>[r(i(a.$t("Sauvegarder")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(H,{modelValue:C.value,"onUpdate:modelValue":e[17]||(e[17]=t=>C.value=t),"max-width":"500px"},{default:o(()=>[l(X,null,{default:o(()=>[l(J,{class:"text-h5 text-center py-6"},{default:o(()=>[r(i(a.$t("Êtes-vous sûr de vouloir supprimer cet élément ?")),1)]),_:1}),l(Q,null,{default:o(()=>[l(w),l(U,{color:"error",variant:"flat",dark:"",onClick:e[16]||(e[16]=t=>C.value=!1)},{default:o(()=>[r(i(a.$t("Annuler")),1)]),_:1}),l(U,{color:"success",variant:"flat",dark:"",onClick:ae},{default:o(()=>[r(i(a.$t("OK")),1)]),_:1}),l(w)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),"item.packing":o(({item:t})=>[r(i(t.packing?a.$t("Oui"):a.$t("Non")),1)]),"item.kitchen":o(({item:t})=>[r(i(t.kitchen?a.$t("Oui"):a.$t("Non")),1)]),"item.cold_room":o(({item:t})=>[r(i(t.cold_room?a.$t("Oui"):a.$t("Non")),1)]),"item.ladder":o(({item:t})=>[r(i(t.ladder?a.$t("Oui"):a.$t("Non")),1)]),"item.table":o(({item:t})=>[r(i(t.table?a.$t("Oui"):a.$t("Non")),1)]),"item.transportation_fee":o(({item:t})=>[r(i(t.transportation_fee?a.$t("Oui"):a.$t("Non")),1)]),"item.bin":o(({item:t})=>[r(i(t.bin=="salle"?a.$t("Salle"):a.$t("Client")),1)]),"item.actions":o(({item:t})=>[l(M,{color:"info",size:"small",class:"me-2",onClick:p=>j(t)},{default:o(()=>[r(" mdi-pencil ")]),_:2},1032,["onClick"]),l(M,{color:"error",size:"small",onClick:p=>x(t)},{default:o(()=>[r(" mdi-delete ")]),_:2},1032,["onClick"])]),"no-data":o(()=>[K("span",null,i(a.$t("Aucune donnée disponible")),1)]),_:1},8,["headers","loading","items","items-per-page","items-per-page-text","options","sort-by","page","items-length","loading-text","no-data-text","no-results-text"])]),_:1})]),_:1})],64))}});export{xe as default};
